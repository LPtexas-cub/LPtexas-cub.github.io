<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lptexas</title>
  
  <subtitle>ã® - å°ç‹¼çª</subtitle>
  <link href="http://asucanyh-cn.github.io/atom.xml" rel="self"/>
  
  <link href="http://asucanyh-cn.github.io/"/>
  <updated>2023-03-29T02:22:16.491Z</updated>
  <id>http://asucanyh-cn.github.io/</id>
  
  <author>
    <name>Lptexas</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Springç›¸å…³åŸç†æ€»ç»“</title>
    <link href="http://asucanyh-cn.github.io/posts/3306600581/"/>
    <id>http://asucanyh-cn.github.io/posts/3306600581/</id>
    <published>2023-03-20T16:00:00.000Z</published>
    <updated>2023-03-29T02:22:16.491Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BeanFactoryå’ŒApplicationContext"><a href="#BeanFactoryå’ŒApplicationContext" class="headerlink" title="BeanFactoryå’ŒApplicationContext"></a><a href="https://juejin.cn/post/7166381640036384804">BeanFactoryå’ŒApplicationContext</a></h1><h2 id="ä¸¤è€…å…³ç³»"><a href="#ä¸¤è€…å…³ç³»" class="headerlink" title="ä¸¤è€…å…³ç³»"></a>ä¸¤è€…å…³ç³»</h2><table><thead><tr><th>BeanFactory</th><th>ApplicationContext</th></tr></thead><tbody><tr><td>æ—©æœŸæ¥å£ï¼Œè¢«ç§°ä¸ºSpringçš„Beanå·¥å‚</td><td>åæœŸæ›´é«˜çº§æ¥å£ï¼Œç§°ä¹‹ä¸ºSpring å®¹å™¨</td></tr><tr><td>BeanFactoryçš„APIæ›´åå‘åº•å±‚</td><td>APIå¤§å¤šæ•°æ˜¯å¯¹BeanFactoryåº•å±‚APIçš„å°è£…ï¼›<br />ä¸”æœ‰æ›´å¤šçš„æ‹“å±•åŠŸèƒ½ï¼šç›‘å¬åŠŸèƒ½ã€å›½é™…åŒ–åŠŸèƒ½ç­‰</td></tr><tr><td>å°è£…äº†Beanåˆ›å»ºçš„ä¸»è¦é€»è¾‘å’ŒåŠŸèƒ½</td><td>ç»§æ‰¿äº†BeanFactoryçš„åŠŸèƒ½</td></tr><tr><td>Beançš„åˆå§‹åŒ–æ—¶æœºä¸åŒï¼ŒåŸå§‹BeanFactoryæ˜¯åœ¨é¦–æ¬¡è°ƒç”¨getBeanæ—¶æ‰è¿›è¡ŒBeançš„åˆ›å»º</td><td>ApplicationContextåˆ™æ˜¯é…ç½®æ–‡ä»¶åŠ è½½ï¼Œå®¹å™¨ä¸€åˆ›å»ºå°±å°†Beanéƒ½å®ä¾‹åŒ–å¹¶åˆå§‹åŒ–å¥½ã€‚</td></tr></tbody></table><h2 id="åœ¨SpringåŸºç¡€ç¯å¢ƒä¸‹ï¼Œå¸¸ç”¨çš„ä¸‰ä¸ªApplicationContextä½œç”¨"><a href="#åœ¨SpringåŸºç¡€ç¯å¢ƒä¸‹ï¼Œå¸¸ç”¨çš„ä¸‰ä¸ªApplicationContextä½œç”¨" class="headerlink" title="åœ¨SpringåŸºç¡€ç¯å¢ƒä¸‹ï¼Œå¸¸ç”¨çš„ä¸‰ä¸ªApplicationContextä½œç”¨"></a>åœ¨SpringåŸºç¡€ç¯å¢ƒä¸‹ï¼Œå¸¸ç”¨çš„ä¸‰ä¸ªApplicationContextä½œç”¨</h2><table><thead><tr><th>å®ç°ç±»</th><th>åŠŸèƒ½æè¿°</th></tr></thead><tbody><tr><td><strong>ClassPathXmlApplicationContext</strong></td><td><strong>åŠ è½½ç±»è·¯å¾„ä¸‹çš„xmlé…ç½®çš„ApplicationContext</strong></td></tr><tr><td><strong>FileSystemXmlApplicationContext</strong></td><td><strong>åŠ è½½ç£ç›˜è·¯å¾„ä¸‹çš„xmlé…ç½®çš„ApplicationContext</strong></td></tr><tr><td><strong>AnnotationConfigApplicationContext</strong></td><td><strong>åŠ è½½æ³¨è§£é…ç½®ç±»çš„ApplicationContext</strong></td></tr></tbody></table><h2 id="åœ¨Springçš„webç¯å¢ƒä¸‹ï¼Œå¸¸ç”¨çš„ä¸¤ä¸ªApplicationContextä½œç”¨"><a href="#åœ¨Springçš„webç¯å¢ƒä¸‹ï¼Œå¸¸ç”¨çš„ä¸¤ä¸ªApplicationContextä½œç”¨" class="headerlink" title="åœ¨Springçš„webç¯å¢ƒä¸‹ï¼Œå¸¸ç”¨çš„ä¸¤ä¸ªApplicationContextä½œç”¨"></a>åœ¨Springçš„webç¯å¢ƒä¸‹ï¼Œå¸¸ç”¨çš„ä¸¤ä¸ªApplicationContextä½œç”¨</h2><blockquote><p>å¯¼å…¥ä¾èµ–</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>å®ç°ç±»</th><th>åŠŸèƒ½æè¿°</th></tr></thead><tbody><tr><td>XmlWebApplicationContext</td><td>webç¯å¢ƒä¸‹ï¼ŒåŠ è½½ç±»è·¯å¾„ä¸‹çš„xmlé…ç½®çš„ApplicationContext</td></tr><tr><td>AnnotationConfigWebApplicationContext</td><td>webç¯å¢ƒä¸‹ï¼ŒåŠ è½½ç£ç›˜è·¯å¾„ä¸‹çš„xmlé…ç½®çš„ApplicationContext</td></tr></tbody></table><h1 id="InitializingBean-æ¥å£"><a href="#InitializingBean-æ¥å£" class="headerlink" title="InitializingBean æ¥å£"></a><a href="https://www.cnblogs.com/study-everyday/p/6257127.html">InitializingBean æ¥å£</a></h1><blockquote><p>å®Œæˆä¸€äº›Beançš„åˆå§‹åŒ–æ“ä½œ</p></blockquote><h2 id="å®ç°InitializingBeanæ¥å£ä¸åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šinit-methodæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"><a href="#å®ç°InitializingBeanæ¥å£ä¸åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šinit-methodæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ" class="headerlink" title="å®ç°InitializingBeanæ¥å£ä¸åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šinit-methodæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"></a>å®ç°InitializingBeanæ¥å£ä¸åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šinit-methodæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h2><p>å¦‚æœåŒæ—¶å®ç°äº†InitializingBeanæ¥å£å’Œinit-methodï¼Œé‚£ä¹ˆç³»ç»Ÿä¼šå…ˆè°ƒç”¨InitializingBeanå†è°ƒç”¨init-methodæŒ‡å®šçš„åˆå§‹åŒ–æ–¹æ³•ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><p>1ï¼šspringä¸ºbeanæä¾›äº†ä¸¤ç§åˆå§‹åŒ–beançš„æ–¹å¼ï¼Œå®ç°InitializingBeanæ¥å£ï¼Œå®ç°afterPropertiesSetæ–¹æ³•ï¼Œæˆ–è€…åœ¨é…ç½®æ–‡ä»¶ä¸­åŒè¿‡init-methodæŒ‡å®šï¼Œä¸¤ç§æ–¹å¼<code>å¯ä»¥åŒæ—¶ä½¿ç”¨</code></p><p>2ï¼šå®ç°InitializingBeanæ¥å£æ˜¯ç›´æ¥è°ƒç”¨afterPropertiesSetæ–¹æ³•ï¼Œæ¯”é€šè¿‡åå°„è°ƒç”¨init-methodæŒ‡å®šçš„æ–¹æ³•<code>æ•ˆç‡ç›¸å¯¹æ¥è¯´è¦é«˜ç‚¹</code>ã€‚ä½†æ˜¯init-methodæ–¹å¼æ¶ˆé™¤äº†å¯¹springçš„ä¾èµ–</p><p>3ï¼š<code>å¦‚æœè°ƒç”¨afterPropertiesSetæ–¹æ³•æ—¶å‡ºé”™ï¼Œåˆ™ä¸è°ƒç”¨init-methodæŒ‡å®šçš„æ–¹æ³•</code>ã€‚</p><h2 id="Springä¸»è¦çš„å®ä¾‹åŒ–æ–¹å¼"><a href="#Springä¸»è¦çš„å®ä¾‹åŒ–æ–¹å¼" class="headerlink" title="Springä¸»è¦çš„å®ä¾‹åŒ–æ–¹å¼"></a>Springä¸»è¦çš„å®ä¾‹åŒ–æ–¹å¼</h2><ul><li><p>æ„é€ æ–¹å¼å®ä¾‹åŒ–ï¼šåº•å±‚é€šè¿‡æ„é€ æ–¹æ³•å¯¹Beanè¿›è¡Œå®ä¾‹åŒ–</p><ul><li>æ— å‚æ„é€ æ–¹æ³•å®ä¾‹åŒ–</li><li>æœ‰å‚æ„é€ æ–¹æ³•å®ä¾‹åŒ–<ul><li><constructor-arg> æ·»åŠ å‚æ•°</li></ul></li></ul></li><li><p>å·¥å‚æ–¹å¼å®ä¾‹åŒ–ï¼šåº•å±‚é€šè¿‡è°ƒç”¨è‡ªå®šä¹‰çš„å·¥å‚æ–¹æ³•å¯¹Beanè¿›è¡Œå®ä¾‹åŒ–</p><ul><li>é™æ€å·¥å‚æ–¹æ³•å®ä¾‹åŒ–Bean<ul><li>ç›´æ¥é…ç½®å·¥å‚å¯¹è±¡åŠå…¶é™æ€æ–¹æ³•é…ç½®</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å·¥å‚ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoFactoryBean</span> &#123;</span><br><span class="line">    <span class="comment">// é™æ€å·¥å‚æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> UserDaoImpl <span class="title function_">userDaoImpl</span><span class="params">(String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line">        <span class="comment">// å¯ä»¥åœ¨æ­¤ç¼–å†™ä¸€äº›å…¶ä»–é€»è¾‘ä»£ç </span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserDaoImpl</span>(name, age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.it.factory.UserDaoFactoryBean&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;userDaoImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å°ğŸ•&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;18&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å®ä¾‹å·¥å‚æ–¹æ³•å®ä¾‹åŒ–Bean<ul><li>å…ˆæœ‰å·¥å‚å¯¹è±¡ï¼Œå†ç”¨å·¥å‚å¯¹è±¡å»è°ƒç”¨éé™æ€æ–¹æ³•</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®å®ä¾‹å·¥å‚Bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoFactoryBean2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.it.factory.UserDaoFactoryBean2&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®å®ä¾‹å·¥å‚Beançš„å“ªä¸ªæ–¹æ³•ä½œä¸ºå·¥å‚æ–¹æ³• --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoImpl2&quot;</span> <span class="attr">factory-bean</span>=<span class="string">&quot;userDaoFactoryBean2&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;userDaoImpl2&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å°ğŸ±&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;18&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å·¥å‚ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoFactoryBean2</span> &#123;</span><br><span class="line">    <span class="comment">// éé™æ€å·¥å‚æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span>  UserDaoImpl <span class="title function_">userDaoImpl2</span><span class="params">(String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line">        <span class="comment">// å¯ä»¥åœ¨æ­¤ç¼–å†™ä¸€äº›å…¶ä»–é€»è¾‘ä»£ç </span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserDaoImpl</span>(name, age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å®ç°FactoryBeanè§„èŒƒå»¶è¿Ÿå®ä¾‹åŒ–Bean</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å·¥å‚ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoFactoryBean3</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;UserDao&gt; &#123;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> UserDao <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserDaoImpl</span>();</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">     <span class="keyword">return</span> UserDao.class;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.it.factory.UserDaoFactoryBean3&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="Bean-å®ä¾‹åŒ–çš„åŸºæœ¬æµç¨‹"><a href="#Bean-å®ä¾‹åŒ–çš„åŸºæœ¬æµç¨‹" class="headerlink" title="Bean å®ä¾‹åŒ–çš„åŸºæœ¬æµç¨‹"></a>Bean å®ä¾‹åŒ–çš„åŸºæœ¬æµç¨‹</h1><p>Springå®¹å™¨åœ¨è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œä¼šå°†xmlé…ç½®çš„çš„ä¿¡æ¯ï¼ˆBeanæ ‡ç­¾ï¼‰å°è£…æˆä¸€ä¸ªBeanDefinitionå¯¹è±¡ï¼Œæ‰€æœ‰çš„ BeanDefinitionå­˜å‚¨åˆ°ä¸€ä¸ªåä¸ºbeanDefinitionMapçš„Mapé›†åˆä¸­å»ï¼ŒSpringæ¡†æ¶åœ¨å¯¹è¯¥Mapè¿›è¡Œéå†ï¼Œä½¿ç”¨åå°„åˆ›å»ºBeanå®ä¾‹å¯¹è±¡ï¼Œåˆ›å»ºå¥½çš„Beanå¯¹è±¡å­˜å‚¨åœ¨ä¸€ä¸ªåä¸ºsingletonObjectsçš„Mapé›†åˆä¸­ï¼Œå½“è°ƒç”¨getBeanæ–¹æ³•æ—¶åˆ™æœ€ç»ˆä»è¯¥Mapé›†åˆä¸­å–å‡ºBeanå®ä¾‹å¯¹è±¡è¿”å›ã€‚</p><p><img src="https://asucanyh-cn.github.io/img/post/image-20230324112528550.png" alt="image-20230324112528550"></p><h1 id="è‡ªå®šä¹‰å‘½åç©ºé—´çš„è§£æè¿‡ç¨‹"><a href="#è‡ªå®šä¹‰å‘½åç©ºé—´çš„è§£æè¿‡ç¨‹" class="headerlink" title="è‡ªå®šä¹‰å‘½åç©ºé—´çš„è§£æè¿‡ç¨‹"></a>è‡ªå®šä¹‰å‘½åç©ºé—´çš„è§£æè¿‡ç¨‹</h1><h1 id="è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼šä¸‰çº§ç¼“å­˜"><a href="#è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼šä¸‰çº§ç¼“å­˜" class="headerlink" title="è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼šä¸‰çº§ç¼“å­˜"></a>è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼šä¸‰çº§ç¼“å­˜</h1><p><img src="https://asucanyh-cn.github.io/img/post/image-20230324172845976.png" alt="image-20230324172845976"></p><p><img src="https://asucanyh-cn.github.io/img/post/Spring%E4%B8%89%E7%BA%A7%E7%BC%93%E5%AD%98%E6%BA%90%E7%A0%81%E5%88%A8%E6%9E%90%E6%80%9D%E8%B7%AF.png" alt="Springä¸‰çº§ç¼“å­˜æºç åˆ¨ææ€è·¯"></p>]]></content>
    
    
    <summary type="html">å¯¹Springä¸€äº›åŸç†æ€§çš„ä¸œè¥¿è¿›è¡Œæ€»ç»“ã€‚</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Java" scheme="http://asucanyh-cn.github.io/tags/Java/"/>
    
    <category term="Spring" scheme="http://asucanyh-cn.github.io/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>å¸¸ç”¨IDEçš„æŠ€å·§</title>
    <link href="http://asucanyh-cn.github.io/posts/3868235888/"/>
    <id>http://asucanyh-cn.github.io/posts/3868235888/</id>
    <published>2023-03-20T16:00:00.000Z</published>
    <updated>2023-03-29T02:22:16.495Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Eclipse"><a href="#Eclipse" class="headerlink" title="Eclipse"></a>Eclipse</h1><h2 id="ä»£ç æ¢è¡Œ"><a href="#ä»£ç æ¢è¡Œ" class="headerlink" title="ä»£ç æ¢è¡Œ"></a>ä»£ç æ¢è¡Œ</h2><blockquote><p>Alt + Shift + Y</p></blockquote><h2 id="æŸ¥çœ‹æºç "><a href="#æŸ¥çœ‹æºç " class="headerlink" title="æŸ¥çœ‹æºç "></a>æŸ¥çœ‹æºç </h2><blockquote><p>F3 </p></blockquote><h2 id="æŸ¥çœ‹ç±»ç»§æ‰¿å’Œå®ç°å…³ç³»"><a href="#æŸ¥çœ‹ç±»ç»§æ‰¿å’Œå®ç°å…³ç³»" class="headerlink" title="æŸ¥çœ‹ç±»ç»§æ‰¿å’Œå®ç°å…³ç³»"></a>æŸ¥çœ‹ç±»ç»§æ‰¿å’Œå®ç°å…³ç³»</h2><blockquote><p> F4æˆ–Ctrl + T</p></blockquote><h2 id="æŸ¥çœ‹æ–¹æ³•çš„è°ƒç”¨å±‚æ¬¡"><a href="#æŸ¥çœ‹æ–¹æ³•çš„è°ƒç”¨å±‚æ¬¡" class="headerlink" title="æŸ¥çœ‹æ–¹æ³•çš„è°ƒç”¨å±‚æ¬¡"></a>æŸ¥çœ‹æ–¹æ³•çš„è°ƒç”¨å±‚æ¬¡</h2><blockquote><p>Ctrl+Alt+H    </p></blockquote><h2 id="xmlå¼€å¯ä»£ç æç¤º"><a href="#xmlå¼€å¯ä»£ç æç¤º" class="headerlink" title="xmlå¼€å¯ä»£ç æç¤º"></a>xmlå¼€å¯ä»£ç æç¤º</h2><blockquote><p>Alt + &#x2F;</p></blockquote><h2 id="æŸ¥æ‰¾æŸä¸ªç±»æ–‡ä»¶"><a href="#æŸ¥æ‰¾æŸä¸ªç±»æ–‡ä»¶" class="headerlink" title="æŸ¥æ‰¾æŸä¸ªç±»æ–‡ä»¶"></a>æŸ¥æ‰¾æŸä¸ªç±»æ–‡ä»¶</h2><blockquote><p>Ctrl+Shift+T</p></blockquote>]]></content>
    
    
    <summary type="html">è®°å½•ä¸€äº›ä½¿ç”¨æŠ€å·§ã€‚</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="IDE" scheme="http://asucanyh-cn.github.io/tags/IDE/"/>
    
  </entry>
  
  <entry>
    <title>springåˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®</title>
    <link href="http://asucanyh-cn.github.io/posts/4267699228/"/>
    <id>http://asucanyh-cn.github.io/posts/4267699228/</id>
    <published>2023-03-19T16:00:00.000Z</published>
    <updated>2023-03-29T02:22:16.491Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åˆ›å»ºä¸€ä¸ªspringé¡¹ç›®"><a href="#åˆ›å»ºä¸€ä¸ªspringé¡¹ç›®" class="headerlink" title="åˆ›å»ºä¸€ä¸ªspringé¡¹ç›®"></a>åˆ›å»ºä¸€ä¸ªspringé¡¹ç›®</h1><h2 id="æ‰‹åŠ¨å¯¼å…¥JaråŒ…"><a href="#æ‰‹åŠ¨å¯¼å…¥JaråŒ…" class="headerlink" title="æ‰‹åŠ¨å¯¼å…¥JaråŒ…"></a>æ‰‹åŠ¨å¯¼å…¥JaråŒ…</h2><blockquote><p>åˆ›å»ºæ™®é€šçš„Javaé¡¹ç›®ï¼Œåœ¨libä¸­Springå¯¼å…¥ç›¸å…³åŒ…çš„æ–¹æ³•ã€‚</p></blockquote><h3 id="Springç›¸å…³jaråŒ…"><a href="#Springç›¸å…³jaråŒ…" class="headerlink" title="Springç›¸å…³jaråŒ…"></a><a href="https://blog.csdn.net/qq_35080796/article/details/111355515">Springç›¸å…³jaråŒ…</a></h3><blockquote><p>å®˜æ–¹ä¸‹è½½é“¾æ¥</p><p><a href="https://repo.spring.io/ui/native/release/org/springframework/spring/">https://repo.spring.io/ui/native/release/org/springframework/spring/</a></p></blockquote><h3 id="springä¾èµ–çš„æ—¥å¿—åŒ…"><a href="#springä¾èµ–çš„æ—¥å¿—åŒ…" class="headerlink" title="springä¾èµ–çš„æ—¥å¿—åŒ…"></a>springä¾èµ–çš„æ—¥å¿—åŒ…</h3><blockquote><p><a href="http://commons.apache.org/proper/commons-logging/download_logging.cgi">http://commons.apache.org/proper/commons-logging/download_logging.cgi</a></p></blockquote><h3 id="å­˜æ”¾-jaråŒ…ä»¥åŠåŠ è½½"><a href="#å­˜æ”¾-jaråŒ…ä»¥åŠåŠ è½½" class="headerlink" title="å­˜æ”¾ jaråŒ…ä»¥åŠåŠ è½½"></a>å­˜æ”¾ jaråŒ…ä»¥åŠåŠ è½½</h3><blockquote><p>è§£å‹åå°†ç›¸å…³jaråŒ…æ”¾åœ¨å·¥ç¨‹çš„libç›®å½•ä¸‹ã€‚</p></blockquote><p><img src="https://asucanyh-cn.github.io/img/post/image-20230320172732004.png" alt="image-20230320172732004"></p><h2 id="åˆ›å»ºMavené¡¹ç›®"><a href="#åˆ›å»ºMavené¡¹ç›®" class="headerlink" title="åˆ›å»ºMavené¡¹ç›®"></a>åˆ›å»ºMavené¡¹ç›®</h2><blockquote><p>åœ¨mavené¡¹ç›®ä¸­å¯¼å…¥springä¾èµ–ï¼Œmavenä¼šè‡ªåŠ¨å®ŒæˆjaråŒ…ä¸‹è½½ã€‚</p></blockquote><p><a href="https://blog.csdn.net/daponi/article/details/100731341">å››ä¸ªæ–¹é¢ï¼š</a><br>1ï¼‰springæ ¸å¿ƒä¾èµ–<br>      spring-coreã€spring-beansã€spring-context</p><p>2ï¼‰spring daoä¾èµ–ï¼ˆæä¾›JDBCTemplateï¼‰<br>      spring-jdbcã€spring-tx</p><p>3ï¼‰spring webä¾èµ–<br>      spring-webã€spring-webmvc</p><p>4ï¼‰spring testä¾èµ–<br>      spring-test</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ç‰ˆæœ¬å¯ä»¥è‡ªå·±é€‰æ‹© --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>4.0.0.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-beans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-orm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-expression<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jms<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-websocket<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-instrument<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="åœ¨eclipseä¸­æŸ¥çœ‹æºç "><a href="#åœ¨eclipseä¸­æŸ¥çœ‹æºç " class="headerlink" title="åœ¨eclipseä¸­æŸ¥çœ‹æºç "></a><a href="https://blog.csdn.net/weixin_43992507/article/details/108093905">åœ¨eclipseä¸­æŸ¥çœ‹æºç </a></h1><blockquote><p>å¿«æ·é”®æ˜¯<code>F3</code></p></blockquote><ul><li><a href="https://liaoyongguang.blog.csdn.net/article/details/52137203?spm=1001.2101.3001.6650.3&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-3-52137203-blog-108093905.pc_relevant_default&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-3-52137203-blog-108093905.pc_relevant_default&utm_relevant_index=4">ç”¨mavené¡¹ç›®ï¼Œå¯ä»¥çœ‹æºç ï¼Ÿ</a></li><li>è¿™é‡Œä»‹ç»æ™®é€šJavaé¡¹ç›®ä¸­çš„springé¡¹ç›®æ€ä¹ˆçœ‹æºç ã€‚</li><li>ä»‹ç»å¦‚ä½•ä½¿ç”¨GradleæŸ¥çœ‹æºç </li></ul><p>ä¸‹è½½spring-Frameæºç </p><blockquote><p>github</p><p><a href="https://github.com/spring-projects/spring-framework/tags">https://github.com/spring-projects/spring-framework/tags</a></p></blockquote><h2 id="åœ¨æ™®é€šJavaé¡¹ç›®ä¸­æŸ¥çœ‹æºç "><a href="#åœ¨æ™®é€šJavaé¡¹ç›®ä¸­æŸ¥çœ‹æºç " class="headerlink" title="åœ¨æ™®é€šJavaé¡¹ç›®ä¸­æŸ¥çœ‹æºç "></a>åœ¨æ™®é€šJavaé¡¹ç›®ä¸­æŸ¥çœ‹æºç </h2><p>ä¸‹è½½å®Œæºç åï¼Œåœ¨éœ€è¦æŸ¥çœ‹æºç çš„åœ°æ–¹å¦‚æŸä¸ªæ³¨è§£ï¼ŒæŒ‰<code>F3</code>ï¼Œåœ¨ä¸‹å›¾é¡µé¢ä¸­ï¼Œç‚¹å‡»<code>Attach Source</code></p><p>ä½¿ç”¨æ–‡ä»¶å¤¹çš„æ–¹å¼ï¼Œé€‰æ‹©ä¸Šä¸€æ­¥ä¸‹è½½çš„æºç è§£å‹åçš„ç›®å½•ã€‚</p><p><img src="https://asucanyh-cn.github.io/img/post/image-20230320201344093.png" alt="image-20230320201344093"></p><h2 id="ä½¿ç”¨GradleæŸ¥çœ‹æºç "><a href="#ä½¿ç”¨GradleæŸ¥çœ‹æºç " class="headerlink" title="ä½¿ç”¨GradleæŸ¥çœ‹æºç "></a>ä½¿ç”¨GradleæŸ¥çœ‹æºç </h2><h3 id="å®‰è£…Gradleä»¥åŠé…ç½®ç¯å¢ƒ"><a href="#å®‰è£…Gradleä»¥åŠé…ç½®ç¯å¢ƒ" class="headerlink" title="å®‰è£…Gradleä»¥åŠé…ç½®ç¯å¢ƒ"></a>å®‰è£…Gradleä»¥åŠé…ç½®ç¯å¢ƒ</h3><blockquote><p><a href="https://gradle.org/releases/">https://gradle.org/releases/</a></p></blockquote><p>é€‰æ‹©<code>binary-only</code>ï¼Œä¸‹è½½å®Œæ¯•åè§£å‹ï¼Œé…ç½®<code>ç³»ç»Ÿç¯å¢ƒå˜é‡</code>ã€‚</p><h3 id="åœ¨eclipseä¸­importæºç "><a href="#åœ¨eclipseä¸­importæºç " class="headerlink" title="åœ¨eclipseä¸­importæºç "></a>åœ¨eclipseä¸­importæºç </h3><blockquote><p>File-&gt;Import-&gt;Gradle-&gt;Project root directory</p><p>Project root directoryä¸ºæºç è§£å‹åçš„æ ¹ç›®å½•</p></blockquote><p>å¯¼å…¥è¿‡ç¨‹è¾ƒä¹…ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚</p>]]></content>
    
    
    <summary type="html">è®°å½•ä¸€äº›æ¨¡æ¿å’Œé“¾æ¥</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Java" scheme="http://asucanyh-cn.github.io/tags/Java/"/>
    
    <category term="spring" scheme="http://asucanyh-cn.github.io/tags/spring/"/>
    
  </entry>
  
  <entry>
    <title>Javaä¹‹Spring AOPé¢å‘åˆ‡é¢ç¼–ç¨‹</title>
    <link href="http://asucanyh-cn.github.io/posts/751312367/"/>
    <id>http://asucanyh-cn.github.io/posts/751312367/</id>
    <published>2023-03-12T16:00:00.000Z</published>
    <updated>2023-03-29T02:22:16.491Z</updated>
    
    <content type="html"><![CDATA[<h1 id="AOPé¢å‘åˆ‡é¢ç¼–ç¨‹"><a href="#AOPé¢å‘åˆ‡é¢ç¼–ç¨‹" class="headerlink" title="AOPé¢å‘åˆ‡é¢ç¼–ç¨‹"></a>AOPé¢å‘åˆ‡é¢ç¼–ç¨‹</h1><p>ç”¨äºè§£å†³ç³»ç»Ÿå±‚é¢ä¸Šçš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šæ—¥å¿—ã€äº‹åŠ¡ã€æƒé™ç­‰å¾…ã€‚å®ƒæ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œä¸æ˜¯ç¼–ç¨‹è¯­è¨€ã€‚</p><h2 id="ä¼˜ç‚¹ä»¥åŠä¸€äº›æ¦‚å¿µ"><a href="#ä¼˜ç‚¹ä»¥åŠä¸€äº›æ¦‚å¿µ" class="headerlink" title="ä¼˜ç‚¹ä»¥åŠä¸€äº›æ¦‚å¿µ"></a><a href="https://blog.csdn.net/pedro7k/article/details/115415675">ä¼˜ç‚¹ä»¥åŠä¸€äº›æ¦‚å¿µ</a></h2><h3 id="1ã€AOPçš„ä¼˜ç‚¹"><a href="#1ã€AOPçš„ä¼˜ç‚¹" class="headerlink" title="1ã€AOPçš„ä¼˜ç‚¹"></a>1ã€AOPçš„ä¼˜ç‚¹</h3><ul><li>é™ä½æ¨¡å—ä¹‹é—´çš„è€¦åˆåº¦</li><li>ä½¿ç³»ç»Ÿæ›´å®¹æ˜“æ‰©å±•</li><li>æ›´å¥½çš„ä»£ç å¤ç”¨</li><li>éä¸šåŠ¡ä»£ç æ›´åŠ é›†ä¸­ï¼Œä¸åˆ†æ•£ï¼Œä¾¿äºç»Ÿä¸€ç®¡ç†</li><li>ä¸šåŠ¡ä»£ç æ›´åŠ ç®€æ´çº¯ç²¹ï¼Œä¸æºæ‚å…¶ä»–çš„ä»£ç çš„å½±å“</li></ul><h3 id="2ã€AOPä¸­å‡ºç°çš„ä¸€äº›æ¦‚å¿µ"><a href="#2ã€AOPä¸­å‡ºç°çš„ä¸€äº›æ¦‚å¿µ" class="headerlink" title="2ã€AOPä¸­å‡ºç°çš„ä¸€äº›æ¦‚å¿µ"></a>2ã€<a href="https://blog.csdn.net/Java_xiaobaibai6/article/details/108156664">AOPä¸­å‡ºç°çš„ä¸€äº›æ¦‚å¿µ</a></h3><ul><li><h3 id="æ¨ªåˆ‡å…³æ³¨ç‚¹"><a href="#æ¨ªåˆ‡å…³æ³¨ç‚¹" class="headerlink" title="æ¨ªåˆ‡å…³æ³¨ç‚¹"></a><strong>æ¨ªåˆ‡å…³æ³¨ç‚¹</strong></h3></li></ul><p>å¯¹å“ªäº›æ–¹æ³•è¿›è¡Œæ‹¦æˆªï¼Œæ‹¦æˆªåæ€ä¹ˆå¤„ç†ï¼Œè¿™äº›å…³æ³¨ç‚¹ç§°ä¹‹ä¸ºæ¨ªåˆ‡å…³æ³¨ç‚¹</p><ul><li><h3 id="Aspect-åˆ‡é¢"><a href="#Aspect-åˆ‡é¢" class="headerlink" title="Aspect åˆ‡é¢"></a>Aspect åˆ‡é¢</h3></li></ul><p>é€šå¸¸æ˜¯ä¸€ä¸ªç±»ï¼Œé‡Œé¢å¯ä»¥å®šä¹‰åˆ‡å…¥ç‚¹å’Œé€šçŸ¥ã€‚</p><ul><li><h3 id="JointPoint-è¿æ¥ç‚¹"><a href="#JointPoint-è¿æ¥ç‚¹" class="headerlink" title="JointPoint è¿æ¥ç‚¹"></a>JointPoint è¿æ¥ç‚¹</h3></li></ul><p>è¿æ¥ç‚¹æ˜¯åœ¨åº”ç”¨æ‰§è¡Œä¸­èƒ½å¤Ÿæ’å…¥åˆ‡é¢çš„ä¸€ä¸ªç‚¹ã€‚å³ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­èƒ½å¤Ÿåº”ç”¨é€šçŸ¥çš„æ‰€æœ‰ç‚¹ã€‚</p><p>ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­æ˜ç¡®çš„ç‚¹ï¼Œä¸€èˆ¬æ˜¯æ–¹æ³•çš„è°ƒç”¨ã€‚</p><p>è¢«æ‹¦æˆªåˆ°çš„ç‚¹ï¼Œå› ä¸ºSpringåªæ”¯æŒæ–¹æ³•ç±»å‹çš„è¿æ¥ç‚¹ï¼Œæ‰€ä»¥åœ¨Springä¸­è¿æ¥ç‚¹æŒ‡çš„å°±æ˜¯è¢«æ‹¦æˆªåˆ°çš„æ–¹æ³•ï¼Œå®é™…ä¸Šè¿æ¥ç‚¹è¿˜å¯ä»¥æ˜¯å­—æ®µæˆ–è€…æ„é€ å™¨ã€‚</p><ul><li><h3 id="Advice-é€šçŸ¥"><a href="#Advice-é€šçŸ¥" class="headerlink" title="Advice é€šçŸ¥"></a>Advice é€šçŸ¥</h3></li></ul><p>AOPåœ¨ç‰¹å®šçš„åˆ‡å…¥ç‚¹ä¸Šæ‰§è¡Œçš„å¢å¼ºå¤„ç†</p><ul><li><h3 id="Pointcut-åˆ‡å…¥ç‚¹"><a href="#Pointcut-åˆ‡å…¥ç‚¹" class="headerlink" title="Pointcut åˆ‡å…¥ç‚¹"></a>Pointcut åˆ‡å…¥ç‚¹</h3></li></ul><p>å°±æ˜¯å¸¦æœ‰é€šçŸ¥çš„è¿æ¥ç‚¹ï¼Œåœ¨ç¨‹åºä¸­ä¸»è¦ä½“ç°ä¸º<code>ä¹¦å†™åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</code></p><ul><li><h3 id="Weaving-ç»‡å…¥"><a href="#Weaving-ç»‡å…¥" class="headerlink" title="Weaving ç»‡å…¥"></a><a href="https://zhuanlan.zhihu.com/p/161705262">Weaving ç»‡å…¥</a></h3></li></ul><p>å°†åˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡ï¼Œå¹¶åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚</p><p>åˆ‡é¢åœ¨æŒ‡å®šçš„è¿æ¥ç‚¹è¢«ç»‡å…¥åˆ°ç›®æ ‡å¯¹è±¡ä¸­ã€‚</p><p>åœ¨ç›®æ ‡å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸé‡Œæœ‰å¤šä¸ªç‚¹å¯ä»¥è¿›è¡Œç»‡å…¥:</p><ol><li>ç¼–è¯‘æœŸ:åˆ‡é¢åœ¨ç›®æ ‡ç±»ç¼–è¯‘æ—¶è¢«ç»‡å…¥ã€‚è¿™ç§æ–¹å¼éœ€è¦ç‰¹æ®Šçš„ç¼–è¯‘å™¨ã€‚Aspectçš„ç»‡å…¥ç¼–è¯‘å™¨å°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ã€‚</li><li>ç±»åŠ è½½æœŸ:åˆ‡é¢åœ¨ç›®æ ‡ç±»åŠ è½½åˆ°JVMæ—¶è¢«ç»‡å…¥ã€‚è¿™ç§æ–¹å¼éœ€è¦ç‰¹æ®Šçš„ç±»åŠ è½½å™¨(ClassLoader) ,å®ƒå¯ä»¥åœ¨ç›®æ ‡ç±»è¢«å¼•å…¥åº”ç”¨ä¹‹å‰å¢å¼ºè¯¥ç›®æ ‡ç±»çš„å­—èŠ‚ç ã€‚AspectJ5çš„åŠ è½½æ—¶ç»‡å…¥(load-time weaving, LTW)å°±æ”¯æŒä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚</li><li>è¿è¡ŒæœŸ:åˆ‡é¢åœ¨åº”ç”¨è¿è¡Œçš„æŸä¸ªæ—¶åˆ»è¢«ç»‡å…¥ã€‚ä¸€èˆ¬æƒ…å†µä¸‹,åœ¨ç»‡å…¥åˆ‡é¢æ—¶, AOPå®¹å™¨ä¼šä¸ºç›®æ ‡å¯¹è±¡åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼ˆåŠ¨æ€ä»£ç†ï¼‰ã€‚Spring AOPå°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ã€‚</li></ol><ul><li><h3 id="AOP-Proxy-ä»£ç†"><a href="#AOP-Proxy-ä»£ç†" class="headerlink" title="AOP Proxy ä»£ç†"></a>AOP Proxy ä»£ç†</h3></li></ul><p>AOPæ¡†æ¶åˆ›å»ºçš„å¯¹è±¡ï¼Œä»£ç†å°±æ˜¯ç›®æ ‡å¯¹è±¡çš„åŠ å¼ºã€‚Springä¸­çš„AOPä»£ç†å¯ä»¥ä½¿JDKåŠ¨æ€ä»£ç†ï¼Œä¹Ÿå¯ä»¥æ˜¯CGLIBä»£ç†ï¼Œå‰è€…åŸºäºæ¥å£ï¼Œåè€…åŸºäºå­ç±»</p><h1 id="å¸¸è§é€šçŸ¥"><a href="#å¸¸è§é€šçŸ¥" class="headerlink" title="å¸¸è§é€šçŸ¥"></a><a href="https://zhuanlan.zhihu.com/p/161705262">å¸¸è§é€šçŸ¥</a></h1><p>5ç§Advice</p><ul><li><p><strong>å‰ç½®é€šçŸ¥ï¼ˆBeforeï¼‰</strong>ï¼šåœ¨ç›®æ ‡æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨é€šçŸ¥åŠŸèƒ½ã€‚</p></li><li><p><strong>åç½®é€šçŸ¥ï¼ˆAfter-returningï¼‰</strong>ï¼šåœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åè°ƒç”¨é€šçŸ¥ã€‚ç›®æ ‡æ–¹æ³•å¼‚å¸¸ä¸æ‰§è¡Œã€‚</p></li><li><p><strong>å¼‚å¸¸é€šçŸ¥ï¼ˆAfter-throwing)ï¼‰</strong>ï¼šåœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åè°ƒç”¨é€šçŸ¥ã€‚</p></li><li><p><strong>ç¯ç»•é€šçŸ¥ï¼ˆAroundï¼‰</strong> ï¼šé€šçŸ¥åŒ…è£¹äº†è¢«é€šçŸ¥çš„æ–¹æ³•ï¼Œåœ¨è¢«é€šçŸ¥çš„æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åæ‰§è¡Œè‡ªå®šä¹‰çš„è¡Œä¸ºã€‚</p><ul><li>ç¯ç»•ï¼ˆåï¼‰é€šçŸ¥ï¼Œç›®æ ‡æ–¹æ³•å¼‚å¸¸ä¸æ‰§è¡Œã€‚</li></ul></li><li><p><strong>æœ€ç»ˆé€šçŸ¥ï¼ˆAfterï¼‰</strong>ï¼šåœ¨ç›®æ ‡æ–¹æ³•å®Œæˆä¹‹åè°ƒç”¨é€šçŸ¥ï¼Œæ­¤æ—¶ä¸ä¼šå…³å¿ƒæ–¹æ³•çš„è¾“å‡ºæ˜¯ä»€ä¹ˆã€‚</p></li></ul><h1 id="AOPå®è·µâ€”â€”åŸºäºxmlçš„Spring"><a href="#AOPå®è·µâ€”â€”åŸºäºxmlçš„Spring" class="headerlink" title="AOPå®è·µâ€”â€”åŸºäºxmlçš„Spring"></a>AOPå®è·µâ€”â€”åŸºäºxmlçš„Spring</h1><h2 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.aspectj&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;<span class="number">1.9</span><span class="number">.7</span>&lt;/version&gt;</span><br><span class="line">  &lt;scope&gt;compile&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h2 id="é…ç½®å‘½åç©ºé—´"><a href="#é…ç½®å‘½åç©ºé—´" class="headerlink" title="é…ç½®å‘½åç©ºé—´"></a>é…ç½®å‘½åç©ºé—´</h2><blockquote><p>å…³äºaopçš„ä¸‰è¡Œ</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">context:xsi</span>=<span class="string">&quot;schemaLocation=http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/context/spring-context.xsd&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/aop </span></span></span><br><span class="line"><span class="string"><span class="tag">  http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="AOPçš„ä¸¤ç§é…ç½®æ–¹å¼"><a href="#AOPçš„ä¸¤ç§é…ç½®æ–¹å¼" class="headerlink" title="AOPçš„ä¸¤ç§é…ç½®æ–¹å¼"></a>AOPçš„ä¸¤ç§é…ç½®æ–¹å¼</h2><h3 id="ç¬¬ä¸€ç§ï¼Œä½¿ç”¨-lt-aspect-gt-é…ç½®ã€‚"><a href="#ç¬¬ä¸€ç§ï¼Œä½¿ç”¨-lt-aspect-gt-é…ç½®ã€‚" class="headerlink" title="ç¬¬ä¸€ç§ï¼Œä½¿ç”¨&lt;aspect&gt;é…ç½®ã€‚"></a>ç¬¬ä¸€ç§ï¼Œä½¿ç”¨<code>&lt;aspect&gt;</code>é…ç½®ã€‚</h3><blockquote><p>è¿™ç§æ–¹å¼æ›´åŠ çµæ´»ã€‚Adviceæ–¹æ³•çš„é…ç½®ç”¨æ ‡ç­¾å®ç°ã€‚</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æŒ‡å®šåˆ‡å…¥ç‚¹ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ä¹Ÿå¯ä»¥ç›´æ¥å°†executionè¡¨è¾¾å¼å†™åœ¨pointcut-refå±æ€§ä¸­ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;myPointCut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(void com.service.impl.UserServiceImpl.show())&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æŒ‡å®šé€šçŸ¥ ä»¥åŠç±»å‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;myAdvice&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;beforeAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;myPointCut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">&quot;afterReturnAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;myPointCut&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;aroundAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;myPointCut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">&quot;afterThrowingAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;myPointCut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">&quot;afterAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;myPointCut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.advice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;æ‰§è¡Œäº†å‰ç½®å¢å¼º...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturnAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;æ‰§è¡Œäº†åç½®å¢å¼º...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;æ‰§è¡Œäº†ç¯ç»•(å‰)å¢å¼º...&quot;</span>);</span><br><span class="line"><span class="type">Object</span> <span class="variable">proceed</span> <span class="operator">=</span> proceedingJoinPoint.proceed();<span class="comment">//æ‰§è¡Œç›®æ ‡æ–¹æ³•ï¼ˆç›®æ ‡æ–¹æ³•æœ‰å¯èƒ½æœ‰è¿”å›å€¼æ‰€ä»¥è¿”å›Objectï¼‰</span></span><br><span class="line">System.out.println(<span class="string">&quot;æ‰§è¡Œäº†ç¯ç»•(å)å¢å¼º...&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> proceed;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowingAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;æ‰§è¡Œäº†å¼‚å¸¸åå¢å¼º...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;æ‰§è¡Œäº†æœ€ç»ˆå¢å¼º...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äºŒç§ï¼Œä½¿ç”¨-lt-advisor-gt-é…ç½®ã€‚ï¼ˆå¼€å‘ä¸­åŸºæœ¬ä¸ç”¨ï¼‰"><a href="#ç¬¬äºŒç§ï¼Œä½¿ç”¨-lt-advisor-gt-é…ç½®ã€‚ï¼ˆå¼€å‘ä¸­åŸºæœ¬ä¸ç”¨ï¼‰" class="headerlink" title="ç¬¬äºŒç§ï¼Œä½¿ç”¨&lt;advisor&gt;é…ç½®ã€‚ï¼ˆå¼€å‘ä¸­åŸºæœ¬ä¸ç”¨ï¼‰"></a>ç¬¬äºŒç§ï¼Œä½¿ç”¨<code>&lt;advisor&gt;</code>é…ç½®ã€‚ï¼ˆå¼€å‘ä¸­åŸºæœ¬ä¸ç”¨ï¼‰</h3><blockquote><p>éœ€è¦å¢å¼ºç±»å®ç°<code>ç›¸åº”çš„Adviceæ¥å£æˆ–å…¶å­æ¥å£</code>ã€‚</p><p>ç›¸æ¯”äºå‰è€…ï¼Œå…¶Adviceæ–¹æ³•åœ¨adviceç±»ä¸­å®ç°ï¼Œæ ‡ç­¾åªéœ€è¦å¼•ç”¨adviceç±»å’Œåˆ‡å…¥ç‚¹å³å¯ã€‚</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;myPointCut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(void com.service.impl.UserServiceImpl.show())&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;myPointCut&quot;</span> <span class="attr">advice-ref</span>=<span class="string">&quot;myAdvice2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:advisor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.advice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.AfterReturningAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.MethodBeforeAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.lang.Nullable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice2</span> <span class="keyword">implements</span> <span class="title class_">MethodBeforeAdvice</span>, AfterReturningAdvice &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(Method method, Object[] args, <span class="meta">@Nullable</span> Object target)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;æ‰§è¡Œäº†å‰ç½®å¢å¼º...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturning</span><span class="params">(<span class="meta">@Nullable</span> Object returnValue, Method method, Object[] args, <span class="meta">@Nullable</span> Object target)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;æ‰§è¡Œäº†åç½®å¢å¼º...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸¤ç§æ–¹æ³•çš„æ¯”è¾ƒ"><a href="#ä¸¤ç§æ–¹æ³•çš„æ¯”è¾ƒ" class="headerlink" title="ä¸¤ç§æ–¹æ³•çš„æ¯”è¾ƒ"></a><a href="https://juejin.cn/post/7167151634357698590#heading-22">ä¸¤ç§æ–¹æ³•çš„æ¯”è¾ƒ</a></h3><p><strong>è¯­æ³•å½¢å¼ä¸åŒï¼š</strong></p><ul><li>advisoræ˜¯é€šè¿‡å®ç°æ¥å£æ¥ç¡®è®¤é€šçŸ¥çš„ç±»å‹</li><li>aspectæ˜¯é€šè¿‡é…ç½®ç¡®è®¤é€šçŸ¥çš„ç±»å‹ï¼Œæ›´åŠ çµæ´»</li></ul><p><strong>å¯é…ç½®çš„åˆ‡é¢æ•°é‡ä¸åŒï¼š</strong></p><ul><li>ä¸€ä¸ªadvisoråªèƒ½é…ç½®ä¸€ä¸ªå›ºå®šé€šçŸ¥å’Œä¸€ä¸ªåˆ‡ç‚¹è¡¨è¾¾å¼</li><li>ä¸€ä¸ªaspectå¯ä»¥é…ç½®å¤šä¸ªé€šçŸ¥å’Œå¤šä¸ªåˆ‡ç‚¹è¡¨è¾¾å¼ä»»æ„ç»„åˆ</li></ul><p><strong>ä½¿ç”¨åœºæ™¯ä¸åŒï¼š</strong></p><ul><li>å…è®¸éšæ„æ­é…æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨aspectè¿›è¡Œé…ç½®</li><li>å¦‚æœé€šçŸ¥ç±»å‹å•ä¸€ã€åˆ‡é¢å•ä¸€çš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨advisorè¿›è¡Œé…ç½®</li><li>åœ¨é€šçŸ¥ç±»å‹å·²ç»å›ºå®šï¼Œä¸ç”¨äººä¸ºæŒ‡å®šé€šçŸ¥ç±»å‹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨advisorè¿›è¡Œé…ç½®ï¼Œä¾‹å¦‚åé¢è¦å­¦ä¹ çš„ Springäº‹åŠ¡æ§åˆ¶çš„é…ç½®</li></ul><h2 id="AOPåŸç†åˆ¨æ"><a href="#AOPåŸç†åˆ¨æ" class="headerlink" title="AOPåŸç†åˆ¨æ"></a>AOPåŸç†åˆ¨æ</h2><blockquote><p><a href="https://www.bilibili.com/video/BV1rt4y1u7q5?t=1406.6&p=90">Bilibiliç²¾å‡†ç©ºé™</a>ï¼Œ<a href="https://juejin.cn/post/7167151634357698590#heading-27">ç½‘å‹æ–‡å­—ç‰ˆ</a></p></blockquote><h1 id="AOPå®è·µâ€”â€”åŸºäºæ³¨è§£çš„Spring"><a href="#AOPå®è·µâ€”â€”åŸºäºæ³¨è§£çš„Spring" class="headerlink" title="AOPå®è·µâ€”â€”åŸºäºæ³¨è§£çš„Spring"></a>AOPå®è·µâ€”â€”åŸºäºæ³¨è§£çš„Spring</h1><h2 id="å¯ç”¨AOPçš„æ³¨è§£"><a href="#å¯ç”¨AOPçš„æ³¨è§£" class="headerlink" title="å¯ç”¨AOPçš„æ³¨è§£"></a>å¯ç”¨AOPçš„æ³¨è§£</h2><blockquote><p>å¦‚æœä½ é€‰æ‹©ä½¿ç”¨é…ç½®æ–‡ä»¶æ¥ä½¿ç”¨æ³¨è§£</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span> /&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨é…ç½®ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableAspectJAutoProxy</span></span><br></pre></td></tr></table></figure><h2 id="åˆ‡é¢çš„é…ç½®"><a href="#åˆ‡é¢çš„é…ç½®" class="headerlink" title="åˆ‡é¢çš„é…ç½®"></a>åˆ‡é¢çš„é…ç½®</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span> <span class="comment">//å£°æ˜åˆ‡é¢</span></span><br><span class="line"><span class="meta">@Before()</span> <span class="comment">//å‰ç½®å¢å¼º</span></span><br><span class="line"><span class="meta">@AfterReturning()</span>   <span class="comment">//åç½®å¢å¼º</span></span><br><span class="line"><span class="meta">@Around()</span> <span class="comment">//ç¯ç»•å¢å¼º</span></span><br><span class="line"><span class="meta">@AfterThrowing(valueæˆ–pointcut=&quot;&quot;,throwing=&quot;&quot;,...)</span> <span class="comment">//æŠ›å‡ºå¼‚å¸¸åå¢å¼º</span></span><br><span class="line"><span class="meta">@After()</span>       <span class="comment">//æœ€ç»ˆå¢å¼º</span></span><br></pre></td></tr></table></figure><h2 id="åˆ‡ç‚¹è¡¨è¾¾å¼æŠ½å–"><a href="#åˆ‡ç‚¹è¡¨è¾¾å¼æŠ½å–" class="headerlink" title="åˆ‡ç‚¹è¡¨è¾¾å¼æŠ½å–"></a>åˆ‡ç‚¹è¡¨è¾¾å¼æŠ½å–</h2><ol><li>å†™ä¸€ä¸ª<code>ç©ºæ–¹æ³•</code>ï¼Œæ·»åŠ æ³¨è§£<code>@Pointcut(&quot;execution(* com.package.*.*(..))&quot;)</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span>&#123;</span><br><span class="line"><span class="meta">@Pointcut(&quot;execution(* com.package.*.*(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">myPointcut</span><span class="params">()</span>;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>ä½¿ç”¨<code>ç±»å.æ–¹æ³•å()</code>çš„è¯­æ³•å¼•ç”¨åˆ‡ç‚¹è¡¨è¾¾å¼</li></ol><div class="admonition note"><p class="admonition-title">â€œ â€</p><p>æ³¨æ„è¿™ç§æ ¼å¼åªæ˜¯ä¸€ç§è¯­æ³•è§„èŒƒï¼Œè€Œä¸æ˜¯Javaä»£ç ï¼</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before(&quot;MyAdvice.myPointcut()&quot;)</span> <span class="comment">// &lt;=&gt; @Before(&quot;execution(* com.package.*.*(..))&quot;)</span></span><br></pre></td></tr></table></figure><h1 id="SpringBoot-AOPå®è·µ"><a href="#SpringBoot-AOPå®è·µ" class="headerlink" title="SpringBoot AOPå®è·µ"></a>SpringBoot AOPå®è·µ</h1><h2 id="æ·»åŠ ä¾èµ–-1"><a href="#æ·»åŠ ä¾èµ–-1" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupld</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupld</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactld</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactld</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ‹¦æˆªæ–¹æ³•"><a href="#æ‹¦æˆªæ–¹æ³•" class="headerlink" title="æ‹¦æˆªæ–¹æ³•"></a>æ‹¦æˆªæ–¹æ³•</h2><h3 id="æ–¹æ³•ä¸€-å£°æ˜è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œæ‹¦æˆª"><a href="#æ–¹æ³•ä¸€-å£°æ˜è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œæ‹¦æˆª" class="headerlink" title="æ–¹æ³•ä¸€ å£°æ˜è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œæ‹¦æˆª"></a>æ–¹æ³•ä¸€ å£°æ˜è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œæ‹¦æˆª</h3><blockquote><p>æ–°å»º<code>Annotation</code>åŒ…ï¼Œæ–°å»º<code>adminOnly</code>æ¥å£</p></blockquote><ul><li>åœ¨<code>interface</code>å‰æ·»åŠ <code>@</code>è¡¨æ˜å®šä¹‰çš„æ˜¯æ³¨è§£</li><li>æ·»åŠ <code>@annotation</code>æ³¨è§£</li></ul><div class="admonition info"><p class="admonition-title">â€œâ€</p><p><a href="https://blog.csdn.net/xsp_happyboy/article/details/80987484">è‡ªå®šä¹‰æ³¨è§£æœ‰å“ªäº›å‚æ•°å‘¢ï¼Ÿ</a></p></div><ul><li>æ·»åŠ å‚æ•°<code>@Retention</code>ã€<code>@Target</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi.Annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span> <span class="comment">//æŒ‡å®šäº†æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸåœ¨è¿è¡Œæ—¶</span></span><br><span class="line"><span class="meta">@Target(ElementType.METHOD)</span><span class="comment">//æŒ‡å®šäº†æ³¨è§£åº”ç”¨åœ¨æ–¹æ³•ä¸Š</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> adminOnly &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•äºŒ-ä½¿ç”¨executionè¡¨è¾¾å¼æ‹¦æˆª"><a href="#æ–¹æ³•äºŒ-ä½¿ç”¨executionè¡¨è¾¾å¼æ‹¦æˆª" class="headerlink" title="æ–¹æ³•äºŒ ä½¿ç”¨executionè¡¨è¾¾å¼æ‹¦æˆª"></a>æ–¹æ³•äºŒ ä½¿ç”¨executionè¡¨è¾¾å¼æ‹¦æˆª</h3><p>è¯­æ³•æ ¼å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(ä¿®é¥°ç¬¦pattern è¿”å›å€¼pattern æè¿°åŒ…åæ–¹æ³•å(å‚æ•°) æ–¹æ³•æŠ›å‡ºå¼‚å¸¸pattern)</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;execution(public * com.example.controller.*Controller.*(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">match</span><span class="params">()</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Before(&quot;match()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// å‰ç½®é€šçŸ¥...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="admonition note"><p class="admonition-title">â€œâ€</p><p><a href="https://blog.csdn.net/lk7688535/article/details/51989746">*(..):æœ€åè¿™ä¸ªæ˜Ÿå·è¡¨ç¤ºæ–¹æ³•åï¼Œ*å·è¡¨ç¤ºæ‰€æœ‰çš„æ–¹æ³•ï¼Œåé¢æ‹¬å¼§é‡Œé¢è¡¨ç¤ºæ–¹æ³•çš„å‚æ•°ï¼Œä¸¤ä¸ªå¥ç‚¹è¡¨ç¤ºä»»ä½•å‚æ•°</a></p></div><h2 id="åˆ‡é¢çš„ç®¡ç†"><a href="#åˆ‡é¢çš„ç®¡ç†" class="headerlink" title="åˆ‡é¢çš„ç®¡ç†"></a>åˆ‡é¢çš„ç®¡ç†</h2><blockquote><p>æ–°å»º<code>Aspect</code>åŒ…å¯¹åˆ‡é¢è¿›è¡Œç»Ÿä¸€ç®¡ç†ï¼Œå¹¶æ–°å»º<code>CheckUserAscpect.java</code>ç±»</p></blockquote><ul><li><code>@Aspect</code>æ³¨è§£å£°æ˜è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªåˆ‡é¢</li><li><code>@Component</code>æ³¨è§£ï¼Œå°†è¿™ä¸ªç±»æ ‡è®°ä¸ºSpringå®¹å™¨ä¸­çš„ä¸€ä¸ªBeanï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨å…¶å®ƒæ³¨è§£äº†ï¼ˆ<code>@Autowired</code>ï¼‰</li><li>ä½¿ç”¨<code>CheckUserService.java</code>è¿™ä¸ªç±»ï¼Œå®ç°é€»è¾‘å¤„ç†</li><li>ç¼–å†™åˆ‡å…¥ç‚¹ï¼Œ<code>@Pointcut(&quot;@annotation(com.mysqlapi.Annotation.adminOnly)&quot;)</code>ï¼Œå…¶ä¸­å‚æ•°ç”¨æ¥æŒ‡å®šåœ¨ä½•å¤„æ’å…¥ï¼Œæ­¤å¤„è¡¨ç¤º<code>åœ¨ä½¿ç”¨äº†ï¼ˆè‡ªå®šä¹‰ï¼‰æ³¨è§£@adminOnlyå¤„åˆ‡å…¥</code>ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>executionè¡¨è¾¾å¼è¿›è¡Œæ‹¦æˆª</code><ul><li>åˆ‡å…¥ç‚¹æ–¹æ³•ä¸º<code>checkAdmin()</code></li></ul></li><li>ç¼–å†™é€šçŸ¥ï¼Œå†³å®šäº†ä½•æ—¶æ‰§è¡Œï¼Œä»¥<code>@Before</code>é€šçŸ¥ä¸ºä¾‹ï¼Œå³åœ¨æ‰§è¡Œæ“ä½œå‰ï¼Œæ£€æŸ¥ç”¨æˆ·æ˜¯å¦ä¸ºç®¡ç†å‘˜ã€‚<code>@Before(&quot;checkAdmin()&quot;)</code>å…¶ä¸­çš„å‚æ•°ä¸º<code>åˆ‡å…¥ç‚¹çš„æ–¹æ³•</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi.Aspect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysqlapi.service.CheckUserService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CheckUserAscpect</span> &#123;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> CheckUserService checkUserService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Pointcut(&quot;@annotation(com.mysqlapi.Annotation.adminOnly)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkAdmin</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Before(&quot;checkAdmin()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">check</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">checkUserService.check();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¿®æ”¹ä¹‹å‰çš„æƒé™éªŒè¯"><a href="#ä¿®æ”¹ä¹‹å‰çš„æƒé™éªŒè¯" class="headerlink" title="ä¿®æ”¹ä¹‹å‰çš„æƒé™éªŒè¯"></a>ä¿®æ”¹ä¹‹å‰çš„æƒé™éªŒè¯</h1><blockquote><p>UserService.java</p></blockquote><ul><li>åœ¨<code>addUser()</code>æ–¹æ³•å‰ï¼Œæ·»åŠ æ³¨è§£<code>@adminOnly</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi.Aspect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysqlapi.service.CheckUserService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CheckUserAscpect</span> &#123;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> CheckUserService checkUserService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Pointcut(&quot;@annotation(com.mysqlapi.Annotation.adminOnly)&quot;)</span></span><br><span class="line"><span class="comment">//@Pointcut(&quot;execution(public * com.mysqlapi.service.*.*(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkAdmin</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Before(&quot;checkAdmin()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">check</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">checkUserService.check();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@Before(&quot;checkAdmin()&quot;)</span></span><br><span class="line"><span class="comment">//public void before(JoinPoint joinPoint)&#123;</span></span><br><span class="line"><span class="comment">//System.out.println(&quot;[å‰ç½®é€šçŸ¥]&quot;+joinPoint);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿›è¡Œå•å…ƒæµ‹è¯•</p></blockquote><p>UserServiceTest.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysqlapi.holder.CurrentUserHolder;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserServiceTest2</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testFindAll</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">CurrentUserHolder.set(<span class="string">&quot;sds&quot;</span>);</span><br><span class="line">userService.findAll();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testAddUser</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">CurrentUserHolder.set(<span class="string">&quot;sds&quot;</span>);</span><br><span class="line">userService.addUser();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·å¯ä»¥å®ç°ï¼Œæƒé™æ§åˆ¶ã€‚è¿™ç§æ·»åŠ è‡ªå®šä¹‰æ³¨è§£çš„æ–¹å¼ï¼Œæ¯”åœ¨æ¯æœ‰ä¸€ä¸ªæ–¹æ³•éƒ½è¦æ·»åŠ <code>check()</code>å’Œ<code>throws Exception</code>è¦æ›´åŠ ç®€æ´ï¼Œä½†è¿˜æ˜¯éœ€è¦å¯¹æ¯ä¸ªéœ€è¦æƒé™çš„æ–¹æ³•æ·»åŠ æ³¨è§£ã€‚</p><p><img src="C:\Users\Lappland\AppData\Roaming\Typora\typora-user-images\image-20230313172948144.png" alt="image-20230313172948144"></p><blockquote><p>ç”¨executionè¡¨è¾¾å¼çš„å•å…ƒæµ‹è¯•</p></blockquote><p>AspectTestUserService1.java  &lt;â€“ è¿™ä¸ªæ˜¯serviceåŒ…ä¸­çš„æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AspectTestUserService1</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;AspectTestUserService1 æŸ¥æ‰¾æˆåŠŸï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addUser</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;AspectTestUserService1 æ’å…¥æˆåŠŸï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>AspectTestUserService1Test.java &lt;â€“ å•å…ƒæµ‹è¯•æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AspectTestUserService1Test</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> AspectTestUserService1 aspectTestUserService1;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testFindAll</span><span class="params">()</span> &#123;</span><br><span class="line">aspectTestUserService1.findAll();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testAddUser</span><span class="params">()</span> &#123;</span><br><span class="line">aspectTestUserService1.addUser();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="excutionè¡¨è¾¾å¼"><a href="#excutionè¡¨è¾¾å¼" class="headerlink" title="excutionè¡¨è¾¾å¼"></a>excutionè¡¨è¾¾å¼</h2><p>è¯­æ³•æ ¼å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution (* com.sample.service.impl..*.*(..))</span><br></pre></td></tr></table></figure><p>  æ•´ä¸ªè¡¨è¾¾å¼å¯ä»¥åˆ†ä¸ºäº”ä¸ªéƒ¨åˆ†ï¼š</p><p>1ã€execution(): è¡¨è¾¾å¼ä¸»ä½“ã€‚</p><p> 2ã€ç¬¬ä¸€ä¸ª<em>å·ï¼šè¡¨ç¤ºè¿”å›ç±»å‹ï¼Œ</em>å·è¡¨ç¤ºæ‰€æœ‰çš„ç±»å‹ã€‚</p><p> 3ã€åŒ…åï¼šè¡¨ç¤ºéœ€è¦æ‹¦æˆªçš„åŒ…åï¼Œåé¢çš„ä¸¤ä¸ªå¥ç‚¹è¡¨ç¤ºå½“å‰åŒ…å’Œå½“å‰åŒ…çš„æ‰€æœ‰å­åŒ…ï¼Œcom.sample.service.implåŒ…ã€å­å­™åŒ…ä¸‹æ‰€æœ‰ç±»çš„æ–¹æ³•ã€‚</p><p> 4ã€ç¬¬äºŒä¸ª<em>å·ï¼šè¡¨ç¤ºç±»åï¼Œ</em>å·è¡¨ç¤ºæ‰€æœ‰çš„ç±»ã€‚</p><p> 5ã€*(..):æœ€åè¿™ä¸ªæ˜Ÿå·è¡¨ç¤ºæ–¹æ³•åï¼Œ*å·è¡¨ç¤ºæ‰€æœ‰çš„æ–¹æ³•ï¼Œåé¢æ‹¬å¼§é‡Œé¢è¡¨ç¤ºæ–¹æ³•çš„å‚æ•°ï¼Œä¸¤ä¸ªå¥ç‚¹è¡¨ç¤ºä»»ä½•å‚æ•°ã€‚</p>]]></content>
    
    
    <summary type="html">è‡ªç”¨çš„å­¦ä¹ ç¬”è®°ã€‚</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Java" scheme="http://asucanyh-cn.github.io/tags/Java/"/>
    
    <category term="Spring" scheme="http://asucanyh-cn.github.io/tags/Spring/"/>
    
    <category term="AOP" scheme="http://asucanyh-cn.github.io/tags/AOP/"/>
    
  </entry>
  
  <entry>
    <title>Javaä¹‹SpringBootæ•°æ®åº“API Part2</title>
    <link href="http://asucanyh-cn.github.io/posts/1059130365/"/>
    <id>http://asucanyh-cn.github.io/posts/1059130365/</id>
    <published>2023-03-10T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="http://asucanyh-cn.github.io/posts/2953060011/">æ¥ä¸Šä¸€èŠ‚ï¼ŒSpringBootæ•°æ®åº“API</a></p></blockquote><h1 id="æ•°æ®åº“äº‹åŠ¡"><a href="#æ•°æ®åº“äº‹åŠ¡" class="headerlink" title="æ•°æ®åº“äº‹åŠ¡"></a>æ•°æ®åº“äº‹åŠ¡</h1><blockquote><p>TestTransController.java</p></blockquote><ul><li>äº‹åŠ¡ï¼Œè¦ä¹ˆå®Œå…¨æ‰§è¡Œï¼Œè¦ä¹ˆå®Œå…¨ä¸æ‰§è¡Œã€‚</li><li>æ·»åŠ <code>@Transactional</code>æ³¨è§£ï¼Œè¡¨æ˜æ“ä½œä¸ºäº‹åŠ¡ã€‚</li></ul><p>å½“ä¸åŠ æ³¨è§£è¿è¡Œæ—¶ï¼Œç¬¬ä¸€æ¡è®°å½•ä¼šè¢«æ·»åŠ è‡³è¡¨ä¸­ï¼Œä½†ç¬¬äºŒæ¡è®°å½•ä¼šæŠ¥é”™ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysqlapi.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.mysqlapi.repository.UserRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.transaction.Transactional;</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestTransController</span> &#123;</span><br><span class="line"><span class="comment">//å®ä¾‹åŒ–æ¥å£</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserRepository repository;</span><br><span class="line"><span class="comment">//æ³¨æ„ï¼šæ•°æ®åº“è¦æ”¹ä¸ºInnoDBå¼•æ“</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/create2Users&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">create2Users</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user1.setUserName(<span class="string">&quot;test1&quot;</span>);</span><br><span class="line">    user1.setRole(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">    repository.save(user1);</span><br><span class="line"></span><br><span class="line">    <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user1.setUserName(<span class="string">&quot;test2&quot;</span>);</span><br><span class="line">    user2.setRole(<span class="string">&quot;10&quot;</span>); <span class="comment">//æ­¤æ“ä½œä¼šæŠ¥é”™</span></span><br><span class="line">    repository.save(user2);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h1><blockquote><p>å¯¹è½¯ä»¶æœ€å°å¯æµ‹è¯•å•å…ƒï¼ˆJavaï¼Œå³ç±»ï¼‰è¿›è¡Œæµ‹è¯•ã€‚</p></blockquote><h2 id="æ·»åŠ ä¾èµ–å·¥å…·"><a href="#æ·»åŠ ä¾èµ–å·¥å…·" class="headerlink" title="æ·»åŠ ä¾èµ–å·¥å…·"></a>æ·»åŠ ä¾èµ–å·¥å…·</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span></span><br><span class="line">junit</span><br><span class="line"><span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="è¿›å…¥å•å…ƒæµ‹è¯•"><a href="#è¿›å…¥å•å…ƒæµ‹è¯•" class="headerlink" title="è¿›å…¥å•å…ƒæµ‹è¯•"></a>è¿›å…¥å•å…ƒæµ‹è¯•</h2><blockquote><p><a href="https://blog.csdn.net/qq_44309044/article/details/102687627">eclipseè¿›å…¥å•å…ƒæµ‹è¯•</a></p></blockquote><p>åœ¨æˆ‘ä»¬å†™å¥½ä¸€ä¸ªç±»æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å•å…ƒæµ‹è¯•å¯¹é‡Œé¢çš„æ–¹æ³•è¿›è¡Œæµ‹è¯•ã€‚</p><p>å¯ä»¥å€ŸåŠ©<code>junit</code>ä¸­çš„<code>Assert</code>ç±»ï¼Œæä¾›çš„æ–¹æ³•ã€‚</p><p><img src="https://asucanyh-cn.github.io/img/post/image-20230311093458113.png" alt="image-20230311093458113"></p><blockquote><p>æ‰§è¡Œå•å…ƒæµ‹è¯•ç±»</p></blockquote><p>åœ¨<code>class &lt;classname&gt; &#123;&#125;</code>å‰æ·»åŠ æ³¨è§£</p><ul><li>@RunWith(SpringRunner.<strong>class</strong>)</li><li>@SpringBootTest</li></ul><h1 id="æƒé™ç®¡ç†"><a href="#æƒé™ç®¡ç†" class="headerlink" title="æƒé™ç®¡ç†"></a>æƒé™ç®¡ç†</h1><p>ä¸åŒçš„ç”¨æˆ·æ‹¥æœ‰ä¸åŒçš„è§’è‰²ï¼Œä¸åŒè§’è‰²çš„æƒé™ä¸åŒï¼Œå¯ä»¥æ‰§è¡Œçš„æ“ä½œä¹Ÿä¸ä¸€æ ·ã€‚å¦‚ä½•åœ¨SpringBootä¸­å®ç°å¯¹æƒé™çš„æ§åˆ¶å‘¢ï¼Ÿ</p><p>å®ç°ç®€å•çš„æƒé™ç®¡ç†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨cookieã€sessionã€çº¿ç¨‹å­˜å‚¨ã€æ•°æ®åº“ç­‰ã€‚</p><h2 id="ç¤ºä¾‹ï¼šçº¿ç¨‹æœ¬åœ°å­˜å‚¨"><a href="#ç¤ºä¾‹ï¼šçº¿ç¨‹æœ¬åœ°å­˜å‚¨" class="headerlink" title="ç¤ºä¾‹ï¼šçº¿ç¨‹æœ¬åœ°å­˜å‚¨"></a>ç¤ºä¾‹ï¼šçº¿ç¨‹æœ¬åœ°å­˜å‚¨</h2><blockquote><p>CurrentUserHolder.java</p></blockquote><p>è¿™ä¸ªç±»åˆ›å»ºäº†ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ol><li>get()ï¼Œç”¨æˆ·è·å–çº¿ç¨‹å­˜å‚¨ä¸­çš„æ•°æ®</li><li>set()ï¼Œè®¾ç½®çº¿ç¨‹å­˜å‚¨ä¸­çš„æ•°æ®</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi.holder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CurrentUserHolder</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;String&gt; holder = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> holder.get()==<span class="literal">null</span>?<span class="string">&quot;null&quot;</span>:holder.get();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(String username)</span> &#123;</span><br><span class="line">holder.set(username);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="admonition note"><p class="admonition-title">ThreadLocalç›¸å…³é—®é¢˜</p><p><a href="https://www.zhihu.com/question/477411483">ThreadLocalä¸€ä¸ªçº¿ç¨‹åªèƒ½å­˜æ”¾ä¸€ä¸ªå˜é‡å—ï¼Ÿæƒ³å­˜å¤šä¸ªæ€ä¹ˆæï¼Ÿ</a></p></div><blockquote><p>CheckUserService.java</p></blockquote><p>serviceå±‚</p><ul><li>è¿›è¡Œèº«ä»½çš„æ£€æŸ¥ï¼Œè‹¥ä¸åŒ¹é…åˆ™æŠ›å‡ºå¼‚å¸¸</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysqlapi.holder.CurrentUserHolder;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CheckUserService</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">check</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">String user=CurrentUserHolder.get();</span><br><span class="line"><span class="keyword">if</span>(!user.equals(<span class="string">&quot;admin&quot;</span>)) &#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;[å¼‚å¸¸]ä½ ä¸æ˜¯ç®¡ç†å‘˜&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>UserService.java</p></blockquote><p>serviceå±‚</p><ul><li>å®ä¾‹åŒ–CheckUserService</li><li>åœ¨æ¯ä¸ªUserServiceçš„æ–¹æ³•ä¸­ï¼ˆä»¥<code>findAll()</code>ä¸ºä¾‹ï¼‰ï¼ŒåŠ å…¥CheckUserServiceæ£€æŸ¥ï¼ˆè°ƒç”¨<code>check()</code>æ–¹æ³•ï¼‰ï¼Œè®¾ç½®æŠ›å‡ºå¼‚å¸¸ï¼ˆ<code>throws Exception</code>ï¼‰ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> CheckUserService checkUserService;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findAll</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">checkUserService.check();</span><br><span class="line">System.out.println(<span class="string">&quot;æŸ¥æ‰¾æˆåŠŸï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addUser</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;æ’å…¥æˆåŠŸï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="admonition info"><p>ä½¿ç”¨è¿™ç§æ–¹æ³•è¿›è¡Œæƒé™ç®¡ç†ï¼Œæˆ‘ä»¬ä¼šå‘ç°åœ¨<code>UserService.java</code>ä¸­ï¼Œæ¯æœ‰ä¸€ä¸ªæ–¹æ³•éœ€è¦æƒé™éƒ½è¦æ·»åŠ <code>check()</code>å’Œ<code>throws Exception</code>è¿™æ ·ä½¿å¾—æˆ‘ä»¬çš„ä»£ç æ˜¾å¾—å†—ä½™ã€ä½æ•ˆã€‚å¦‚ä½•è§£å†³å‘¢ï¼Ÿè¿™å°±éœ€è¦æˆ‘ä»¬å­¦ä¹ <code>AOPé¢å‘åˆ‡é¢ç¼–ç¨‹</code>ã€‚åœ¨ä¸‹ä¸€èŠ‚å°†è¿›è¡Œå­¦ä¹ ã€‚</p></div><br>]]></content>
    
    
    <summary type="html">è‡ªç”¨çš„å­¦ä¹ ç¬”è®°ã€‚</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Java" scheme="http://asucanyh-cn.github.io/tags/Java/"/>
    
    <category term="SpringBoot" scheme="http://asucanyh-cn.github.io/tags/SpringBoot/"/>
    
    <category term="Mysql" scheme="http://asucanyh-cn.github.io/tags/Mysql/"/>
    
    <category term="Restful API" scheme="http://asucanyh-cn.github.io/tags/Restful-API/"/>
    
  </entry>
  
  <entry>
    <title>Javaä¹‹SpringBootæ•°æ®åº“API</title>
    <link href="http://asucanyh-cn.github.io/posts/2953060011/"/>
    <id>http://asucanyh-cn.github.io/posts/2953060011/</id>
    <published>2023-03-09T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://lptexas.top/posts/581298918/">æ¥ä¸Šä¸€èŠ‚ï¼ŒSpringBootè¿æ¥æ•°æ®åº“ã€‚</a></p></blockquote><p>è®¾è®¡æ“ä½œæ•°æ®åº“çš„APIï¼Œè®©æ•°æ®åº“æ“ä½œæ›´åŠ ä¾¿æ·ã€‚</p><h1 id="è®¾è®¡Restful-API"><a href="#è®¾è®¡Restful-API" class="headerlink" title="è®¾è®¡Restful API"></a>è®¾è®¡Restful API</h1><table><thead><tr><th>è¯·æ±‚æ–¹å¼</th><th>è·¯å¾„</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>GET</td><td>&#x2F;users</td><td>è·å–æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯</td></tr><tr><td>GET</td><td>&#x2F;users&#x2F;{id}</td><td>æŸ¥è¯¢å•æ¡è®°å½•</td></tr><tr><td>POST</td><td>&#x2F;adduser</td><td>åˆ›å»ºä¸€æ¡ç”¨æˆ·è®°å½•</td></tr><tr><td>PUT</td><td>&#x2F;users&#x2F;{id}</td><td>æ›´æ–°å•æ¡è®°å½•</td></tr></tbody></table><h1 id="åˆ›å»ºæ•°æ®åº“æ¥å£"><a href="#åˆ›å»ºæ•°æ®åº“æ¥å£" class="headerlink" title="åˆ›å»ºæ•°æ®åº“æ¥å£"></a>åˆ›å»ºæ•°æ®åº“æ¥å£</h1><blockquote><p>UserRepository.java</p></blockquote><ul><li>ç»§æ‰¿<code>JpaRepositoryæ¥å£</code></li><li>å¯ä»¥è‡ªå®šä¹‰ä¸€äº›æ–¹æ³•ã€‚æ­¤å¤„æˆ‘é€‰æ‹©ç›´æ¥ä½¿ç”¨ç»§æ‰¿çš„æ–¹æ³•ï¼Œå°±ä¸å†™å…¶å®ƒä¸œè¥¿äº†ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserRepository</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="JpaRepositoryæ¥å£ç±»"><a href="#JpaRepositoryæ¥å£ç±»" class="headerlink" title="JpaRepositoryæ¥å£ç±»"></a>JpaRepositoryæ¥å£ç±»</h2><blockquote><p>è¿™ä¸ªæ¥å£åˆç»§æ‰¿äº†<code>ListCrudRepository&lt;T, ID&gt;</code>å’Œ<code>ListPagingAndSortingRepository&lt;T, ID&gt;</code></p></blockquote><p>è¿™äº›æ¥å£ä¸ºæˆ‘ä»¬å°è£…äº†å¾ˆå¤šæ–¹æ³•ã€‚å…·ä½“è¯·åˆ›å»ºä¹‹åï¼Œç‚¹è¿›å»æŸ¥çœ‹ã€‚</p><p><img src="https://asucanyh-cn.github.io/img/post/image-20230310192452411.png" alt="image-20230310192452411"></p><p><img src="https://asucanyh-cn.github.io/img/post/image-20230310192534454.png" alt="image-20230310192534454"></p><p><img src="https://asucanyh-cn.github.io/img/post/image-20230310192606010.png" alt="image-20230310192606010"></p><p><img src="https://asucanyh-cn.github.io/img/post/image-20230310192546820.png" alt="image-20230310192546820"></p><p><img src="https://asucanyh-cn.github.io/img/post/image-20230310192728513.png" alt="image-20230310192728513"></p><p><img src="https://asucanyh-cn.github.io/img/post/image-20230310192652324.png" alt="image-20230310192652324"></p><h1 id="å®Œå–„Controller"><a href="#å®Œå–„Controller" class="headerlink" title="å®Œå–„Controller"></a>å®Œå–„Controller</h1><blockquote><p>UserController.java</p><p>+æŸ¥è¯¢è®°å½•</p><p>+å¢åŠ è®°å½•</p><p>+åˆ é™¤è®°å½•</p><p>+æ›´æ”¹è®°å½•</p></blockquote><ul><li>åˆå§‹åŒ–æ¥å£</li><li>æ·»åŠ æ³¨è§£<code>@Autowired</code></li><li>æ·»åŠ <code>@GetMappingã€@PostMapping</code>ç­‰ï¼Œå®ç°å¯¹åº”çš„æ¥å£æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PutMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserRepository repository;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–æ‰€æœ‰è®°å½•</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;User&gt; <span class="title function_">getAll</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> repository.findAll();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢å•æ¡è®°å½•</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/users/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">findById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> repository.findById(id).orElse(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/adduser&quot;)</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">addUser</span><span class="params">(<span class="meta">@RequestParam(&quot;usrn&quot;)</span> String usrn, <span class="meta">@RequestParam(&quot;pswd&quot;)</span> String pswd, <span class="meta">@RequestParam(&quot;role&quot;)</span> String role)</span> &#123;</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">user.setUserName(usrn);</span><br><span class="line">user.setPassword(pswd);</span><br><span class="line">user.setRole(role);</span><br><span class="line"><span class="keyword">return</span> repository.save(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/users/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">updateUser</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer PathId, <span class="meta">@RequestParam(&quot;id&quot;)</span> Integer id, <span class="meta">@RequestParam(&quot;usrn&quot;)</span> String usrn, <span class="meta">@RequestParam(&quot;pswd&quot;)</span> String pswd, <span class="meta">@RequestParam(&quot;role&quot;)</span> String role)</span> &#123;</span><br><span class="line">Optional&lt;User&gt; optional = repository.findById(id);</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="comment">// æ˜¯å¦å­˜åœ¨è¯¥ç”¨æˆ·ï¼Œä¸å­˜åœ¨åˆ™è¿”å›null</span></span><br><span class="line"><span class="comment">// æ–¹æ³•ä¸€ï¼ˆæ¨èï¼‰</span></span><br><span class="line">optional.orElse(<span class="literal">null</span>);</span><br><span class="line"><span class="comment">//// æ–¹æ³•äºŒ</span></span><br><span class="line"><span class="comment">//if(optional.isPresent()) &#123;</span></span><br><span class="line"><span class="comment">//user=optional.get();</span></span><br><span class="line"><span class="comment">//&#125;else &#123;</span></span><br><span class="line"><span class="comment">//return null;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="keyword">if</span> (id.toString()!= <span class="literal">null</span>&amp;&amp;id.toString()!=<span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">user.setId(id);</span><br><span class="line">&#125; &#123;</span><br><span class="line">user.setId(optional.get().getId());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (usrn != <span class="literal">null</span>&amp;&amp; usrn!=<span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">user.setUserName(usrn);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">user.setUserName(optional.get().getUserName());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pswd != <span class="literal">null</span>&amp;&amp; pswd!=<span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">user.setPassword(pswd);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">user.setPassword((optional.get().getPassword()));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (role != <span class="literal">null</span>&amp;&amp; role!=<span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">user.setRole(role);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">user.setRole(optional.get().getRole());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> repository.save(user);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="admonition note"><p class="admonition-title">å¦‚æœåœ¨è¿™ä¸€æ­¥ç»“æŸï¼Œèƒ½æˆåŠŸè¿è¡Œå—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯æŠ¥é”™<code>java.lang.IllegalArgumentException: Could not resolve domain type of interface com.mysqlapi.UserRepository</code>ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼ŸåŸå› æ˜¯ç»§æ‰¿<code>jpaRepository</code>æ—¶æœªæŒ‡å®šä¸¤ä¸ªç±»å‹ï¼Œå³<code>&lt;å¯¹åº”å®ä½“ç±»,ä¸»é”®çš„æ•°æ®ç±»å‹&gt;</code></p></div><blockquote><p>ä¿®æ”¹UserRepository.java</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserRepository</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&lt;User,Integer&gt;&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ‰§è¡Œç¨‹åº"><a href="#æ‰§è¡Œç¨‹åº" class="headerlink" title="æ‰§è¡Œç¨‹åº"></a>æ‰§è¡Œç¨‹åº</h1><blockquote><p>run as spring boot app</p></blockquote><p>å½“å‰çš„ç¨‹åºè¿˜æ˜¯å­˜åœ¨é—®é¢˜ï¼Œä½¿ç”¨PUTæ›´æ–°è®°å½•æ—¶ï¼Œå½“<code>id</code>ä¸º<code>ç©ºï¼ˆénullï¼‰</code>æ—¶ï¼Œä¼šæŠ¥é”™ï¼›å½“<code>æŸä¸ªå‚æ•°</code>ä¸º<code>null</code>æ—¶ï¼Œä»ç„¶æŠ¥é”™ï¼ˆä¼¼ä¹<code>!=null</code>è¯­å¥æœªç”Ÿæ•ˆï¼‰ã€‚æ€è€ƒä¸ºä»€ä¹ˆä¼šå‘ç”Ÿè¿™ç§é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</p><div class="admonition note"><p class="admonition-title">æ•°æ®åº“ä¸­`<tablename>_sequence`è¡¨çš„ä½œç”¨</p><p>è¯¥è¡¨æŒ‡å®šäº†ä¸‹ä¸€ä¸ªè®°å½•çš„è‡ªå¢å€¼ã€‚ç”¨<code>next_val</code>å­—æ®µè¡¨ç¤ºã€‚å¦‚æœä½¿ç”¨æ¥å£æ’å…¥æ•°æ®å¤±è´¥ï¼Œæœ‰å¯èƒ½æ˜¯è¿™é‡Œå‡ºé”™ï¼Œæ—¥å¿—ä¸­ä¼šæŠ¥é”™<code>Duplicate entry 'xxx' for key 'xxx.PRIMARY'</code>ã€‚åªéœ€è¦ä¿®æ”¹ä¸€ä¸‹è‡ªå¢å€¼å³å¯ã€‚</p></div><h1 id="å¤„ç†æ•°æ®åº“ä¹±ç é—®é¢˜"><a href="#å¤„ç†æ•°æ®åº“ä¹±ç é—®é¢˜" class="headerlink" title="å¤„ç†æ•°æ®åº“ä¹±ç é—®é¢˜"></a>å¤„ç†æ•°æ®åº“ä¹±ç é—®é¢˜</h1><blockquote><p>ç»Ÿä¸€é¡¹ç›®å’Œæ•°æ®åº“ä¸­ä½¿ç”¨çš„ç¼–ç ã€‚</p></blockquote><h2 id="æ•°æ®åº“è¿æ¥æ—¶è®¾ç½®ç¼–ç "><a href="#æ•°æ®åº“è¿æ¥æ—¶è®¾ç½®ç¼–ç " class="headerlink" title="æ•°æ®åº“è¿æ¥æ—¶è®¾ç½®ç¼–ç "></a>æ•°æ®åº“è¿æ¥æ—¶è®¾ç½®ç¼–ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url=jdbc:mysql:<span class="comment">//localhost:3306/managerSys?useUnicode=true&amp;characterEncoding=utf8</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è‡ªç”¨çš„å­¦ä¹ ç¬”è®°ã€‚</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Java" scheme="http://asucanyh-cn.github.io/tags/Java/"/>
    
    <category term="SpringBoot" scheme="http://asucanyh-cn.github.io/tags/SpringBoot/"/>
    
    <category term="Mysql" scheme="http://asucanyh-cn.github.io/tags/Mysql/"/>
    
    <category term="Restful API" scheme="http://asucanyh-cn.github.io/tags/Restful-API/"/>
    
  </entry>
  
  <entry>
    <title>Javaä¹‹SpringBootè¿æ¥æ•°æ®åº“</title>
    <link href="http://asucanyh-cn.github.io/posts/581298918/"/>
    <id>http://asucanyh-cn.github.io/posts/581298918/</id>
    <published>2023-03-09T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li>Hibernate</li><li>SpringBoot</li></ul><h1 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h1><ol><li>jpaç”¨äºè¿æ¥å¢åˆ æ”¹æ•°æ®åº“çš„</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>mysqlè¿æ¥é©±åŠ¨</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æˆ‘ä½¿ç”¨ä¸‹é¢è¿™ä¸ªé©±åŠ¨ä¼šæŠ¥é”™ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="é…ç½®æ•°æ®åº“"><a href="#é…ç½®æ•°æ®åº“" class="headerlink" title="é…ç½®æ•°æ®åº“"></a>é…ç½®æ•°æ®åº“</h1><blockquote><p>ä¿®æ”¹<code>application.properties</code>æˆ–åŒç›®å½•æ–°å»º<code>application.yml</code></p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://192.168.31.5:3306/managerSys</span> </span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jc.jdbc.Driver</span></span><br></pre></td></tr></table></figure><div class="admonition note"><p class="admonition-title">driver-class-name</p><p><a href="https://blog.csdn.net/a907691592/article/details/96876030">com.mysql.jdbc.Driverå’Œcom.mysql.jc.jdbc.Driveçš„åŒºåˆ«</a></p></div><blockquote><p>å»ºè®®æ·»åŠ çš„é…ç½®</p><p>hibernateæ˜¯ä¸€ç§å¯¹è±¡å…³ç³»æ˜ å°„æ¡†æ¶ï¼Œhibernateå¯ä»¥å®ç°è‡ªåŠ¨å»ºè¡¨ã€‚</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jpa:</span> </span><br><span class="line">   <span class="attr">show-sql:</span> <span class="literal">true</span></span><br><span class="line">   <span class="attr">hibernate:</span> </span><br><span class="line">        <span class="attr">ddl-auto:</span> <span class="string">create</span></span><br></pre></td></tr></table></figure><div class="admonition note"><p class="admonition-title">hibernateçš„5ä¸ªæ¨¡å¼</p><p>è§ä¸‹æ–‡ã€‚</p></div><h1 id="hibernateçš„5ä¸ªæ¨¡å¼"><a href="#hibernateçš„5ä¸ªæ¨¡å¼" class="headerlink" title="hibernateçš„5ä¸ªæ¨¡å¼"></a><a href="https://blog.csdn.net/qq_28681387/article/details/97614983">hibernateçš„5ä¸ªæ¨¡å¼</a></h1><blockquote><p>DDLï¼ˆData Definition Languageï¼‰ï¼Œå³æ•°æ®å®šä¹‰è¯­è¨€ï¼Œä¾‹å¦‚å»ºæ•°æ®åº“ã€å»ºè¡¨ç­‰ï¼Œéƒ½å±äºæ•°æ®å®šä¹‰è¯­è¨€ã€‚</p></blockquote><h2 id="createæ¨¡å¼"><a href="#createæ¨¡å¼" class="headerlink" title="createæ¨¡å¼"></a>createæ¨¡å¼</h2><p>æ¯æ¬¡è¿è¡Œé¡¹ç›®ï¼Œæ²¡æœ‰è¡¨ä¼šæ–°å»ºè¡¨ï¼Œå¦‚æœè¡¨å†…æœ‰æ•°æ®ä¼šè¢«æ¸…ç©º</p><h2 id="create-dropæ¨¡å¼"><a href="#create-dropæ¨¡å¼" class="headerlink" title="create-dropæ¨¡å¼"></a>create-dropæ¨¡å¼</h2><p>æ¯æ¬¡è¿è¡Œé¡¹ç›®ï¼Œæ²¡æœ‰è¡¨ä¼šæ–°å»ºè¡¨ï¼Œå¹¶ä¸”æ¯æ¬¡ç¨‹åºç»“æŸåï¼Œåˆ é™¤è¡¨ã€‚</p><h2 id="updateæ¨¡å¼"><a href="#updateæ¨¡å¼" class="headerlink" title="updateæ¨¡å¼"></a>updateæ¨¡å¼</h2><p>æ²¡æœ‰è¡¨æ ¼ä¼šæ–°å»ºï¼Œä¸ä¼šåˆ é™¤æ•°æ®ï¼Œåªä¼šå¯¹è¡¨è¿›è¡Œæ›´æ–°æ“ä½œã€‚</p><h2 id="validateæ¨¡å¼"><a href="#validateæ¨¡å¼" class="headerlink" title="validateæ¨¡å¼"></a>validateæ¨¡å¼</h2><p>æ ¡éªŒæ¨¡å¼ï¼Œæ ¡éªŒå­—æ®µæ•°æ®ç±»å‹æ˜¯å¦ç›¸åŒï¼Œä¸åŒåˆ™æŠ¥é”™ã€‚</p><h2 id="noneæ¨¡å¼"><a href="#noneæ¨¡å¼" class="headerlink" title="noneæ¨¡å¼"></a>noneæ¨¡å¼</h2><p>å…³é—­ddlï¼Œä»€ä¹ˆéƒ½ä¸åšï¼Œæ¯æ¬¡å¯åŠ¨é¡¹ç›®ï¼Œä¸ä¼šå¯¹æ•°æ®åº“è¿›è¡Œä»»ä½•éªŒè¯å’Œæ“ä½œã€‚</p><h1 id="æ¼”ç¤ºHibernateè‡ªåŠ¨å»ºè¡¨"><a href="#æ¼”ç¤ºHibernateè‡ªåŠ¨å»ºè¡¨" class="headerlink" title="æ¼”ç¤ºHibernateè‡ªåŠ¨å»ºè¡¨"></a>æ¼”ç¤ºHibernateè‡ªåŠ¨å»ºè¡¨</h1><h2 id="æ–°å»ºEntity"><a href="#æ–°å»ºEntity" class="headerlink" title="æ–°å»ºEntity"></a>æ–°å»ºEntity</h2><blockquote><p>User.java</p></blockquote><ul><li>å®šä¹‰æˆå‘˜å˜é‡</li><li>@idï¼Œè®¾ç½®å˜é‡å¯¹åº”ä¸ºä¸»é”®</li><li>@GeneratedValueï¼Œè®¾ç½®å˜é‡ä¸ºè‡ªå¢</li><li>ä¸€é”®ç”Ÿæˆgetterã€setteræ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> jakarta.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> jakarta.persistence.Id;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"><span class="meta">@Id</span></span><br><span class="line"><span class="meta">@GeneratedValue</span></span><br><span class="line"><span class="keyword">private</span> Integer id;</span><br><span class="line"><span class="keyword">private</span> String userName;</span><br><span class="line"><span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123; <span class="comment">//æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.id = id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getUserName</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> userName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserName</span><span class="params">(String userName)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.userName = userName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getPassword</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> password;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.password = password;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ–°å»ºController"><a href="#æ–°å»ºController" class="headerlink" title="æ–°å»ºController"></a>æ–°å»ºController</h2><blockquote><p>StudentController.java</p></blockquote><ul><li>æš‚æ—¶å•¥ä¹Ÿä¸å†™</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mysqlapi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentController</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è¿è¡Œé¡¹ç›®"><a href="#è¿è¡Œé¡¹ç›®" class="headerlink" title="è¿è¡Œé¡¹ç›®"></a>è¿è¡Œé¡¹ç›®</h2><blockquote><p>run  as spring boot app</p></blockquote><p>æ—¥å¿—ä¸­å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œ<code>show-sql: true</code>æ­£å¸¸å·¥ä½œã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">Hibernate: <span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> <span class="keyword">user</span></span><br><span class="line">Hibernate: <span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> user_seq</span><br><span class="line">Hibernate: <span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span> (id <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>, password <span class="type">varchar</span>(<span class="number">255</span>), role <span class="type">varchar</span>(<span class="number">255</span>), user_name <span class="type">varchar</span>(<span class="number">255</span>), <span class="keyword">primary</span> key (id)) engine<span class="operator">=</span>InnoDB</span><br><span class="line">Hibernate: <span class="keyword">create</span> <span class="keyword">table</span> user_seq (next_val <span class="type">bigint</span>) engine<span class="operator">=</span>InnoDB</span><br><span class="line">Hibernate: <span class="keyword">insert</span> <span class="keyword">into</span> user_seq <span class="keyword">values</span> ( <span class="number">1</span> )</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ•°æ®åº“ï¼Œå¯ä»¥å‘ç°å·²ç»æˆåŠŸåˆ›å»ºï¼</p><p><img src="https://asucanyh-cn.github.io/img/post/image-20230310184516354.png" alt="image-20230310184516354"></p><div class="admonition caution"><p class="admonition-title">ddl-autoä½¿ç”¨æ³¨æ„</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<code>ddl-auto</code>ä½¿ç”¨<code>update</code>æ¨¡å¼æœ€å®‰å…¨ã€‚</p></div><br>]]></content>
    
    
    <summary type="html">è‡ªç”¨çš„å­¦ä¹ ç¬”è®°ã€‚</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Java" scheme="http://asucanyh-cn.github.io/tags/Java/"/>
    
    <category term="SpringBoot" scheme="http://asucanyh-cn.github.io/tags/SpringBoot/"/>
    
    <category term="Mysql" scheme="http://asucanyh-cn.github.io/tags/Mysql/"/>
    
  </entry>
  
  <entry>
    <title>Javaä¹‹ArrayListåŠ¨æ€æ•°ç»„</title>
    <link href="http://asucanyh-cn.github.io/posts/862504134/"/>
    <id>http://asucanyh-cn.github.io/posts/862504134/</id>
    <published>2023-03-07T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‚é˜…ï¼š<a href="https://www.runoob.com/java/java-arraylist.html">https://www.runoob.com/java/java-arraylist.html</a></p><h1 id="ä»€ä¹ˆæ˜¯ArrayList"><a href="#ä»€ä¹ˆæ˜¯ArrayList" class="headerlink" title="ä»€ä¹ˆæ˜¯ArrayList?"></a>ä»€ä¹ˆæ˜¯ArrayList?</h1><blockquote><p>ArrayList ç±»æ˜¯ä¸€ä¸ªå¯ä»¥åŠ¨æ€ä¿®æ”¹çš„æ•°ç»„ï¼Œä¸æ™®é€šæ•°ç»„çš„åŒºåˆ«å°±æ˜¯å®ƒæ˜¯æ²¡æœ‰å›ºå®šå¤§å°çš„é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ã€‚</p><p>ArrayList ç»§æ‰¿äº† AbstractList ï¼Œå¹¶å®ç°äº† List æ¥å£ã€‚</p></blockquote><h2 id="è¯­æ³•æ ¼å¼"><a href="#è¯­æ³•æ ¼å¼" class="headerlink" title="è¯­æ³•æ ¼å¼"></a>è¯­æ³•æ ¼å¼</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList; <span class="comment">// å¼•å…¥ ArrayList ç±»</span></span><br><span class="line"></span><br><span class="line">ArrayList&lt;E&gt; objectName =<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();ã€€ <span class="comment">// åˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure><h1 id="ArrayListæä¾›çš„æ–¹æ³•"><a href="#ArrayListæä¾›çš„æ–¹æ³•" class="headerlink" title="ArrayListæä¾›çš„æ–¹æ³•"></a>ArrayListæä¾›çš„æ–¹æ³•</h1><h2 id="addæ–¹æ³•"><a href="#addæ–¹æ³•" class="headerlink" title="addæ–¹æ³•"></a>addæ–¹æ³•</h2><blockquote><p>æ·»åŠ å…ƒç´ è‡³æ•°ç»„ä¸­ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList; <span class="comment">// å¼•å…¥ ArrayList ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestArrayList</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">ArrayList&lt;String&gt; animals =<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;(); <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">animals.add(<span class="string">&quot;dog&quot;</span>);</span><br><span class="line">animals.add(<span class="string">&quot;cat&quot;</span>);</span><br><span class="line">System.out.println(animals);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#output</span><br><span class="line">[dog, cat]</span><br></pre></td></tr></table></figure><h2 id="getæ–¹æ³•"><a href="#getæ–¹æ³•" class="headerlink" title="getæ–¹æ³•"></a>getæ–¹æ³•</h2><blockquote><p>è®¿é—®å…ƒç´ ã€‚</p><p>æ³¨æ„ï¼šåˆ—è¡¨ä¸­çš„ç´¢å¼•ä»0å¼€å§‹ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.get(index);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(animals.get(<span class="number">0</span>));</span><br></pre></td></tr></table></figure><h2 id="setæ–¹æ³•"><a href="#setæ–¹æ³•" class="headerlink" title="setæ–¹æ³•"></a>setæ–¹æ³•</h2><blockquote><p>ä¿®æ”¹å…ƒç´ ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.set(index,value);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">animals.set(<span class="number">0</span>,<span class="string">&quot;monkey&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="removeæ–¹æ³•"><a href="#removeæ–¹æ³•" class="headerlink" title="removeæ–¹æ³•"></a>removeæ–¹æ³•</h2><blockquote><p>åˆ é™¤å…ƒç´ ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.remove(index);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">animals.remove(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><h2 id="sizeæ–¹æ³•"><a href="#sizeæ–¹æ³•" class="headerlink" title="sizeæ–¹æ³•"></a>sizeæ–¹æ³•</h2><blockquote><p>è¾“å‡ºå…ƒç´ ä¸ªæ•°ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.size();</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(animals.size());</span><br></pre></td></tr></table></figure><h1 id="éå†æ•°ç»„åˆ—è¡¨ä¸­çš„å…ƒç´ çš„æŠ€å·§"><a href="#éå†æ•°ç»„åˆ—è¡¨ä¸­çš„å…ƒç´ çš„æŠ€å·§" class="headerlink" title="éå†æ•°ç»„åˆ—è¡¨ä¸­çš„å…ƒç´ çš„æŠ€å·§"></a>éå†æ•°ç»„åˆ—è¡¨ä¸­çš„å…ƒç´ çš„æŠ€å·§</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">for</span><span class="params">(int i : myNumbers)</span></span></span><br></pre></td></tr></table></figure><p>ç­‰ä»·äº:</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for(int i <span class="operator">=</span> <span class="number">0</span><span class="comment">; i &lt; myNumbers.size(); i++ï¼‰&#123;</span></span><br><span class="line">    int j <span class="operator">=</span> myNumbers.get(i)<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è‡ªç”¨çš„å­¦ä¹ ç¬”è®°ã€‚</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Java" scheme="http://asucanyh-cn.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Pythonä¹‹matplotlibæ¨¡å—</title>
    <link href="http://asucanyh-cn.github.io/posts/2723459680/"/>
    <id>http://asucanyh-cn.github.io/posts/2723459680/</id>
    <published>2023-03-07T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‚é˜…ï¼š<a href="http://c.biancheng.net/matplotlib">http://c.biancheng.net/matplotlib</a></p><h1 id="ä½¿ç”¨matplotlibç»˜åˆ¶å¯è§†åŒ–å›¾å½¢"><a href="#ä½¿ç”¨matplotlibç»˜åˆ¶å¯è§†åŒ–å›¾å½¢" class="headerlink" title="ä½¿ç”¨matplotlibç»˜åˆ¶å¯è§†åŒ–å›¾å½¢"></a>ä½¿ç”¨matplotlibç»˜åˆ¶å¯è§†åŒ–å›¾å½¢</h1><h1 id="æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡"><a href="#æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡" class="headerlink" title="æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡"></a>æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt<span class="selector-class">.rcParams</span><span class="selector-attr">[<span class="string">&#x27;font.sans-serif&#x27;</span>]</span>=<span class="selector-attr">[<span class="string">&#x27;SimHei&#x27;</span>]</span>#æ­£ç¡®æ˜¾ç¤ºæ±‰å­—</span><br><span class="line">plt<span class="selector-class">.rcParams</span><span class="selector-attr">[<span class="string">&#x27;axes.unicode_minus&#x27;</span>]</span>=False #æ­£ç¡®æ˜¾ç¤ºè´Ÿå·</span><br></pre></td></tr></table></figure><h1 id="axesç±»"><a href="#axesç±»" class="headerlink" title="axesç±»"></a>axesç±»</h1><h2 id="legendå‡½æ•°"><a href="#legendå‡½æ•°" class="headerlink" title="legendå‡½æ•°"></a>legendå‡½æ•°</h2><blockquote><p>åˆ›å»ºå›¾ä¾‹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax.legend(handles, labels, loc)</span><br></pre></td></tr></table></figure><ul><li>labels æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åºåˆ—ï¼Œç”¨æ¥æŒ‡å®šæ ‡ç­¾çš„åç§°ï¼›</li><li>loc æ˜¯æŒ‡å®šå›¾ä¾‹ä½ç½®çš„å‚æ•°ï¼Œå…¶å‚æ•°å€¼å¯ä»¥ç”¨å­—ç¬¦ä¸²æˆ–æ•´æ•°æ¥è¡¨ç¤ºï¼›</li><li>handles å‚æ•°ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªåºåˆ—ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰çº¿å‹çš„å®ä¾‹ï¼›</li><li><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html">æ›´å¤šå‚æ•°</a>ï¼ˆframeon,ncolç­‰ç­‰ï¼‰</li></ul><h1 id="æŠ¥é”™è§£å†³æ–¹æ¡ˆ"><a href="#æŠ¥é”™è§£å†³æ–¹æ¡ˆ" class="headerlink" title="æŠ¥é”™è§£å†³æ–¹æ¡ˆ"></a>æŠ¥é”™è§£å†³æ–¹æ¡ˆ</h1><blockquote><p><a href="https://blog.csdn.net/Crazy__1/article/details/103903962">This application failed to start because it could not find or load the Qt platform plugin â€œwindowsâ€<br>in â€œâ€.<br>Reinstalling the application may fix this problem.</a><br>å°†D:\python36\Library\pluginsç›®å½•ä¸‹çš„platformæ–‡ä»¶å¤¹å¤åˆ¶åˆ°D:\python36ä¸‹ã€‚D:\python36æ˜¯<a href="https://so.csdn.net/so/search?q=anaconda&spm=1001.2101.3001.7020">anaconda</a>å®‰è£…ç›®å½•ã€‚</p></blockquote>]]></content>
    
    
    <summary type="html">Pythonå­¦ä¹ ç¬”è®°</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Python" scheme="http://asucanyh-cn.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Pythonä¹‹pandasæ¨¡å—</title>
    <link href="http://asucanyh-cn.github.io/posts/2301760283/"/>
    <id>http://asucanyh-cn.github.io/posts/2301760283/</id>
    <published>2023-03-07T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>   Pandas åå­—è¡ç”Ÿè‡ªæœ¯è¯­ â€œpanel dataâ€ï¼ˆé¢æ¿æ•°æ®ï¼‰å’Œ â€œPython data analysisâ€ï¼Œä¸€ ä¸ªå¼ºå¤§çš„åˆ†æç»“æ„åŒ–æ•°æ®çš„å·¥å…·é›†ï¼ŒåŸºç¡€æ˜¯ Numpyï¼Œå¯ä»¥ä»å„ç§æ–‡ä»¶æ ¼å¼æ¯”å¦‚ CSVã€SQLã€ Excel å¯¼å…¥æ•°æ®ï¼Œå¯¹å„ç§æ•°æ®è¿›è¡Œè¿ç®—æ“ä½œï¼Œæ¯”å¦‚å½’å¹¶ã€å†æˆå½¢ã€é€‰æ‹©ï¼Œè¿˜æœ‰æ•°æ®æ¸…æ´—å’Œæ•° æ®åŠ å·¥ç‰¹å¾ã€‚Pandas å¹¿æ³›åº”ç”¨åœ¨å­¦æœ¯ã€é‡‘èã€ç»Ÿè®¡å­¦ç­‰å„ä¸ªæ•°æ®åˆ†æé¢†åŸŸã€‚Pandas çš„ä¸»è¦ æ•°æ®ç»“æ„æ˜¯ Series ï¼ˆä¸€ç»´æ•°æ®ï¼‰ä¸ DataFrameï¼ˆäºŒç»´æ•°æ®ï¼‰</p><h1 id="Serieså¯¹è±¡"><a href="#Serieså¯¹è±¡" class="headerlink" title="Serieså¯¹è±¡"></a>Serieså¯¹è±¡</h1><blockquote><p>Series æ˜¯ä¸€ä¸ªä¸€ç»´æ•°æ®ï¼ŒPandas ä¼šé»˜è®¤ç”¨ 0 åˆ° n-1 æ¥ä½œä¸º Series çš„ index, ä½†ä¹Ÿå¯ä»¥è‡ªå·± æŒ‡å®š indexï¼ˆå¯ä»¥æŠŠ index ç†è§£ä¸º dict é‡Œé¢çš„ keyï¼‰</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.Series( data, index, dtype, name, copy)</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><strong>data</strong>ï¼šä¸€ç»„æ•°æ®(ndarray ç±»å‹)ã€‚</li><li><strong>index</strong>ï¼šæ•°æ®ç´¢å¼•æ ‡ç­¾ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤ä» 0 å¼€å§‹ã€‚</li><li><strong>dtype</strong>ï¼šæ•°æ®ç±»å‹ï¼Œé»˜è®¤ä¼šè‡ªå·±åˆ¤æ–­ã€‚</li><li><strong>name</strong>ï¼šè®¾ç½®åç§°ã€‚</li><li><strong>copy</strong>ï¼šæ‹·è´æ•°æ®ï¼Œé»˜è®¤ä¸º Falseã€‚</li></ul><p><img src="https://asucanyh-cn.github.io/img/post/pandas-series.jpg"></p><h2 id="åˆ‡ç‰‡"><a href="#åˆ‡ç‰‡" class="headerlink" title="åˆ‡ç‰‡"></a>åˆ‡ç‰‡</h2><h2 id="dataä¸ºå­—å…¸"><a href="#dataä¸ºå­—å…¸" class="headerlink" title="dataä¸ºå­—å…¸"></a>dataä¸ºå­—å…¸</h2><blockquote><p>é»˜è®¤æ ¹æ®å­—å…¸çš„é”®ç å­—ç¬¦ä¸²é¡ºåºæ’åºï¼Œä¹Ÿå¯ä»¥è®¾å®šé¡ºåºã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">s = &#123;<span class="string">&quot;ton&quot;</span>: <span class="number">20</span>, <span class="string">&quot;mary&quot;</span>: <span class="number">18</span>, <span class="string">&quot;jack&quot;</span>: <span class="number">19</span>, <span class="string">&quot;car&quot;</span>: <span class="literal">None</span>&#125;</span><br><span class="line">sa = pd.Series(s)</span><br><span class="line"><span class="built_in">print</span>(sa)  <span class="comment"># é»˜è®¤æ ¹æ®å­—å…¸çš„é”®ç å­—ç¬¦ä¸²é¡ºåºæ’åº</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">car      NaN</span></span><br><span class="line"><span class="string">jack    19.0</span></span><br><span class="line"><span class="string">mary    18.0</span></span><br><span class="line"><span class="string">ton     20.0</span></span><br><span class="line"><span class="string">dtype: float64</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">## æŒ‡å®šé¡ºåº</span></span><br><span class="line">sa = pd.Series(s, index=[<span class="string">&#x27;ton&#x27;</span>, <span class="string">&#x27;mary&#x27;</span>, <span class="string">&#x27;jack&#x27;</span>, <span class="string">&#x27;car&#x27;</span>]) <span class="comment">#æŒ‡å®šé¡ºåº&#x27;ton&#x27;, &#x27;mary&#x27;, &#x27;jack&#x27;, &#x27;car&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(sa)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ton     20.0</span></span><br><span class="line"><span class="string">mary    18.0</span></span><br><span class="line"><span class="string">jack    19.0</span></span><br><span class="line"><span class="string">car      NaN</span></span><br><span class="line"><span class="string">dtype: float64</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="Pandasæ•°æ®æ¡†ï¼ˆDataFrameï¼‰"><a href="#Pandasæ•°æ®æ¡†ï¼ˆDataFrameï¼‰" class="headerlink" title="Pandasæ•°æ®æ¡†ï¼ˆDataFrameï¼‰"></a>Pandasæ•°æ®æ¡†ï¼ˆDataFrameï¼‰</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.DataFrame( data, index, columns, dtype, copy)</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><strong>data</strong>ï¼šä¸€ç»„æ•°æ®(ndarrayã€series, map, lists, dict ç­‰ç±»å‹)ã€‚</li><li><strong>index</strong>ï¼šç´¢å¼•å€¼ï¼Œæˆ–è€…å¯ä»¥ç§°ä¸ºè¡Œæ ‡ç­¾ã€‚</li><li><strong>columns</strong>ï¼šåˆ—æ ‡ç­¾ï¼Œé»˜è®¤ä¸º RangeIndex (0, 1, 2, â€¦, n) ã€‚</li><li><strong>dtype</strong>ï¼šæ•°æ®ç±»å‹ã€‚</li><li><strong>copy</strong>ï¼šæ‹·è´æ•°æ®ï¼Œé»˜è®¤ä¸º Falseã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pandasæ•°æ®æ¡†</span></span><br><span class="line">data = &#123;<span class="string">&#x27;id&#x27;</span>: [<span class="string">&#x27;Jack&#x27;</span>, <span class="string">&#x27;Sarah&#x27;</span>, <span class="string">&#x27;Mike&#x27;</span>],</span><br><span class="line"> <span class="string">&#x27;age&#x27;</span>: [<span class="number">18</span>, <span class="number">35</span>, <span class="number">20</span>],</span><br><span class="line"> <span class="string">&#x27;cash&#x27;</span>: [<span class="number">10.53</span>, <span class="number">500.7</span>, <span class="number">13.6</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data) <span class="comment">#è°ƒç”¨æ„é€ å‡½æ•°å¹¶å°†ç»“æœèµ‹å€¼ç»™ df</span></span><br><span class="line"><span class="built_in">print</span>(df) <span class="comment"># é»˜è®¤æ ¹æ®å­—å…¸çš„é”®ç å­—ç¬¦ä¸²é¡ºåºæ’åº</span></span><br><span class="line"><span class="comment">## æŒ‡å®šé¡ºåº</span></span><br><span class="line">df = pd.DataFrame(data,index=[<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;age&#x27;</span>,<span class="string">&#x27;cash&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><h3 id="å¯¹-DataFrame-å¯¹è±¡å¢åŠ åˆ—"><a href="#å¯¹-DataFrame-å¯¹è±¡å¢åŠ åˆ—" class="headerlink" title="å¯¹ DataFrame å¯¹è±¡å¢åŠ åˆ—"></a>å¯¹ DataFrame å¯¹è±¡å¢åŠ åˆ—</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df[&quot;rich&quot;]=df[&quot;cash&quot;]&gt;200</span><br><span class="line">print(df)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">      age    cash     id   rich</span><br><span class="line">id     18   10.53   Jack  False</span><br><span class="line">age    35  500.70  Sarah   True</span><br><span class="line">cash   20   13.60   Mike  False</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## æŒ‡å®šåˆ—çš„é¡ºåº</span></span><br><span class="line"><span class="attribute">df2</span>=pd.DataFrame(data,columns=[<span class="string">&quot;id&quot;</span>,<span class="string">&quot;age&quot;</span>,<span class="string">&quot;cash&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(df2)</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®æ¡†ç´¢å¼•"><a href="#æ•°æ®æ¡†ç´¢å¼•" class="headerlink" title="æ•°æ®æ¡†ç´¢å¼•"></a><a href="https://blog.csdn.net/qq_41913559/article/details/107561309">æ•°æ®æ¡†ç´¢å¼•</a></h2><p>â‘ iloc ä¸»è¦ä½¿ç”¨æ•°å­—æ¥ç´¢å¼•æ•°æ®ï¼Œè€Œä¸èƒ½ä½¿ç”¨å­—ç¬¦å‹çš„æ ‡ç­¾æ¥ç´¢å¼•æ•°æ®ã€‚è€Œ loc åˆ™åˆšå¥½ ç›¸åï¼Œåªèƒ½ä½¿ç”¨å­—ç¬¦å‹æ ‡ç­¾æ¥ç´¢å¼•æ•°æ®ï¼Œä¸èƒ½ä½¿ç”¨æ•°å­—æ¥ç´¢å¼•æ•°æ®ã€‚æ³¨æ„ï¼šæ•°å­—ç´¢å¼•èŒƒå›´ä¸ åŒ…æ‹¬ç»“å°¾ï¼Œè€Œå­—ç¬¦ç´¢å¼•èŒƒå›´åŒ…æ‹¬ç»“å°¾ã€‚</p><p>â‘¡ix æ˜¯ä¸€ç§æ··åˆç´¢å¼•ï¼Œå­—ç¬¦å‹æ ‡ç­¾å’Œæ•´å‹æ•°æ®ç´¢å¼•éƒ½å¯ä»¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## æ•°æ®å¼•ç”¨</span></span><br><span class="line"><span class="comment">### å¼•ç”¨åˆ—ã€åˆ‡ç‰‡ã€å®šä½æŸä¸ªæ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df2[<span class="string">&quot;id&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(df2.iloc[<span class="number">0</span>:<span class="number">2</span>,<span class="number">0</span>:<span class="number">2</span>]) <span class="comment"># é€—å·å·¦ä¾§ä¸ºè¡Œï¼Œå³ä¾§ä¸ºåˆ—</span></span><br><span class="line"><span class="built_in">print</span>(df2.iloc[:])</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®æ¸…æ´—"><a href="#æ•°æ®æ¸…æ´—" class="headerlink" title="æ•°æ®æ¸…æ´—"></a>æ•°æ®æ¸…æ´—</h2><h2 id="åˆ é™¤ç©ºå€¼çš„è¡Œ-x2F-åˆ—"><a href="#åˆ é™¤ç©ºå€¼çš„è¡Œ-x2F-åˆ—" class="headerlink" title="åˆ é™¤ç©ºå€¼çš„è¡Œ&#x2F;åˆ—"></a><a href="https://blog.csdn.net/qq_17753903/article/details/89817371">åˆ é™¤ç©ºå€¼çš„è¡Œ&#x2F;åˆ—</a></h2><blockquote><p>è¯­æ³•æ ¼å¼</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>, thresh=<span class="literal">None</span>, subset=<span class="literal">None</span>, inplace=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><blockquote><p>å‚æ•°è¯¦è§£</p></blockquote><ul><li><p>axisï¼šè½´ã€‚0æˆ–â€™indexâ€™ï¼Œè¡¨ç¤ºæŒ‰è¡Œåˆ é™¤ï¼›1æˆ–â€™columnsâ€™ï¼Œè¡¨ç¤ºæŒ‰åˆ—åˆ é™¤ã€‚</p></li><li><p>howï¼šç­›é€‰æ–¹å¼ã€‚â€˜anyâ€™ï¼Œè¡¨ç¤ºè¯¥è¡Œ&#x2F;åˆ—åªè¦æœ‰ä¸€ä¸ªä»¥ä¸Šçš„ç©ºå€¼ï¼Œå°±åˆ é™¤è¯¥è¡Œ&#x2F;åˆ—ï¼›â€˜allâ€™ï¼Œè¡¨ç¤ºè¯¥è¡Œ&#x2F;åˆ—å…¨éƒ¨éƒ½ä¸ºç©ºå€¼ï¼Œå°±åˆ é™¤è¯¥è¡Œ&#x2F;åˆ—ã€‚</p></li><li><p>threshï¼šéç©ºå…ƒç´ æœ€ä½æ•°é‡ã€‚intå‹ï¼Œé»˜è®¤ä¸ºNoneã€‚å¦‚æœè¯¥è¡Œ&#x2F;åˆ—ä¸­ï¼Œéç©ºå…ƒç´ æ•°é‡å°äºè¿™ä¸ªå€¼ï¼Œå°±åˆ é™¤è¯¥è¡Œ&#x2F;åˆ—ã€‚</p></li><li><p>subsetï¼šå­é›†ã€‚åˆ—è¡¨ï¼Œå…ƒç´ ä¸ºè¡Œæˆ–è€…åˆ—çš„ç´¢å¼•ã€‚å¦‚æœaxis&#x3D;0æˆ–è€…â€˜indexâ€™ï¼Œsubsetä¸­å…ƒç´ ä¸ºåˆ—çš„ç´¢å¼•ï¼›å¦‚æœaxis&#x3D;1æˆ–è€…â€˜columnâ€™ï¼Œsubsetä¸­å…ƒç´ ä¸ºè¡Œçš„ç´¢å¼•ã€‚ç”±subseté™åˆ¶çš„å­åŒºåŸŸï¼Œæ˜¯åˆ¤æ–­æ˜¯å¦åˆ é™¤è¯¥è¡Œ&#x2F;åˆ—çš„æ¡ä»¶åˆ¤æ–­åŒºåŸŸã€‚</p></li><li><p>inplaceï¼šæ˜¯å¦åŸåœ°æ›¿æ¢ã€‚å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸ºFalseã€‚å¦‚æœä¸ºTrueï¼Œåˆ™åœ¨åŸDataFrameä¸Šè¿›è¡Œæ“ä½œï¼Œè¿”å›å€¼ä¸ºNoneã€‚</p></li></ul><blockquote><p>æ¡ˆä¾‹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;titanic.csv&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.head().to_string())</span><br><span class="line"><span class="comment"># print(df.describe().to_string())</span></span><br><span class="line"><span class="comment"># print(df.describe(include=&#x27;all&#x27;).to_string())</span></span><br><span class="line"><span class="comment">## åˆ é™¤ç©ºå€¼çš„è¡Œ</span></span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;age&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;age&#x27;</span>].isnull())</span><br><span class="line">new_df=df.dropna(subset=[<span class="string">&#x27;age&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(new_df.describe().to_string())</span><br><span class="line"><span class="built_in">print</span>(new_df[<span class="string">&#x27;age&#x27;</span>].isnull().head())</span><br></pre></td></tr></table></figure><h3 id="å¡«å……ç©ºå€¼"><a href="#å¡«å……ç©ºå€¼" class="headerlink" title="å¡«å……ç©ºå€¼"></a>å¡«å……ç©ºå€¼</h3><blockquote><p>è¯­æ³•ç»“æ„</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.fillna(value=<span class="literal">None</span>, method=<span class="literal">None</span>, axis=<span class="literal">None</span>, inplace=<span class="literal">False</span>, limit=<span class="literal">None</span>, downcast=<span class="literal">None</span>, **kwargs)</span><br></pre></td></tr></table></figure><blockquote><p>å‚æ•°è¯¦è§£</p></blockquote><ul><li>value: å˜é‡ã€å­—å…¸ã€Seriesï¼ŒDataFrameï¼›ç”¨äºå¡«å……å¡«å……ç¼ºå¤±å€¼ï¼Œæˆ–æŒ‡å®šä¸ºæ¯ä¸ªç´¢å¼•ï¼ˆå¯¹äºSeriesï¼‰æˆ–åˆ—ï¼ˆå¯¹äºDataFrameï¼‰çš„ç¼ºå¤±å€¼ä½¿ç”¨å­—å…¸&#x2F;Series&#x2F;DataFrameçš„å€¼å¡«å……</li><li>method: {â€˜backfillâ€™, â€˜bfillâ€™, â€˜padâ€™, â€˜ffillâ€™, None}, é»˜è®¤Noneï¼Œ pad&#x2F;ffillè¡¨ç¤ºå‘åå¡«å……ç©ºå€¼ï¼Œbackfill&#x2F;bfillè¡¨ç¤ºå‘å‰å¡«å……ç©ºå€¼</li><li>axis: {0 or â€˜indexâ€™, 1 or â€˜columnsâ€™}</li><li>inplace: boolean, é»˜è®¤ä¸ºFalseã€‚è‹¥ä¸ºTrueï¼Œ åœ¨åŸåœ°å¡«æ»¡</li><li>limit: int, é»˜è®¤ä¸ºNoneï¼Œ å¦‚æœæŒ‡å®šäº†æ–¹æ³•ï¼Œ åˆ™è¿™æ˜¯è¿ç»­çš„NaNå€¼çš„å‰å‘&#x2F;åå‘å¡«å……çš„æœ€å¤§æ•°é‡</li><li>downcast: dict, é»˜è®¤Noneï¼Œ å­—å…¸ä¸­çš„é¡¹ä¸ºç±»å‹å‘ä¸‹è½¬æ¢è§„åˆ™ã€‚</li></ul><blockquote><p>æ¡ˆä¾‹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x=<span class="built_in">round</span>(df[<span class="string">&#x27;age&#x27;</span>].mean(),<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line">df[<span class="string">&#x27;age&#x27;</span>].fillna(x,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(df.head().to_string())</span><br></pre></td></tr></table></figure><h3 id="è½¬æ¢åˆ—çš„æ—¥æœŸæ ¼å¼"><a href="#è½¬æ¢åˆ—çš„æ—¥æœŸæ ¼å¼" class="headerlink" title="è½¬æ¢åˆ—çš„æ—¥æœŸæ ¼å¼"></a><a href="https://www.delftstack.com/zh/howto/python-pandas/how-to-convert-dataframe-column-to-datetime-in-pandas/#:~:text=%E5%A6%82%E4%BD%95%E5%9C%A8%20Pandas%20%E4%B8%AD%E5%B0%86%20DataFrame%20%E5%88%97%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%201%20Pandas%20to_datetime,%E6%96%B9%E6%B3%95%E5%B0%86%20DataFrame%20%E5%88%97%E8%BD%AC%E6%8D%A2%E4%B8%BA%20Datetime%203%20%E5%B0%86%20DataFrame%20%E5%88%97%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E6%96%B9%E6%B3%95%E7%9A%84%E6%80%A7%E8%83%BD%E6%AF%94%E8%BE%83">è½¬æ¢åˆ—çš„æ—¥æœŸæ ¼å¼</a></h3><blockquote><p>è¯­æ³•æ ¼å¼</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.to_datetime(param, <span class="built_in">format</span>=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><div class="admonition note"><p class="admonition-title">å‚æ•°è¯¦è§£</p><p><a href="https://blog.csdn.net/qq_39290225/article/details/98313743">to_datetimeçš„å‚æ•°è¯¦è§£</a></p></div><blockquote><p>æ¡ˆä¾‹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## å¤„ç†æ—¥æœŸ(å­—ç¬¦è½¬æ¢ä¸ºæ—¥æœŸ)</span></span><br><span class="line">data=&#123;</span><br><span class="line">  <span class="string">&#x27;Date&#x27;</span>:[<span class="string">&#x27;2023/3/1&#x27;</span>,<span class="string">&#x27;2022/1/1&#x27;</span>],</span><br><span class="line">   <span class="string">&#x27;age&#x27;</span>:[<span class="number">50</span>,<span class="number">10</span>]</span><br><span class="line">&#125;</span><br><span class="line">df=pd.DataFrame(data,index=[<span class="string">&#x27;day1&#x27;</span>,<span class="string">&#x27;day2&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df[<span class="string">&#x27;Date&#x27;</span>]=pd.to_datetime(df[<span class="string">&#x27;Date&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤ç©ºè¡Œåé‡ç½®ç´¢å¼•"><a href="#åˆ é™¤ç©ºè¡Œåé‡ç½®ç´¢å¼•" class="headerlink" title="åˆ é™¤ç©ºè¡Œåé‡ç½®ç´¢å¼•"></a><a href="https://cloud.tencent.com/developer/article/2230126#:~:text=%E3%80%90%E6%8A%80%E5%B7%A7%E3%80%91Pandas%E4%BD%BF%E7%94%A8drop%E5%90%8E%E4%BD%BF%E7%94%A8reset_index%E9%87%8D%E7%BD%AE%E7%B4%A2%E6%80%A7%20%E6%88%91%E4%BB%AC%E5%9C%A8%E4%BD%BF%E7%94%A8%20drop,%E5%87%BD%E6%95%B0%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E5%80%BC%E7%9A%84%E8%A1%8C%E5%90%8E%EF%BC%8C%20%E5%8E%9F%E6%9D%A5%E7%9A%84%E7%B4%A2%E5%BC%95%E8%BF%98%E6%98%AF%E4%BF%9D%E7%95%99%E7%9A%84%20%EF%BC%81">åˆ é™¤ç©ºè¡Œåé‡ç½®ç´¢å¼•</a></h2><blockquote><p>reset_index()å‡½æ•°</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.reset_index(drop=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><div class="admonition note"><p class="admonition-title">ç®±çº¿å›¾Keyvalue:0æŠ¥é”™</p><p>åŸå› å¯èƒ½å°±æ˜¯å»é™¤äº†ç©ºå€¼ï¼Œå»é™¤äº†index=0çš„å…ƒç´ ï¼Œè¿™ä¸ªæ—¶å€™å°†ç´¢å¼•é‡ç½®å°±å¯ä»¥è§£å†³é—®é¢˜</p></div><h1 id="åˆ†ç»„æ±‡æ€»"><a href="#åˆ†ç»„æ±‡æ€»" class="headerlink" title="åˆ†ç»„æ±‡æ€»"></a><a href="https://blog.csdn.net/FGH333xwy/article/details/110672407">åˆ†ç»„æ±‡æ€»</a></h1><blockquote><p>groupby()æ ¸å¿ƒç”¨æ³•æ€»ç»“</p></blockquote><ol><li>æ ¹æ®DataFrameæœ¬èº«çš„æŸä¸€åˆ—æˆ–å¤šåˆ—å†…å®¹è¿›è¡Œåˆ†ç»„èšåˆ:</li></ol><p>ï¼ˆaï¼‰è‹¥æŒ‰æŸä¸€åˆ—èšåˆï¼Œåˆ™æ–°DataFrameå°†æ ¹æ®æŸä¸€åˆ—çš„å†…å®¹åˆ†ä¸ºä¸åŒçš„ç»´åº¦è¿›è¡Œæ‹†è§£ï¼ŒåŒæ—¶å°†åŒä¸€ç»´åº¦çš„å†è¿›è¡Œèšåˆï¼Œ<br>ï¼ˆbï¼‰è‹¥æŒ‰æŸå¤šåˆ—èšåˆï¼Œåˆ™æ–°DataFrameå°†æ˜¯å¤šåˆ—ä¹‹é—´ç»´åº¦çš„ç¬›å¡å°”ç§¯ï¼Œå³ï¼šæ–°DataFrameå…·æœ‰ä¸€ä¸ªå±‚æ¬¡åŒ–ç´¢å¼•ï¼ˆç”±å”¯ä¸€çš„é”®å¯¹ç»„æˆï¼‰ï¼Œä¾‹å¦‚ï¼šâ€œkey1â€åˆ—ï¼Œæœ‰aå’Œbä¸¤ä¸ªç»´åº¦ï¼Œè€Œâ€œkey2â€æœ‰oneå’Œtwoä¸¤ä¸ªç»´åº¦ï¼Œåˆ™æŒ‰â€œkey1â€åˆ—å’Œâ€œkey2â€èšåˆä¹‹åï¼Œæ–°DataFrameå°†æœ‰å››ä¸ªgroupï¼›<br>ï¼ˆcï¼‰é€šè¿‡è°ƒç”¨get_group()å‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªæŒ‰ç…§åˆ†ç»„å¾—åˆ°çš„DataFrameå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯åˆ†ç»„ä¸­çš„ä¸€ç§æƒ…å†µï¼›<br>ï¼ˆdï¼‰å¯ä»¥å°†æƒ³è¦è®¡ç®—çš„åˆ—ï¼ˆå¯ä»¥æ˜¯å•åˆ—ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šåˆ—ï¼‰é€šè¿‡ç´¢å¼•çš„æ–¹å¼å–å‡ºæ¥ï¼Œç„¶ååœ¨å–å‡ºæ¥è¿™åˆ—æ•°æ®çš„åŸºç¡€ä¸Šè¿›è¡Œæ±‡æ€»è®¡ç®—ã€‚egï¼šdf.groupby(â€œçŠ¶æ€â€)[â€œåŒºâ€]ã€df.groupby(â€œçŠ¶æ€â€)[[â€œåŒºâ€,â€œçœâ€]]</p><p>æ³¨æ„ï¼šgroupbyé»˜è®¤æ˜¯åœ¨axis&#x3D;0ä¸Šè¿›è¡Œåˆ†ç»„çš„ï¼Œé€šè¿‡è®¾ç½®axis&#x3D;1ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶ä»–ä»»ä½•è½´ä¸Šè¿›è¡Œåˆ†ç»„ã€‚</p><ol start="2"><li>GroupByå¯¹è±¡ç»“åˆæè¿°ç»Ÿè®¡æ–¹æ³•ä»å„ä¸ªåˆ†ç»„ä¸­äº§ç”Ÿæ ‡é‡å€¼ï¼š</li></ol><p>ï¼ˆaï¼‰è¿™ä¸ªæ ‡é‡å€¼å¯ä»¥æ˜¯å¹³å‡å€¼ã€æ•°é‡ã€ä¸­ä½æ•°ç­‰ã€‚GroupByå¯¹è±¡å¸¸ç”¨çš„æè¿°æ€§ç»Ÿè®¡æ–¹æ³•å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="https://asucanyh-cn.github.io/img/post/groupby.png"></p><h2 id="æ™®é€šè¿‡æ»¤"><a href="#æ™®é€šè¿‡æ»¤" class="headerlink" title="æ™®é€šè¿‡æ»¤"></a>æ™®é€šè¿‡æ»¤</h2><h2 id="åˆ†ç»„è¿‡æ»¤"><a href="#åˆ†ç»„è¿‡æ»¤" class="headerlink" title="åˆ†ç»„è¿‡æ»¤"></a>åˆ†ç»„è¿‡æ»¤</h2>]]></content>
    
    
    <summary type="html">Pythonå­¦ä¹ ç¬”è®°</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Python" scheme="http://asucanyh-cn.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>åˆè¯†SpringBoot</title>
    <link href="http://asucanyh-cn.github.io/posts/3446401948/"/>
    <id>http://asucanyh-cn.github.io/posts/3446401948/</id>
    <published>2023-03-07T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Spring-Boot-æ³¨è§£æœ‰å“ªäº›ï¼Ÿ"><a href="#Spring-Boot-æ³¨è§£æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="Spring Boot æ³¨è§£æœ‰å“ªäº›ï¼Ÿ"></a>Spring Boot æ³¨è§£æœ‰å“ªäº›ï¼Ÿ</h1><ol><li>äº†è§£å¸¸è§çš„æ³¨è§£ä»¥åŠä½¿ç”¨çš„å±‚çº§</li><li>äº†è§£æ³¨è§£çš„å«ä¹‰</li></ol><h1 id="Spring-Booté¡¹ç›®çš„å±‚çº§å…³ç³»"><a href="#Spring-Booté¡¹ç›®çš„å±‚çº§å…³ç³»" class="headerlink" title="Spring Booté¡¹ç›®çš„å±‚çº§å…³ç³»"></a>Spring Booté¡¹ç›®çš„å±‚çº§å…³ç³»</h1><h2 id="entityå±‚"><a href="#entityå±‚" class="headerlink" title="entityå±‚"></a>entityå±‚</h2><p>entityå±‚ä¸ºæ•°æ®åº“å®ä½“å±‚ï¼Œä¸€èˆ¬ä¸€ä¸ªå®ä½“ç±»å¯¹åº”æ•°æ®åº“ä¸­çš„ä¸€å¼ æ•°æ®è¡¨ï¼Œç±»ä¸­çš„å±æ€§ä¸æ•°æ®è¡¨ä¸­çš„å­—æ®µä¸€ ä¸€å¯¹åº”ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç±»åå³ä¸ºæ•°æ®è¡¨çš„è¡¨åï¼Œå±æ€§ååˆ™æ˜¯å¯¹åº”å­—æ®µåï¼Œå­—æ®µç±»å‹ä¹Ÿä¸å˜é‡çš„ç±»å‹ç›¸å¯¹åº”ã€‚</p><h3 id="Entity"><a href="#Entity" class="headerlink" title="@Entity"></a>@Entity</h3><p>è¯¥æ³¨è§£ç”¨äºè¡¨æ˜è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªå®ä½“ç±»ï¼Œä¼šç»™ä»–ç”Ÿæˆä¸€å¼ å¯¹åº”çš„æ•°æ®è¡¨ã€‚</p><h3 id="Table-name-x3D-â€œtable-nameâ€"><a href="#Table-name-x3D-â€œtable-nameâ€" class="headerlink" title="@Table(name &#x3D; â€œtable_nameâ€)"></a>@Table(name &#x3D; â€œtable_nameâ€)</h3><p>è¯¥æ³¨è§£ä¸»è¦ç”¨äºä¿®æ”¹è¡¨åï¼Œnameçš„å€¼å°±æ˜¯ä¿®æ”¹çš„æ•°æ®è¡¨çš„åç§°ã€‚</p><h3 id="Id"><a href="#Id" class="headerlink" title="@Id"></a>@Id</h3><p>è¯¥æ³¨è§£ç”¨äºå£°æ˜ä¸»é”®ï¼Œæ ‡åœ¨å“ªä¸ªå±æ€§ä¸Šé¢å¯¹åº”çš„å“ªä¸ªå­—æ®µå°±æ˜¯ä¸»é”®</p><h3 id="GeneratedValue-strategy-x3D-GenerationType-IDENTITY"><a href="#GeneratedValue-strategy-x3D-GenerationType-IDENTITY" class="headerlink" title="@GeneratedValue(strategy &#x3D; GenerationType.IDENTITY)"></a>@GeneratedValue(strategy &#x3D; GenerationType.IDENTITY)</h3><p>è¯¥æ³¨è§£çš„strategyå±æ€§ä¸»è¦ç”¨äºè®¾ç½®ä¸»é”®çš„å¢é•¿æ–¹å¼ï¼ŒIDENTITYè¡¨ç¤ºä¸»é”®ç”±æ•°æ®åº“è‡ªå·±ç”Ÿæˆï¼Œä»1å¼€å§‹å•è°ƒé€’å¢ã€‚</p><h3 id="Column-name-x3D-â€œcolumn-nameâ€"><a href="#Column-name-x3D-â€œcolumn-nameâ€" class="headerlink" title="@Column(name &#x3D; â€œcolumn_nameâ€)"></a>@Column(name &#x3D; â€œcolumn_nameâ€)</h3><p>è¯¥æ³¨è§£çš„nameå±æ€§ç”¨äºæ›´æ”¹æ•°æ®è¡¨çš„åˆ—åï¼Œå¦‚æœä¸æƒ³ç”¨é»˜è®¤çš„å°±ç”¨è¿™ä¸ªå±æ€§æ”¹å§<br>@ManyToMany(cascade &#x3D; CascadeType.ALL, fetch &#x3D; FetchType.LAZY)<br>è¿™ä¸ªæ³¨è§£å¾—ä¸Šæ˜¯æœ¬é¡¹ç›®å¾—æ ¸å¿ƒäº†ï¼Œå®ƒå£°æ˜äº†å®ä½“ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»ï¼Œä½¿ä¸¤å¼ æ•°æ®è¡¨å…³è”å…³è”èµ·æ¥ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ç”Ÿæˆä¸€å¼ æ˜ å°„è¡¨æ¥å®ç°è¿™ç§æ˜ å°„å…³ç³»ã€‚å…³äºä¸Šé¢çš„cascadeå±æ€§å’Œfetchå±æ€§ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥æŸ¥èµ„æ–™äº†è§£ã€‚</p><h3 id="JoinTable"><a href="#JoinTable" class="headerlink" title="@JoinTable"></a>@JoinTable</h3><p>è¿™ä¸ªæ³¨è§£æ˜¯é…å¥—@ManyToManyä½¿ç”¨çš„ï¼Œä¸€èˆ¬åœ¨å¤šå¯¹å¤šå…³ç³»çš„ç»´æŠ¤ç«¯æ ‡æ³¨ï¼Œç”¨äºç”Ÿæˆä¸Šé¢æåˆ°çš„æ˜ å°„è¡¨ã€‚ä¸€èˆ¬è¯¥æ³¨è§£å¸¸ç”¨ä¸‰ä¸ªå±æ€§ï¼šnameå±æ€§è¡¨ç¤ºç”Ÿæˆçš„æ•°æ®è¡¨çš„åç§°ï¼ŒjoinColumnså±æ€§è¡¨ç¤ºå…³ç³»ç»´æŠ¤ç«¯çš„ä¸»é”®ï¼ŒinverseJoinColumnsåˆ™è¡¨ç¤ºå…³ç³»è¢«ç»´æŠ¤ç«¯çš„ä¸»é”®ã€‚å…³äºåµŒå¥—åœ¨é‡Œé¢çš„@JoinColumnæ³¨è§£ï¼Œåœ¨è¿™é‡Œä¸»è¦ç”¨äºé…ç½®æ˜ å°„è¡¨çš„å¤–é”®ï¼Œä¸€èˆ¬æœ‰ä¸¤ä¸ªå±æ€§ï¼šnameç”¨äºé…ç½®å¤–é”®åœ¨æ˜ å°„è¡¨ä¸­çš„åç§°ï¼ŒreferencedColumnName ç”¨äºè¡¨æ˜å¤–é”®åœ¨åŸè¡¨ä¸­çš„å­—æ®µåç§°ã€‚</p><h3 id="JsonBackReference"><a href="#JsonBackReference" class="headerlink" title="@JsonBackReference"></a>@JsonBackReference</h3><p>å…³äºè¿™ä¸ªæ³¨è§£ï¼Œå»ºè®®å…ˆå»æ‰è¯•è¯•ç„¶åå†åŠ ä¸Šï¼Œå¯¹æ¯”ä¸€ä¸‹æ•ˆæœã€‚å®ƒä¸»è¦å¯ä»¥ä½¿æ ‡æ³¨å±æ€§é¿å…è¢«jsonåºåˆ—åŒ–ï¼Œè¿›è€Œé¿å…å¤šå¯¹å¤šå…³ç³»çš„æŸ¥è¯¢ä¸­å‡ºç°æ­»å¾ªç¯çš„æƒ…å†µã€‚ä½†æ˜¯åŠ ä¸Šäº†è¿™æ³¨è§£åï¼Œå°±ä¸èƒ½è¿›è¡Œåå‘æŸ¥è¯¢äº†ï¼ˆä¹Ÿå°±æ˜¯è¯´ä¸èƒ½åˆ©ç”¨æƒé™åæŸ¥è¯¢æ‹¥æœ‰è¿™ä¸ªæƒé™çš„è§’è‰²äº†ï¼‰</p><h2 id="repository"><a href="#repository" class="headerlink" title="repository"></a>repository</h2><p>ä¹Ÿå¯ä»¥ç§°daoå±‚ï¼Œæˆ–mapperå±‚ï¼Œæ˜¯æ•°æ®æŒä¹…å±‚ã€‚ä¸»è¦è´Ÿè´£è®¿é—®æ•°æ®åº“ï¼Œå‘æ•°æ®åº“å‘é€<a href="https://so.csdn.net/so/search?q=SQL%E8%AF%AD%E5%8F%A5&spm=1001.2101.3001.7020">SQLè¯­å¥</a>ï¼Œå®ŒæˆåŸºç¡€çš„å¢åˆ æŸ¥æ”¹ä»»åŠ¡ã€‚ä¸»è¦é€šè¿‡å®šä¹‰ç»§æ‰¿JpaRepositoryç±»çš„æ¥å£æ¥å®ç°ï¼Œ&lt;&gt;ä¸­å¡«å†™çš„æ˜¯å®ä½“ç±»çš„åç§°å’Œè¯¥å®ä½“ä¸»é”®çš„å˜é‡ç±»å‹ã€‚</p><h2 id="service"><a href="#service" class="headerlink" title="service"></a>service</h2><p>serviceå±‚æ˜¯ä¸šåŠ¡é€»è¾‘å±‚ï¼Œ<strong>ä¸»è¦é€šè¿‡è°ƒç”¨æŒä¹…å±‚çš„æ¥å£ï¼Œæ¥æ”¶æŒä¹…å±‚è¿”å›çš„æ•°æ®ï¼Œå®Œæˆé¡¹ç›®çš„åŸºæœ¬åŠŸèƒ½è®¾è®¡</strong>ã€‚</p><h2 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h2><p>controllerå±‚æ˜¯æ§åˆ¶å±‚ï¼Œå…¶åŠŸèƒ½ä¸ºè¯·æ±‚å’Œå“åº”æ§åˆ¶ï¼Œè´Ÿè´£å‰åç«¯äº¤äº’ï¼Œæ¥å—å‰ç«¯è¯·æ±‚ï¼Œè°ƒç”¨serviceå±‚ï¼Œæ¥æ”¶serviceå±‚è¿”å›çš„æ•°æ®ï¼Œæœ€åè¿”å›å…·ä½“çš„é¡µé¢å’Œæ•°æ®åˆ°å®¢æˆ·ç«¯ã€‚</p><h3 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a><a href="https://www.w3cschool.cn/wkspring/rw2h1mmj.html">@Autowired</a></h3><p>Springé€šè¿‡æä¾›@Autowiredæ³¨è§£æ¥æä¾›åŸºäºæ³¨è§£çš„è‡ªåŠ¨è£…é…ã€‚</p><p>è‡ªåŠ¨è£…é…æŒ‡çš„å°±æ˜¯ä½¿ç”¨å°† Spring å®¹å™¨ä¸­çš„ bean è‡ªåŠ¨çš„å’Œæˆ‘ä»¬éœ€è¦è¿™ä¸ª bean çš„ç±»ç»„è£…åœ¨ä¸€èµ·ã€‚</p><h3 id="Controller"><a href="#Controller" class="headerlink" title="@Controller"></a>@Controller</h3><p>å¤„ç†httpè¯·æ±‚</p><h3 id="RestController"><a href="#RestController" class="headerlink" title="@RestController"></a>@RestController</h3><p>è¿”å›jsonï¼ˆç›¸å½“äº@ResponseBodyé…åˆ@Controllerï¼‰</p><h3 id="RequestMapping"><a href="#RequestMapping" class="headerlink" title="@RequestMapping"></a>@RequestMapping</h3><p>é…ç½®urlæ˜ å°„ï¼ˆå¯ä¼ å…¥æ•°ç»„ï¼ŒCrtl+PæŸ¥çœ‹ï¼‰</p><h3 id="PathVariable"><a href="#PathVariable" class="headerlink" title="@PathVariable"></a>@PathVariable</h3><p>è·å–urlä¸­çš„æ•°æ®</p><h3 id="RequestParam"><a href="#RequestParam" class="headerlink" title="@RequestParam"></a>@RequestParam</h3><p>è·å–è¯·æ±‚å‚æ•°çš„å€¼</p><h1 id="Spring-Boot-åº”ç”¨å±æ€§"><a href="#Spring-Boot-åº”ç”¨å±æ€§" class="headerlink" title="Spring Boot åº”ç”¨å±æ€§"></a><a href="https://www.cainiaojc.com/springboot/springboot-properties.html">Spring Boot åº”ç”¨å±æ€§</a></h1><h1 id="SpringBoot-Starters"><a href="#SpringBoot-Starters" class="headerlink" title="SpringBoot Starters"></a><a href="https://www.cainiaojc.com/springboot/springboot-starters.html">SpringBoot Starters</a></h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.eclipse.persistence&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;org.eclipse.persistence.jpa&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;<span class="number">2.6</span><span class="number">.0</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">SpringBootå­¦ä¹ ç¬”è®°ã€‚</summary>
    
    
    
    <category term="è®¡ç®—æœºç¼–ç¨‹" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Mysql" scheme="http://asucanyh-cn.github.io/tags/Mysql/"/>
    
    <category term="LinuxDeploy" scheme="http://asucanyh-cn.github.io/tags/LinuxDeploy/"/>
    
  </entry>
  
  <entry>
    <title>mysqlå®‰è£…ä»¥åŠé…ç½®</title>
    <link href="http://asucanyh-cn.github.io/posts/1508968307/"/>
    <id>http://asucanyh-cn.github.io/posts/1508968307/</id>
    <published>2023-02-22T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install mysql-server</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">linuxdeployä¸­éœ€è¦ä¸ºç”¨æˆ·æ·»åŠ ç‰¹æƒ</span></span><br><span class="line">usermod -a -G aid_inet,aid_net_raw mysql</span><br><span class="line">usermod -a -G aid_inet,aid_net_raw root</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">mysqld</span></span><br><span class="line">service mysql start </span><br></pre></td></tr></table></figure><h1 id="å…è®¸æ‰€æœ‰ä¸»æœºç™»å½•"><a href="#å…è®¸æ‰€æœ‰ä¸»æœºç™»å½•" class="headerlink" title="å…è®¸æ‰€æœ‰ä¸»æœºç™»å½•"></a>å…è®¸æ‰€æœ‰ä¸»æœºç™»å½•</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE mysql;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ”¹è¡¨æ³•</span></span><br><span class="line">UPDATE user SET host=&#x27;%&#x27; WHERE user=&#x27;root&#x27;;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æˆæƒæ³•</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">GRANT ALL PRIVILEGES ON *.* TO <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED BY <span class="string">&#x27;mypassword&#x27;</span> WITH GRANT OPTION;</span></span><br></pre></td></tr></table></figure><h1 id="ä¿®æ”¹ç™»å½•æˆæƒæ–¹å¼"><a href="#ä¿®æ”¹ç™»å½•æˆæƒæ–¹å¼" class="headerlink" title="ä¿®æ”¹ç™»å½•æˆæƒæ–¹å¼"></a>ä¿®æ”¹ç™»å½•æˆæƒæ–¹å¼</h1><p><a href="https://blog.csdn.net/cruiserblog/article/details/106934570">MySQL8.0çš„ç‰ˆæœ¬æ›´æ”¹äº†rootè´¦æˆ·çš„æˆæƒæ–¹å¼ï¼Œé»˜è®¤æ˜¯auth_socketã€‚ä¹Ÿå°±æ˜¯è¯´éœ€è¦é€šè¿‡ Unix socket æ–‡ä»¶æ¥éªŒè¯æ‰€æœ‰è¿æ¥åˆ°localhostçš„ç”¨æˆ·ï¼Œä¸èƒ½ä½¿ç”¨æä¾›å¯†ç çš„æ–¹å¼äº†ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡ä¸‹é¢çš„æŒ‡ä»¤æ›´ä¸€ä¸‹æˆæƒæ–¹å¼ã€‚</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line">[mysqld]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">user=mysql</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">validate_password.policy=LOW</span></span><br><span class="line">default_authentication_plugin=mysql_native_password</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ALTER USER <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;å¯è®¿é—®rootçš„ä¸»æœº&#x27;</span> IDENTIFIED WITH mysql_native_password BY <span class="string">&#x27;rootçš„å¯†ç &#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®å¯†ç </span></span><br><span class="line">ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h1 id="é‡å¯mysql"><a href="#é‡å¯mysql" class="headerlink" title="é‡å¯mysql"></a>é‡å¯mysql</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql restart</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo apt install mysql-server&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre</summary>
    
    
    
    
    <category term="Mysql" scheme="http://asucanyh-cn.github.io/tags/Mysql/"/>
    
    <category term="LinuxDeploy" scheme="http://asucanyh-cn.github.io/tags/LinuxDeploy/"/>
    
  </entry>
  
  <entry>
    <title>Zerotieréƒ¨ç½²planetæ ¹èŠ‚ç‚¹ï¼Œæé«˜é€Ÿåº¦åŠç¨³å®šæ€§</title>
    <link href="http://asucanyh-cn.github.io/posts/2649205773/"/>
    <id>http://asucanyh-cn.github.io/posts/2649205773/</id>
    <published>2023-02-13T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<div class="admonition info"><p class="admonition-title">å‚é˜…</p><p><strong><a href="https://gitee.com/opopop880">opopop880</a></strong>.<a href="https://blog.csdn.net/opopop880/article/details/122880479">ä¸€é”®æ­å»ºzerotier planetæœåŠ¡å™¨è„šæœ¬</a>.[1]</p></div><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><ul><li>éœ€è¦å…·æœ‰å…¬ç½‘ipçš„æœºå™¨ï¼Œå¼€æ”¾3443ã€9993ç«¯å£</li></ul><h1 id="å®‰è£…ztncuiå¯è§†åŒ–æ§åˆ¶å™¨"><a href="#å®‰è£…ztncuiå¯è§†åŒ–æ§åˆ¶å™¨" class="headerlink" title="å®‰è£…ztncuiå¯è§†åŒ–æ§åˆ¶å™¨"></a>å®‰è£…ztncuiå¯è§†åŒ–æ§åˆ¶å™¨</h1><blockquote><p>è¿™é‡Œä½¿ç”¨<a href="https://gitee.com/opopop880/zerotier_planet/blob/master/zerotier_planet.sh">ç«æœ¨æœ¨åˆ¶ä½œ</a>å¤§ä½¬åˆ¶ä½œçš„è„šæœ¬</p></blockquote><p><a href="https://gitee.com/opopop880/zerotier_planet/blob/master/zerotier_planet.sh">centos</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://gitee.com/opopop880/zerotier_planet/raw/master/zerotier_planet.sh &amp;&amp; chmod +x zerotier_planet.sh &amp;&amp; bash zerotier_planet.sh</span><br></pre></td></tr></table></figure><p><a href="https://gitee.com/opopop880/zerotier_planet/blob/master/zerotier_planet_debain.sh">debain</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://gitee.com/opopop880/zerotier_planet/raw/master/zerotier_planet_debain.sh &amp;&amp; chmod +x zerotier_planet_debain.sh &amp;&amp; bash zerotier_planet_debain.sh</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h1><blockquote><p>ztncuiæ§åˆ¶å™¨çš„ä½¿ç”¨æ–¹æ³•ç±»ä¼¼zerotierå®˜ç½‘ã€‚è¯·è‡ªè¡Œç ”ç©¶ï¼Œå¾ˆç®€å•ã€‚</p></blockquote><h2 id="é¦–å…ˆï¼Œæ·»åŠ ç½‘ç»œ"><a href="#é¦–å…ˆï¼Œæ·»åŠ ç½‘ç»œ" class="headerlink" title="é¦–å…ˆï¼Œæ·»åŠ ç½‘ç»œ"></a>é¦–å…ˆï¼Œæ·»åŠ ç½‘ç»œ</h2><p>è®¾ç½®ä¸€ä¸ªç½‘ç»œçš„åç§°ã€‚</p><h2 id="ç„¶åï¼Œå«Œéº»çƒ¦å¯ç›´æ¥ç‚¹å‡»ç®€æ˜“å®‰è£…"><a href="#ç„¶åï¼Œå«Œéº»çƒ¦å¯ç›´æ¥ç‚¹å‡»ç®€æ˜“å®‰è£…" class="headerlink" title="ç„¶åï¼Œå«Œéº»çƒ¦å¯ç›´æ¥ç‚¹å‡»ç®€æ˜“å®‰è£…"></a>ç„¶åï¼Œå«Œéº»çƒ¦å¯ç›´æ¥ç‚¹å‡»ç®€æ˜“å®‰è£…</h2>]]></content>
    
    
    <summary type="html">éƒ¨ç½²ç¬”è®°</summary>
    
    
    
    <category term="è®¡ç®—æœºç½‘ç»œ" scheme="http://asucanyh-cn.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    
    
    <category term="Zerotier" scheme="http://asucanyh-cn.github.io/tags/Zerotier/"/>
    
  </entry>
  
  <entry>
    <title>ansibleå­¦ä¹ ç¬”è®°Part5</title>
    <link href="http://asucanyh-cn.github.io/posts/632481897/"/>
    <id>http://asucanyh-cn.github.io/posts/632481897/</id>
    <published>2023-02-01T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h1><blockquote><p>è¿­ä»£ï¼šwith_items</p></blockquote><h2 id="æ ‡å‡†å¾ªç¯"><a href="#æ ‡å‡†å¾ªç¯" class="headerlink" title="æ ‡å‡†å¾ªç¯"></a>æ ‡å‡†å¾ªç¯</h2><blockquote><p>ä»¥åˆ›å»ºå¤šä¸ªæ–‡ä»¶å’Œç”¨æˆ·ä¸ºä¾‹</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">centos</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">touch</span> <span class="string">some</span> <span class="string">files.</span></span><br><span class="line">      <span class="attr">file:</span> <span class="string">name=/data/&#123;&#123;</span> <span class="string">item</span> <span class="string">&#125;&#125;</span> <span class="string">state=touch</span></span><br><span class="line">      <span class="attr">with_items:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">file1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">file2</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">add</span> <span class="string">several</span> <span class="string">users.</span></span><br><span class="line">      <span class="attr">user:</span> <span class="string">name=&#123;&#123;</span> <span class="string">item.usrname</span> <span class="string">&#125;&#125;</span> <span class="string">groups=&#123;&#123;</span> <span class="string">item.groups</span> <span class="string">&#125;&#125;</span> <span class="string">state=present</span></span><br><span class="line">      <span class="attr">with_items:</span></span><br><span class="line">       <span class="bullet">-</span> &#123; <span class="attr">usrname:</span> <span class="string">&#x27;user1&#x27;</span>,<span class="attr">groups:</span> <span class="string">&#x27;root&#x27;</span>&#125;</span><br><span class="line">       <span class="bullet">-</span> &#123; <span class="attr">usrname:</span> <span class="string">&#x27;user2&#x27;</span>,<span class="attr">groups:</span> <span class="string">&#x27;root&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><h2 id="åµŒå¥—å¾ªç¯"><a href="#åµŒå¥—å¾ªç¯" class="headerlink" title="åµŒå¥—å¾ªç¯"></a><a href="http://ansible.com.cn/docs/playbooks_loops.html#id19">åµŒå¥—å¾ªç¯</a></h2><p>å¾ªç¯ä¹Ÿå¯ä»¥åµŒå¥—:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- name: give<span class="built_in"> users </span>access <span class="keyword">to</span> multiple databases</span><br><span class="line">  mysql_user: name=&#123;&#123; item[0] &#125;&#125; priv=&#123;&#123; item[1] &#125;&#125;.*:ALL <span class="attribute">append_privs</span>=<span class="literal">yes</span> <span class="attribute">password</span>=foo</span><br><span class="line">  with_nested:</span><br><span class="line">    - [ <span class="string">&#x27;alice&#x27;</span>, <span class="string">&#x27;bob&#x27;</span> ]</span><br><span class="line">    - [ <span class="string">&#x27;clientdb&#x27;</span>, <span class="string">&#x27;employeedb&#x27;</span>, <span class="string">&#x27;providerdb&#x27;</span> ]</span><br></pre></td></tr></table></figure><p>å’Œä»¥ä¸Šä»‹ç»çš„â€™with_itemsâ€™ä¸€æ ·,ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨é¢„å®šä¹‰å˜é‡.:</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">- name: here, &#x27;users&#x27; contains the above list of employees</span></span><br><span class="line"><span class="language-xml">  mysql_user: name=</span><span class="template-variable">&#123;&#123; <span class="name">item</span>[0] &#125;&#125;</span><span class="language-xml"> priv=</span><span class="template-variable">&#123;&#123; <span class="name">item</span>[1] &#125;&#125;</span><span class="language-xml">.*:ALL append_privs=yes password=foo</span></span><br><span class="line"><span class="language-xml">  with_nested:</span></span><br><span class="line"><span class="language-xml">    - &quot;</span><span class="template-variable">&#123;&#123;<span class="name">users</span>&#125;&#125;</span><span class="language-xml">&quot;</span></span><br><span class="line"><span class="language-xml">    - [ &#x27;clientdb&#x27;, &#x27;employeedb&#x27;, &#x27;providerdb&#x27; ]</span></span><br></pre></td></tr></table></figure><h2 id="Playbookä¸­template-for-if"><a href="#Playbookä¸­template-for-if" class="headerlink" title="Playbookä¸­template for if"></a>Playbookä¸­template for if</h2><blockquote><p>forå¾ªç¯å’Œifæ¡ä»¶åˆ¤æ–­çš„è¯­æ³•æ ¼å¼</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for x in list %&#125;</span><br><span class="line">expression</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% if bool %&#125;</span><br><span class="line">expression</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¡ˆä¾‹</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">centos</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">80</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">81</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">82</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">copy</span> <span class="string">conf</span></span><br><span class="line">      <span class="attr">template:</span> <span class="string">src=for1.conf.j2</span> <span class="string">dest=/data/for1.conf</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for port in ports %&#125;</span><br><span class="line">server&#123;</span><br><span class="line">  listen &#123;&#123; port &#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¡¥å……ï¼šyamlä¸­varså˜é‡è¿˜å¯ä»¥é‡‡ç”¨åˆ—è¡¨åµŒå¥—å­—å…¸çš„æ–¹å¼ï¼Œå®šä¹‰æ›´å¤šçš„é”®å€¼å¯¹ã€‚</p></blockquote><h1 id="role"><a href="#role" class="headerlink" title="role"></a><a href="http://ansible.com.cn/docs/playbooks_roles.html?highlight=role">role</a></h1><blockquote><p><strong>Role</strong>s çš„æ¦‚å¿µæ¥è‡ªäºè¿™æ ·çš„æƒ³æ³•ï¼šé€šè¿‡ include åŒ…å«æ–‡ä»¶å¹¶å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·ï¼Œç»„ç»‡æˆä¸€ä¸ªç®€æ´ã€å¯é‡ç”¨çš„æŠ½è±¡å¯¹è±¡ã€‚è¿™ç§æ–¹å¼å¯ä½¿ä½ å°†æ³¨æ„åŠ›æ›´å¤šåœ°æ”¾åœ¨å¤§å±€ä¸Šï¼Œåªæœ‰åœ¨éœ€è¦æ—¶æ‰å»æ·±å…¥äº†è§£ç»†èŠ‚ã€‚</p></blockquote><ul><li>roleæé«˜äº†playbookçš„å¤ç”¨ç‡</li></ul><blockquote><p>roleçš„æ¨èç›®å½•ä¸º<code>/etc/ansible/roles</code></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">roles/</span><br><span class="line">â”œâ”€â”€ httpd</span><br><span class="line">â”œâ”€â”€ memcache</span><br><span class="line">â””â”€â”€ mysql</span><br></pre></td></tr></table></figure><p><img src="/"></p><h2 id="åœºæ™¯æ¨¡æ‹Ÿ"><a href="#åœºæ™¯æ¨¡æ‹Ÿ" class="headerlink" title="åœºæ™¯æ¨¡æ‹Ÿ"></a>åœºæ™¯æ¨¡æ‹Ÿ</h2><p><img src="C:\Users\Lappland\AppData\Roaming\Typora\typora-user-images\ansible-role-tree.png" alt="ansible-role-tree"></p><p><a href="https://aluopy.cn/ansible/dir-arrange/">ç›®å½•ç¼–æ’</a></p><p>æ¯ä¸ªè§’è‰²ï¼Œä»¥ç‰¹å®šçš„å±‚çº§ç›®å½•ç»“æ„è¿›è¡Œç»„ç»‡ã€‚</p><p><strong>roles ç›®å½•ç»“æ„ï¼š</strong> playbook.yml roles&#x2F; project&#x2F; tasks&#x2F; files&#x2F; vars&#x2F; templates&#x2F; handlers&#x2F; default&#x2F; meta&#x2F;</p><p><strong>Roles å„ç›®å½•ä½œç”¨ï¼š</strong> <code>roles/project/ </code>ï¼šé¡¹ç›®åç§°ï¼Œæœ‰ä»¥ä¸‹å­ç›®å½•</p><ul><li><code>files/</code> ï¼šå­˜æ”¾ç”± copy æˆ– script æ¨¡å—ç­‰è°ƒç”¨çš„æ–‡ä»¶</li><li><code>templates/</code>ï¼štemplate æ¨¡å—æŸ¥æ‰¾æ‰€éœ€è¦æ¨¡æ¿æ–‡ä»¶çš„ç›®å½•</li><li><code>tasks/</code>ï¼šå®šä¹‰ taskï¼Œrole çš„åŸºæœ¬å…ƒç´ ï¼Œè‡³å°‘åº”è¯¥åŒ…å«ä¸€ä¸ªåä¸º main.yml çš„æ–‡ä»¶ï¼›å…¶å®ƒçš„æ–‡ä»¶éœ€è¦åœ¨æ­¤æ–‡ä»¶ä¸­é€šè¿‡ include è¿›è¡ŒåŒ…å«</li><li><code>handlers/</code>ï¼šè‡³å°‘åº”è¯¥åŒ…å«ä¸€ä¸ªåä¸º main.yml çš„æ–‡ä»¶ï¼›å…¶å®ƒçš„æ–‡ä»¶éœ€è¦åœ¨æ­¤æ–‡ä»¶ä¸­é€šè¿‡ include è¿›è¡ŒåŒ…å«</li><li><code>vars/</code>ï¼šå®šä¹‰å˜é‡ï¼Œè‡³å°‘åº”è¯¥åŒ…å«ä¸€ä¸ªåä¸º main.yml çš„æ–‡ä»¶ï¼›å…¶å®ƒçš„æ–‡ä»¶éœ€è¦åœ¨æ­¤æ–‡ä»¶ä¸­é€šè¿‡ include è¿›è¡ŒåŒ…å«</li><li><code>meta/</code>ï¼šå®šä¹‰å½“å‰è§’è‰²çš„ç‰¹æ®Šè®¾å®šåŠå…¶ä¾èµ–å…³ç³»ï¼Œè‡³å°‘åº”è¯¥åŒ…å«ä¸€ä¸ªåä¸º main.yml çš„æ–‡ä»¶ï¼Œå…¶å®ƒæ–‡ä»¶éœ€åœ¨æ­¤æ–‡ä»¶ä¸­é€šè¿‡ include è¿›è¡ŒåŒ…å«</li><li><code>default/</code>ï¼šè®¾å®šé»˜è®¤å˜é‡æ—¶ä½¿ç”¨æ­¤ç›®å½•ä¸­çš„ main.yml æ–‡ä»¶ï¼Œæ¯” vars çš„ä¼˜å…ˆçº§ä½</li></ul><div class="admonition note"><p class="admonition-title">æ³¨æ„</p><p>æœªæ¥ä½¿ç”¨playbookè°ƒç”¨roleæ—¶ï¼Œè¦å°†playbookæ–‡ä»¶æ”¾åœ¨roleå¹³çº§ç›®å½•ä¸‹</p></div><blockquote><p>éœ€è¦å®ç°ä¸€ä¸ªnginxçš„role</p></blockquote><p>æ€è·¯</p><ol><li>åˆ›å»ºç»„nginx</li><li>åˆ›å»ºç”¨æˆ·nginx</li><li>å®‰è£…nginx</li><li>ä½¿ç”¨æ¨¡æ¿æ–‡ä»¶ï¼Œä¿®æ”¹é…ç½®</li><li>å¯åŠ¨service</li></ol><h3 id="é¦–å…ˆ"><a href="#é¦–å…ˆ" class="headerlink" title="é¦–å…ˆ"></a>é¦–å…ˆ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /etc/ansible/roles/nginx</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ansibleå­¦ä¹ ç¬”è®°</summary>
    
    
    
    <category term="Linux" scheme="http://asucanyh-cn.github.io/categories/Linux/"/>
    
    
    <category term="ansible" scheme="http://asucanyh-cn.github.io/tags/ansible/"/>
    
    <category term="linux" scheme="http://asucanyh-cn.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Centosç½‘ç»œé—®é¢˜è§£å†³æ–¹æ¡ˆ</title>
    <link href="http://asucanyh-cn.github.io/posts/3307706676/"/>
    <id>http://asucanyh-cn.github.io/posts/3307706676/</id>
    <published>2023-01-29T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="eth1æ— ip4åœ°å€"><a href="#eth1æ— ip4åœ°å€" class="headerlink" title="eth1æ— ip4åœ°å€"></a>eth1æ— ip4åœ°å€</h1><h2 id="ç¯å¢ƒï¼š"><a href="#ç¯å¢ƒï¼š" class="headerlink" title="ç¯å¢ƒï¼š"></a>ç¯å¢ƒï¼š</h2><ul><li>æ¡¥æ¥æ¨¡å¼</li></ul><h2 id="è§£å†³æ–¹æ¡ˆï¼š"><a href="#è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼š"></a>è§£å†³æ–¹æ¡ˆï¼š</h2><p>æ‰‹åŠ¨åˆ›å»º<code>ifcfg-eth1</code>æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; ifcfg-eth1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åªéœ€è¦ä¸¤é¡¹å°±å¯ä»¥è§£å†³</span></span><br><span class="line">DEVICE=eth1</span><br><span class="line">BOOTPROTO=dhcp</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®Œæ•´ç½‘å¡æ–‡ä»¶å†…å®¹</span></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens33</span><br><span class="line">UUID=aa6a1ea8-c991-48aa-9b11-ce366363f592</span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=192.168.41.89</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=192.168.41.2</span><br><span class="line">DNS1=114.114.114.114</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡å¯ç½‘ç»œæœåŠ¡</span></span><br><span class="line">systemctl restart NetworkManager</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ansibleå­¦ä¹ ç¬”è®°</summary>
    
    
    
    <category term="Linux" scheme="http://asucanyh-cn.github.io/categories/Linux/"/>
    
    
    <category term="Centos" scheme="http://asucanyh-cn.github.io/tags/Centos/"/>
    
  </entry>
  
  <entry>
    <title>ansibleå­¦ä¹ ç¬”è®°Part4</title>
    <link href="http://asucanyh-cn.github.io/posts/1387649279/"/>
    <id>http://asucanyh-cn.github.io/posts/1387649279/</id>
    <published>2023-01-29T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Playbookä¸­å˜é‡çš„ä½¿ç”¨"><a href="#Playbookä¸­å˜é‡çš„ä½¿ç”¨" class="headerlink" title="Playbookä¸­å˜é‡çš„ä½¿ç”¨"></a><a href="https://www.cnblogs.com/f-ck-need-u/p/7571974.html#1-1-ansible-facts">Playbookä¸­å˜é‡çš„ä½¿ç”¨</a></h1><h2 id="å˜é‡å®šä¹‰"><a href="#å˜é‡å®šä¹‰" class="headerlink" title="å˜é‡å®šä¹‰"></a>å˜é‡å®šä¹‰</h2><div class="admonition info"><p class="admonition-title">å˜é‡å</p><p>ä»…å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ç»„æˆï¼Œä¸”åªèƒ½ä»¥å­—æ¯å¼€å¤´</p></div><div class="admonition note"><p class="admonition-title">playbookä¸­å˜é‡çš„è¡¨ç¤ºä»¥åŠèµ‹å€¼</p><p>ä½¿ç”¨<code>&#123;&#123;&#125;&#125;</code> mustacheè¯­æ³•ï¼Œè¿è¡Œplaybookæ—¶æ·»åŠ <code>-e å‚æ•°</code>ä¸ºå˜é‡èµ‹å€¼ã€‚</p></div><ol><li>setupæ¨¡å—</li></ol><blockquote><p>å†…ç½®çš„setupæ¨¡å—ï¼Œç”¨äºæŸ¥è¯¢å†…ç½®å˜é‡ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- name: Gathers facts about remote hosts</span><br><span class="line">  setup:</span><br><span class="line">      fact_path:             # Path used for local ansible facts (`*.fact&#x27;) - files in this dir will be run (if executable) and their results be added to  `ansible_local&#x27; facts if a file is not executable it is read. Check notes for Windows options. (from 2.1 on) File/results format can be JSON or INI-format. The default `fact_path&#x27; can be  specified in `ansible.cfg&#x27; for when setup is automatically called as part of `gather_facts&#x27;.</span><br><span class="line">      filter:               # è¿‡æ»¤å†…å®¹ï¼Œæ”¯æŒé€šé…ç¬¦  # If supplied, only return facts that match this shell-style (fnmatch) wildcard.</span><br><span class="line">      gather_subset:         # If supplied, restrict the additional facts collected to the given subset. Possible values: `all&#x27;, `min&#x27;, `hardware&#x27;,  `network&#x27;, `virtual&#x27;, `ohai&#x27;, and `facter&#x27;. Can specify a list of values to specify a larger subset. Values can also be used with an initial `!&#x27; to specify that that specific subset should not be collected.  For instance: `!hardware,!network,!virtual,!ohai,!facter&#x27;. If `!all&#x27; is specified then only the min subset is collected. To avoid collecting even the min subset,  specify `!all,!min&#x27;. To collect only specific facts, use `!all,!min&#x27;, and specify the particular fact subsets. Use the filter parameter if you do not want to display some collected  facts.</span><br><span class="line">     gather_timeout:        # Set the default timeout in seconds for individual fact gathering.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">cmdline</span></span><br><span class="line">ansible host -m setup -a &#x27;filter=&lt;..&gt;&#x27;</span><br></pre></td></tr></table></figure><ol start="2"><li>åœ¨playbookä¸­å®šä¹‰å˜é‡</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- hosts:</span><br><span class="line">  remote_user:</span><br><span class="line">  vars:</span><br><span class="line">    - var1: #å˜é‡å€¼1</span><br><span class="line">    - var2: #å˜é‡å€¼2</span><br></pre></td></tr></table></figure><ol start="3"><li>åˆ©ç”¨å‘½ä»¤è¡ŒæŒ‡å®šå˜é‡</li></ol><div class="admonition note"><p class="admonition-title">ä¼˜å…ˆçº§</p><p>å‘½ä»¤è¡Œçš„ä¼˜å…ˆçº§è¦é«˜äºé…ç½®æ–‡ä»¶ã€‚</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook -e &#x27;var1=value1 var2=value2&#x27; file.yaml</span><br></pre></td></tr></table></figure><ol start="4"><li>åœ¨<code>/etc/ansible/hosts</code>ä¸­å®šä¹‰</li></ol><div class="admonition note"><p class="admonition-title">ä¸»æœºæ¸…å•ä¸­å®šä¹‰å˜é‡</p><p>åˆ†ä¸º<code>æ™®é€šå˜é‡</code>å’Œ<code>å…¬å…±ï¼ˆç»„ï¼‰å˜é‡</code>ï¼Œæ™®é€šå˜é‡ä¼˜å…ˆçº§<code>é«˜äº</code>å…¬å…±ï¼ˆç»„ï¼‰å˜é‡ã€‚</p></div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">websrvs</span>]</span><br><span class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.10</span> <span class="string">var1=value1</span> <span class="string">var2=value2</span>  <span class="comment">#æ™®é€šå˜é‡</span></span><br><span class="line">[<span class="string">websrvs:vars</span>] <span class="comment">#å…¬å…±ï¼ˆç»„ï¼‰å˜é‡</span></span><br><span class="line"><span class="string">var3=value3</span></span><br><span class="line"><span class="string">var1=value0</span> <span class="comment">#ç”±äºæ™®é€šå˜é‡ä¼˜å…ˆäºå…¬å…±ï¼ˆç»„ï¼‰å˜é‡ï¼Œæ‰€ä»¥æ­¤å¤„ä¸ä¼šåº”ç”¨äº192.168.1.10ä¸»æœº</span></span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/qq_41056224/article/details/105455329">ä¸ºäº†é¿å…æ··ä¹±ï¼Œè¿˜å¯ä»¥é‡‡ç”¨æ–‡ä»¶çš„å½¢å¼æ¥å®šä¹‰ã€‚</a></p><ol start="5"><li>åœ¨å¤–éƒ¨yamlæ–‡ä»¶å®šä¹‰å˜é‡å¹¶åœ¨playbookä¸­å¼•ç”¨</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo -e &quot;var1:value1\nvar2:value2&quot; &gt;&gt; /etc/ansible/vars.yaml</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨playbookæ–‡ä»¶ä¸­ï¼Œä½¿ç”¨<code>vars_files</code>å¼•ç”¨å¤–éƒ¨æ–‡ä»¶</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">- hosts: </span><br><span class="line">  remote_user:</span><br><span class="line">  vars_files:</span><br><span class="line">    - /path/to/vars.yaml</span><br><span class="line">    </span><br><span class="line">   tasks:</span><br><span class="line">     - name:</span><br><span class="line">        &lt;moduel&gt;:</span><br></pre></td></tr></table></figure><ol start="6"><li>åœ¨roleæ–‡ä»¶ä¸­å®šä¹‰å˜é‡</li></ol><h1 id="æ¨¡æ¿templates"><a href="#æ¨¡æ¿templates" class="headerlink" title="æ¨¡æ¿templates"></a>æ¨¡æ¿templates</h1><blockquote><p>ä½¿ç”¨<a href="http://docs.jinkan.org/docs/jinja2/"><code>Jinja2</code>è¯­æ³•</a></p></blockquote><div class="admonition note"><p class="admonition-title">æ³¨æ„</p><p>templateæ¨¡å—åªèƒ½åœ¨playbookæ–‡ä»¶ä¸­ä½¿ç”¨ã€‚</p></div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">ubuntu</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">root</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">install</span> <span class="string">package</span></span><br><span class="line">       <span class="attr">apt:</span> <span class="string">name=nginx</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">copy</span> <span class="string">template</span></span><br><span class="line">       <span class="attr">template:</span> <span class="string">src=nginx.conf.j2</span> <span class="string">dest=/etc/nginx/nginx.conf</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">start</span> <span class="string">service</span></span><br><span class="line">       <span class="attr">service:</span> <span class="string">name=nginx</span> <span class="string">state=started</span> <span class="string">enabled=yes</span></span><br></pre></td></tr></table></figure><h2 id="åœ¨playbookæ–‡ä»¶ä½¿ç”¨æ¡ä»¶åˆ¤æ–­"><a href="#åœ¨playbookæ–‡ä»¶ä½¿ç”¨æ¡ä»¶åˆ¤æ–­" class="headerlink" title="åœ¨playbookæ–‡ä»¶ä½¿ç”¨æ¡ä»¶åˆ¤æ–­"></a>åœ¨playbookæ–‡ä»¶ä½¿ç”¨æ¡ä»¶åˆ¤æ–­</h2><blockquote><p>whenè¯­å¥</p><p>åœ¨taskåæ·»åŠ whenå­å¥å¯ç”¨äºæ¡ä»¶æµ‹è¯•</p></blockquote><div class="admonition info"><p class="admonition-title">è¡¥å……</p><p>whenè¯­å¥è¿˜æ”¯æŒJinja2è¡¨è¾¾å¼è¯­æ³•ã€‚å¦‚ï¼š<code>when: var==&quot;value&quot;</code></p></div><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">ubuntu</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">root</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">install</span> <span class="string">package</span></span><br><span class="line">       <span class="attr">apt:</span> <span class="string">name=nginx</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">copy</span> <span class="string">template</span></span><br><span class="line">       <span class="attr">template:</span> <span class="string">src=nginx.conf.j2</span> <span class="string">dest=/etc/nginx/nginx.conf</span></span><br><span class="line">       <span class="attr">when:</span> <span class="string">var==&quot;valueâ€œ</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">start</span> <span class="string">service</span></span><br><span class="line">       <span class="attr">service:</span> <span class="string">name=nginx</span> <span class="string">state=started</span> <span class="string">enabled=yes</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ansibleå­¦ä¹ ç¬”è®°</summary>
    
    
    
    <category term="Linux" scheme="http://asucanyh-cn.github.io/categories/Linux/"/>
    
    
    <category term="ansible" scheme="http://asucanyh-cn.github.io/tags/ansible/"/>
    
    <category term="linux" scheme="http://asucanyh-cn.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Termuxå®‰è£…Ubuntuç­‰æ“ä½œç³»ç»Ÿçš„è¿‡ç¨‹è®°å½•</title>
    <link href="http://asucanyh-cn.github.io/posts/1970583601/"/>
    <id>http://asucanyh-cn.github.io/posts/1970583601/</id>
    <published>2023-01-27T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<div class="admonition info"><p class="admonition-title">å‚é˜…</p></div><p>â€‹    <a href="https://gitee.com/KudouShinnyan">å·¥è—¤æ–°å–µ</a>.<a href="https://gitee.com/KudouShinnyan/ubuntu-in-termux">ubuntu-in-termux</a>.Gitee.[1]<br>â€‹    <a href="https://github.com/xiliuya">xiliuya</a>.<a href="https://github.com/xiliuya/termux-linux/">termux-linux</a>.Github.[2]</p><h1 id="centoså®‰è£…"><a href="#centoså®‰è£…" class="headerlink" title="centoså®‰è£…"></a>centoså®‰è£…</h1><blockquote><p><a href="https://github.com/xiliuya/termux-linux/releases/download/untagged-d42e22a770f3c95aac45/install_linux.sh">è„šæœ¬</a>â€”â€”è¿™ä¸ªè„šæœ¬è¿˜å¯ä»¥å®‰è£…å¾ˆå¤šå…¶å®ƒçš„æ“ä½œç³»ç»Ÿï¼Œè€Œä¸”ä¸‹è½½é€Ÿåº¦è¿˜ä¸èµ–</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿è¡Œè„šæœ¬ï¼Œæ ¹æ®æç¤ºè¾“å…¥å¯¹åº”çš„ç³»ç»Ÿ</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å»ºè®®è£…8-streamï¼Œç›®å‰9è¿˜æœ‰ä¸€äº›ä¸œè¥¿ä¸æ”¯æŒ</span></span><br><span class="line">bash install_linux.sh</span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">centos</span></span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">9</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="https://blog.csdn.net/qq_22938603/article/details/128109424">æ¢æºï¼ˆ9-streamï¼‰</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¸…åæº</span></span><br><span class="line">mv /etc/yum.repos.d/centos.repo /etc/yum.repos.d/centos.repo.bk</span><br><span class="line">touch /etc/yum.repos.d/centos.repo</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰‹åŠ¨å¤åˆ¶ä¸€ä¸‹</span></span><br><span class="line">[baseos]</span><br><span class="line">name=CentOS Stream $releasever - BaseOS</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">mirrorlist=http://mirrorlist.centos.org/?release=<span class="variable">$stream</span>&amp;<span class="built_in">arch</span>=<span class="variable">$basearch</span>&amp;repo=BaseOS&amp;infra=<span class="variable">$infra</span></span></span><br><span class="line">baseurl=https://mirrors.ustc.edu.cn/centos-stream/9-stream/BaseOS/$basearch/os/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</span><br><span class="line">[appstream]</span><br><span class="line">name=CentOS Stream $releasever - AppStream</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">mirrorlist=http://mirrorlist.centos.org/?release=<span class="variable">$stream</span>&amp;<span class="built_in">arch</span>=<span class="variable">$basearch</span>&amp;repo=AppStream&amp;infra=<span class="variable">$infra</span></span></span><br><span class="line">baseurl=https://mirrors.ustc.edu.cn/centos-stream/9-stream/AppStream/$basearch/os/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://www.cnblogs.com/wswind/p/11751829.html">æ¢æºï¼ˆ8-streamï¼‰</a></p></blockquote><blockquote><p>æ›´æ–°</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache &amp;&amp; yum update -y</span><br></pre></td></tr></table></figure><h1 id="ubuntuå®‰è£…"><a href="#ubuntuå®‰è£…" class="headerlink" title="ubuntuå®‰è£…"></a>ubuntuå®‰è£…</h1><blockquote><p><a href="https://gitee.com/KudouShinnyan/ubuntu-in-termux">è„šæœ¬</a></p></blockquote><blockquote><p>æ¢æº</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">souces.list</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">See http://help.ubuntu.com/community/UpgradeNotes <span class="keyword">for</span> how to upgrade to</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">newer versions of the distribution.</span></span><br><span class="line">deb http://ports.ubuntu.com/ubuntu-ports/ jammy main restricted</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deb-src http://ports.ubuntu.com/ubuntu-ports/ jammy main restricted</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Major bug fix updates produced after the final release of the</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># distribution.</span></span></span><br><span class="line">deb http://ports.ubuntu.com/ubuntu-ports/ jammy-updates main restricted</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deb-src http://ports.ubuntu.com/ubuntu-ports/ jammy-updates main restricted</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># team. Also, please note that software in universe WILL NOT receive any</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># review or updates from the Ubuntu security team.</span></span></span><br><span class="line">deb http://ports.ubuntu.com/ubuntu-ports/ jammy universe</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deb-src http://ports.ubuntu.com/ubuntu-ports/ jammy universe</span></span><br><span class="line">deb http://ports.ubuntu.com/ubuntu-ports/ jammy-updates universe</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deb-src http://ports.ubuntu.com/ubuntu-ports/ jammy-updates universe</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># team, and may not be under a free licence. Please satisfy yourself as to</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># your rights to use the software. Also, please note that software in</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># multiverse WILL NOT receive any review or updates from the Ubuntu</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># security team.</span></span></span><br><span class="line">deb http://ports.ubuntu.com/ubuntu-ports/ jammy multiverse</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deb-src http://ports.ubuntu.com/ubuntu-ports/ jammy multiverse</span></span><br><span class="line">deb http://ports.ubuntu.com/ubuntu-ports/ jammy-updates multiverse</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deb-src http://ports.ubuntu.com/ubuntu-ports/ jammy-updates multiverse</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># N.B. software from this repository may not have been tested as</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># extensively as that contained in the main release, although it includes</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># newer versions of some applications which may provide useful features.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Also, please note that software in backports WILL NOT receive any review</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># or updates from the Ubuntu security team.</span></span></span><br><span class="line">deb http://ports.ubuntu.com/ubuntu-ports/ jammy-backports main restricted universe multiverse</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deb-src http://ports.ubuntu.com/ubuntu-ports/ jammy-backports main restricted universe multiverse</span></span><br><span class="line"></span><br><span class="line">deb http://ports.ubuntu.com/ubuntu-ports/ jammy-security main restricted</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deb-src http://ports.ubuntu.com/ubuntu-ports/ jammy-security main restricted</span></span><br><span class="line">deb http://ports.ubuntu.com/ubuntu-ports/ jammy-security universe</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deb-src http://ports.ubuntu.com/ubuntu-ports/ jammy-security universe</span></span><br><span class="line">deb http://ports.ubuntu.com/ubuntu-ports/ jammy-security multiverse</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">deb-src http://ports.ubuntu.com/ubuntu-ports/ jammy-security multiverse</span></span><br><span class="line">deb https://download.webmin.com/download/repository sarge contrib</span><br></pre></td></tr></table></figure><h1 id="å¸¸ç”¨è½¯ä»¶"><a href="#å¸¸ç”¨è½¯ä»¶" class="headerlink" title="å¸¸ç”¨è½¯ä»¶"></a>å¸¸ç”¨è½¯ä»¶</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt install vim</span><br><span class="line">apt install ssh</span><br></pre></td></tr></table></figure><h1 id="mysqlæ•°æ®åº“"><a href="#mysqlæ•°æ®åº“" class="headerlink" title="mysqlæ•°æ®åº“"></a><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/">mysqlæ•°æ®åº“</a></h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install mysql-server</span><br></pre></td></tr></table></figure><blockquote><p>&#x2F;var&#x2F;log&#x2F;mysql&#x2F;error.log</p><p>Plugin mysqlx reported: â€˜Setup of bind-address: â€˜127.0.0.1â€™ port: 33060 failed, <code>socket()</code> failed with error: Permission denied(13)â€™</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å°è¯•ä½¿ç”¨user=rootå¯åŠ¨</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç›´æ¥ä½¿ç”¨mysqldå¯åŠ¨</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">usermod -a -G aid_inet,aid_net_raw mysql</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">usermod -a -G aid_inet,aid_net_raw root</span></span><br></pre></td></tr></table></figure><h2 id="vncæœåŠ¡å™¨"><a href="#vncæœåŠ¡å™¨" class="headerlink" title="vncæœåŠ¡å™¨"></a><a href="https://www.cnblogs.com/liyuanhong/articles/15487147.html">vncæœåŠ¡å™¨</a></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¾…ç»­</span></span><br></pre></td></tr></table></figure><h1 id="å£°å¡é©±åŠ¨"><a href="#å£°å¡é©±åŠ¨" class="headerlink" title="å£°å¡é©±åŠ¨"></a>å£°å¡é©±åŠ¨</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install pulseaudio</span><br><span class="line">sudo apt install pavucontrol</span><br><span class="line">pactl list sources short</span><br><span class="line">echo  &#x27;load-module module-simple-protocol-tcp rate=44100 format=s16le channels=2 source=0 record=true port=23217&#x27;&gt;&gt; /etc/pulse/default.pa</span><br><span class="line">pulseaudio --start</span><br></pre></td></tr></table></figure><h1 id="å®å¡”é¢æ¿"><a href="#å®å¡”é¢æ¿" class="headerlink" title="å®å¡”é¢æ¿"></a>å®å¡”é¢æ¿</h1><blockquote><p>Ubuntu</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -O install.sh https://download.bt.cn/install/install-ubuntu_6.0.sh &amp;&amp; sudo bash install.sh ed8484bec</span><br></pre></td></tr></table></figure><h1 id="é—®é¢˜æ–¹æ¡ˆ"><a href="#é—®é¢˜æ–¹æ¡ˆ" class="headerlink" title="é—®é¢˜æ–¹æ¡ˆ"></a>é—®é¢˜æ–¹æ¡ˆ</h1><blockquote><p><a href="https://blog.csdn.net/zong596568821xp/article/details/90747263">dpkg: error processing package mariadb-common (â€“configure):<br> installed mariadb-common package post-installation script subprocess returned error exit status 2<br>Errors were encountered while processing:<br> mariadb-common<br>E: Sub-process &#x2F;usr&#x2F;bin&#x2F;dpkg returned an error code (1)</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /var/lib/dpkg</span><br><span class="line">sudo mv info info.bak</span><br><span class="line">sudo mkdir info</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://399s.com/3089.html">debconf: unable to initialize frontend: Dialog<br>debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at &#x2F;usr&#x2F;share&#x2F;perl5&#x2F;Debconf&#x2F;FrontEnd&#x2F;Dialog.pm line 78.)</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install dialog</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://blog.csdn.net/wtlll/article/details/119059267">sudo: &#x2F;etc&#x2F;sudo.conf is owned by uid 10187, should be 0<br>sudo: &#x2F;etc&#x2F;sudo.conf is owned by uid 10187, should be 0<br>sudo: error in &#x2F;etc&#x2F;sudo.conf, line 0 while loading plugin â€œsudoers_policyâ€<br>sudo: &#x2F;usr&#x2F;libexec&#x2F;sudo&#x2F;sudoers.so must be owned by uid 0<br>sudo: fatal error, unable to load plugins</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chown root:root /etc/sudo.conf;</span><br><span class="line">chown root:root  /usr/libexec/sudo/sudoers.so;</span><br><span class="line">chown root:root /etc/sudoers;</span><br><span class="line">chown root:root /etc/sudoers.d -R</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">chown</span> root:root /etc/sudoers.d/README</span>               </span><br><span class="line">chown root:root /etc/sudo -R</span><br></pre></td></tr></table></figure><blockquote><p>[&#x2F;usr&#x2F;sbin&#x2F;service: line 3: &#x2F;etc&#x2F;init.d&#x2F;functions: No such file or directory](&#x2F;usr&#x2F;sbin&#x2F;service: line 3: &#x2F;etc&#x2F;init.d&#x2F;functions: No such file or directory)</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y initscripts</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://zhuanlan.zhihu.com/p/386480011">W: GPG error: https://download.webmin.com/download/repository sarge Release: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY D97A3AE911F63C51<br>E: The repository â€˜https://download.webmin.com/download/repository sarge Release' is not signed.<br>N: Updating from such a repository canâ€™t be done securely, and is therefore disabled by default.<br>N: See apt-secure(8) manpage for repository creation and user configuration details.</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys D97A3AE911F63C51</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://www.cnblogs.com/sw-code/p/14998645.html">Running in chroot, ignoring command â€˜startâ€™</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/smaknsk/servicectl/archive/1.0.tar.gz</span><br><span class="line">tar -xf 1.0.tar.gz -C /usr/local/lib/</span><br><span class="line">ln -s /usr/local/lib/servicectl-1.0/servicectl /usr/bin/servicectl</span><br><span class="line">ln -s /usr/local/lib/servicectl-1.0/serviced /usr/bin/serviced</span><br><span class="line">mv /usr/bin/systemctl /usr/bin/systemctl.bak</span><br><span class="line">mv /usr/bin/servicectl /usr/bin/systemctl</span><br></pre></td></tr></table></figure><blockquote><p>&#x2F;usr&#x2F;bin&#x2F;systemctl: 16: [: -ne: unexpected operator<br>&#x2F;usr&#x2F;bin&#x2F;systemctl: 23: Syntax error: â€œ(â€œ unexpected</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è§£é‡Šå™¨é”™è¯¯</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹é¦–è¡Œ shebang</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh -&gt;<span class="comment">#!/bin/bash</span></span></span><br></pre></td></tr></table></figure><blockquote><p>å­è¿›ç¨‹ å·²å®‰è£… post-installation è„šæœ¬ è¿”å›äº†é”™è¯¯å· 1</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo mv /var/lib/dpkg/info /var/lib/dpkg/info_old </span><br><span class="line">sudo mkdir /var/lib/dpkg/info</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get -f install </span><br><span class="line">sudo mv /var/lib/dpkg/info/* /var/lib/dpkg/info_old </span><br><span class="line">sudo rm -rf /var/lib/dpkg/info</span><br><span class="line">sudo mv /var/lib/dpkg/info_old /var/lib/dpkg/info </span><br></pre></td></tr></table></figure><blockquote><p>hostname: Name or service not known<br>make-ssl-cert: Could not get FQDN, using â€˜localhostâ€™.<br>make-ssl-cert: You may want to fix your &#x2F;etc&#x2F;hosts and&#x2F;or DNS setup and run<br>make-ssl-cert: â€˜make-ssl-cert generate-default-snakeoil â€“force-overwriteâ€™<br>make-ssl-cert: again.</p></blockquote><blockquote><p>&#x2F;usr&#x2F;bin&#x2F;deb-systemd-helper: error: systemctl preset failed on ubuntu-advantage.service: No such file or directory</p></blockquote><blockquote><p>invoke-rc.d: could not determine current runlevel<br>Scheduling reload of GNOME Display Manager configuration gdm3                                 setpriv: setresgid failed: Operation not permitted<br>invoke-rc.d: initscript gdm3, action â€œreloadâ€ failed.</p></blockquote><blockquote><p>setpriv: setresgid failed: Operation not permitted</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod a+s /bin/su</span><br><span class="line">chmod a+s /bin/sudo</span><br></pre></td></tr></table></figure><blockquote><p>Failed to execute child process â€œdbus-launchâ€œ</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install dbus-x11</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://askubuntu.com/questions/338382/pulseaudio-not-working-home-directory-not-accessible-permission-denied">W: [pulseaudio] main.c: ä¸åº”ä»¥ root èº«ä»½è¿è¡Œæœ¬ç¨‹åº(é™¤éæŒ‡å®š â€“system å‚æ•°)ã€‚<br>E: [autospawn] core-util.c: Home directory not accessible: æƒé™ä¸å¤Ÿ<br>W: [autospawn] lock-autospawn.c: ä¸èƒ½è®¿é—®è‡ªåŠ¨æ‰§è¡Œé”ã€‚<br>E: [pulseaudio] main.c: Failed to acquire autospawn lock</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chown root:root $HOME/</span><br><span class="line">sudo chown -R $USER:$USER $HOME/</span><br></pre></td></tr></table></figure><blockquote><p>The connection was refused by the computer</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">.vnc/config</span></span><br><span class="line">echo localhost=no &gt;&gt; .vnc/config</span><br></pre></td></tr></table></figure><blockquote><p>æ–°ç”¨æˆ·tabæ— æ³•è¡¥å…¨</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹è§£é‡Šå™¨ä¸ºSHELL=/bin/bash</span></span><br><span class="line">vim /etc/default/useradd</span><br></pre></td></tr></table></figure><blockquote><p>N: [pulseaudio] main.c: User-configured server at 127.0.0.1:23217, refusing to start&#x2F;autospawn.</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰¾åˆ°é—®é¢˜æ‰€åœ¨äº†</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¯ linux deployåœ¨/etc/profile.d/ä¸‹çš„pulse.shè„šæœ¬çš„é—®é¢˜</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è§£å†³æ–¹æ¡ˆæ˜¯ç§»å‡ºè„šæœ¬æˆ–æ³¨é‡Šæ‰€ä»¥å†…å®¹</span></span><br></pre></td></tr></table></figure><blockquote><p>Connection failure: Connection refused<br>pa_context_connect() failed: Connection refused</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>èµ‹äºˆrootç½‘ç»œç›¸å…³æƒé™ï¼Œè§£å†³apt updateçš„è¿æ¥é”™è¯¯æç¤ºï¼ˆåº”è¯¥æ˜¯ç”¨è¿™ä¸ªè§£å†³çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯é€šè¿‡ä¿®æ”¹linuxdeployçš„dnsé…ç½®ä¸ºè‡ªåŠ¨ï¼‰</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -a -G aid_inet,aid_net_raw root</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Termuxå®‰è£…ubuntuç­‰æ“ä½œç³»ç»Ÿé›†åˆï¼Œå®‰è£…è¿‡ç¨‹ç¬”è®°ã€‚</summary>
    
    
    
    <category term="Linux" scheme="http://asucanyh-cn.github.io/categories/Linux/"/>
    
    
    <category term="Termux" scheme="http://asucanyh-cn.github.io/tags/Termux/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³curlå‘½ä»¤æŠ¥é”™</title>
    <link href="http://asucanyh-cn.github.io/posts/880228874/"/>
    <id>http://asucanyh-cn.github.io/posts/880228874/</id>
    <published>2023-01-26T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<div class="admonition info"><p class="admonition-title">curl: symbol lookup error: curl: undefined symbol: curl_easy_nextheader</p><p>Saeed.<a href="https://stackoverflow.com/questions/66017956/bash-usr-local-bin-curl-no-such-file-or-directory#comment116723638_66018012">stackoverflow.com</a>.[1]</p></div><h1 id="å…·ä½“æ­¥éª¤"><a href="#å…·ä½“æ­¥éª¤" class="headerlink" title="å…·ä½“æ­¥éª¤"></a>å…·ä½“æ­¥éª¤</h1><blockquote><p><a href="https://blog.csdn.net/Cappuccino_jay/article/details/125219983">é¦–å…ˆï¼Œå¸è½½æœ¬æœºçš„curlï¼Œæ­¤å¤„ä»…ä»‹ç»ç¼–è¯‘å®‰è£…å¦‚ä½•å¸è½½ã€‚</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åœ¨åŸæ¥æ‰§è¡Œmakeçš„ç›®å½•ä¸‹ï¼ŒæŸ¥æ‰¾install_manifest.txtæ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¦‚æœå·²ç»åˆ é™¤äº†æºç å®‰è£…çš„æ–‡ä»¶ï¼Œå¯ç”¨é‡æ–°ä¸‹è½½ç¼–è¯‘å®‰è£…ä¸€éå†å¸è½½ã€‚</span></span><br><span class="line">cat install_manifest.txt | sudo xargs rm</span><br></pre></td></tr></table></figure><blockquote><p>å¸è½½libcurl4</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt remove libcurl4</span><br></pre></td></tr></table></figure><blockquote><p>é‡æ–°å®‰è£…curl</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install curl</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">æ•´ç†äº†ä¸€äº›é‡åˆ°çš„é—®é¢˜ã€‚</summary>
    
    
    
    <category term="Linux" scheme="http://asucanyh-cn.github.io/categories/Linux/"/>
    
    
    <category term="curl" scheme="http://asucanyh-cn.github.io/tags/curl/"/>
    
    <category term="Ubuntu" scheme="http://asucanyh-cn.github.io/tags/Ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>ansibleå­¦ä¹ ç¬”è®°Part3</title>
    <link href="http://asucanyh-cn.github.io/posts/3436268892/"/>
    <id>http://asucanyh-cn.github.io/posts/3436268892/</id>
    <published>2023-01-23T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://lptexas.top/posts/3151396298/">æ¥ä¸Šä¸€èŠ‚</a></p></blockquote><h1 id="å¸¸ç”¨æ¨¡å—"><a href="#å¸¸ç”¨æ¨¡å—" class="headerlink" title="å¸¸ç”¨æ¨¡å—"></a>å¸¸ç”¨æ¨¡å—</h1><h2 id="hostnameä¸»æœºå"><a href="#hostnameä¸»æœºå" class="headerlink" title="hostnameä¸»æœºå"></a>hostnameä¸»æœºå</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åªæœ‰ä¸€ä¸ªå‚æ•°nameï¼Œç”¨äºæŒ‡å®šä¸»æœºå</span></span><br></pre></td></tr></table></figure><h2 id="cronå®šæ—¶ä»»åŠ¡"><a href="#cronå®šæ—¶ä»»åŠ¡" class="headerlink" title="cronå®šæ—¶ä»»åŠ¡"></a>cronå®šæ—¶ä»»åŠ¡</h2><blockquote><p>æ”¯æŒï¼šåˆ†æ—¶æ—¥æœˆå‘¨ï¼ˆminute,hour,day,month,weekdayï¼‰</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS (= is mandatory):</span><br><span class="line"></span><br><span class="line">- backup</span><br><span class="line">        If set, create a backup of the crontab before it is modified. The location of the backup is returned in the</span><br><span class="line">        `backup_file&#x27; variable by this module.</span><br><span class="line">        [Default: False]</span><br><span class="line">        type: bool</span><br><span class="line"></span><br><span class="line">- cron_file</span><br><span class="line">        If specified, uses this file instead of an individual user&#x27;s crontab.</span><br><span class="line">        If this is a relative path, it is interpreted with respect to `/etc/cron.d&#x27;.</span><br><span class="line">        If it is absolute, it will typically be `/etc/crontab&#x27;.</span><br><span class="line">        Many linux distros expect (and some require) the filename portion to consist solely of upper- and lower-case letters,</span><br><span class="line">        digits, underscores, and hyphens.</span><br><span class="line">        To use the `cron_file&#x27; parameter you must specify the `user&#x27; as well.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- day</span><br><span class="line">        Day of the month the job should run ( 1-31, *, */2, etc )</span><br><span class="line">        (Aliases: dom)[Default: *]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- disabled</span><br><span class="line">        If the job should be disabled (commented out) in the crontab.</span><br><span class="line">        Only has effect if `state=present&#x27;.</span><br><span class="line">        [Default: False]</span><br><span class="line">        type: bool</span><br><span class="line">        version_added: 2.0</span><br><span class="line"></span><br><span class="line">- env</span><br><span class="line">        If set, manages a crontab&#x27;s environment variable.</span><br><span class="line">        New variables are added on top of crontab.</span><br><span class="line">        `name&#x27; and `value&#x27; parameters are the name and the value of environment variable.</span><br><span class="line">       [Default: False]</span><br><span class="line">        type: bool</span><br><span class="line">        version_added: 2.1</span><br><span class="line"></span><br><span class="line">- hour</span><br><span class="line">        Hour when the job should run ( 0-23, *, */2, etc )</span><br><span class="line">        [Default: *]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- insertafter</span><br><span class="line">        Used with `state=present&#x27; and `env&#x27;.</span><br><span class="line">        If specified, the environment variable will be inserted after the declaration of specified environment variable.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line">        version_added: 2.1</span><br><span class="line"></span><br><span class="line">- insertbefore</span><br><span class="line">        Used with `state=present&#x27; and `env&#x27;.</span><br><span class="line">        If specified, the environment variable will be inserted before the declaration of specified environment variable.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line">        version_added: 2.1</span><br><span class="line"></span><br><span class="line">- job</span><br><span class="line">        The command to execute or, if env is set, the value of environment variable.</span><br><span class="line">        The command should not contain line breaks.</span><br><span class="line">        Required if `state=present&#x27;.</span><br><span class="line">        (Aliases: value)[Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- minute</span><br><span class="line">        Minute when the job should run ( 0-59, *, */2, etc )</span><br><span class="line">        [Default: *]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- month</span><br><span class="line">        Month of the year the job should run ( 1-12, *, */2, etc )</span><br><span class="line">        [Default: *]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- name</span><br><span class="line">        Description of a crontab entry or, if env is set, the name of environment variable.</span><br><span class="line">        Required if `state=absent&#x27;.</span><br><span class="line">        Note that if name is not set and `state=present&#x27;, then a new crontab entry will always be created, regardless of</span><br><span class="line">        existing ones.</span><br><span class="line">        This parameter will always be required in future releases.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- reboot</span><br><span class="line">        If the job should be run at reboot. This option is deprecated. Users should use special_time.</span><br><span class="line">        [Default: False]</span><br><span class="line">        type: bool</span><br><span class="line">        version_added: 1.0</span><br><span class="line"></span><br><span class="line">- special_time</span><br><span class="line">        Special time specification nickname.</span><br><span class="line">        (Choices: annually, daily, hourly, monthly, reboot, weekly, yearly)[Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line">        version_added: 1.3</span><br><span class="line"></span><br><span class="line">- state</span><br><span class="line">        Whether to ensure the job or environment variable is present or absent.</span><br><span class="line">        (Choices: absent, present)[Default: present]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- user</span><br><span class="line">        The specific user whose crontab should be modified.</span><br><span class="line">        When unset, this parameter defaults to using `root&#x27;.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- weekday</span><br><span class="line">        Day of the week that the job should run ( 0-6 for Sunday-Saturday, *, etc )</span><br><span class="line">        (Aliases: dow)[Default: *]</span><br><span class="line">        type: str</span><br></pre></td></tr></table></figure><blockquote><p>åˆ›å»ºä¸€ä¸ªå®šæ—¶ä»»åŠ¡</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible host -m cron -a &#x27;&#x27;minute=*/5 job=/path/to/job/&#x27;</span><br></pre></td></tr></table></figure><h2 id="yumåŒ…ç®¡ç†"><a href="#yumåŒ…ç®¡ç†" class="headerlink" title="yumåŒ…ç®¡ç†"></a>yumåŒ…ç®¡ç†</h2><blockquote><p>éœ€è¦æœºå™¨æ”¯æŒyumåŒ…ç®¡ç†å™¨</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¸¸ç”¨å‚æ•°</span></span><br><span class="line">- name </span><br><span class="line">- state</span><br><span class="line">        Whether to install (`present&#x27; or `installed&#x27;, `latest&#x27;), or remove (`absent&#x27; or `removed&#x27;) a package.</span><br><span class="line">        `present&#x27; and `installed&#x27; will simply ensure that a desired package is installed.</span><br><span class="line">        `latest&#x27; will update the specified package if it&#x27;s not of the latest available version.</span><br><span class="line">        `absent&#x27; and `removed&#x27; will remove the specified package.</span><br><span class="line">        Default is `None&#x27;, however in effect the default action is `present&#x27; unless the `autoremove&#x27; option is enabled for</span><br><span class="line">        this module, then `absent&#x27; is inferred.</span><br><span class="line">        (Choices: absent, installed, latest, present, removed)[Default: (null)]</span><br><span class="line">- list</span><br><span class="line">        Package name to run the equivalent of yum list --show-duplicates &lt;package&gt; against. In addition to listing packages,</span><br><span class="line">        use can also list the following: `installed&#x27;, `updates&#x27;, `available&#x27; and `repos&#x27;.</span><br><span class="line">        This parameter is mutually exclusive with `name&#x27;.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">-...</span><br></pre></td></tr></table></figure><h2 id="serviceæœåŠ¡ç®¡ç†"><a href="#serviceæœåŠ¡ç®¡ç†" class="headerlink" title="serviceæœåŠ¡ç®¡ç†"></a>serviceæœåŠ¡ç®¡ç†</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¸¸ç”¨å‚æ•°</span></span><br><span class="line">- name: # ä»‹ç»åŠŸèƒ½</span><br><span class="line">  service:</span><br><span class="line">    name: # æœåŠ¡å</span><br><span class="line">    state: # çŠ¶æ€ï¼Œå¯é€‰å‚æ•°startedã€restartedã€reloadedã€stopped</span><br><span class="line">    enable: # boolå‹ï¼Œæ˜¯å¦å¼€å¯å¼€æœºè‡ªå¯</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># commandline</span></span></span><br><span class="line">ansible host -m service -a &#x27;name=&lt;...&gt; state=&lt;...&gt; enable=&lt;true|false&gt;&#x27;</span><br></pre></td></tr></table></figure><h2 id="userç®¡ç†ç”¨æˆ·"><a href="#userç®¡ç†ç”¨æˆ·" class="headerlink" title="userç®¡ç†ç”¨æˆ·"></a>userç®¡ç†ç”¨æˆ·</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">- name: Manage user accounts</span><br><span class="line">  user:</span><br><span class="line">      append:                # If `yes&#x27;, add the user to the groups specified in `groups&#x27;. If `no&#x27;, user will only be added to the groups specified in `groups&#x27;, removing them from all other groups. Mutually exclusive with `local&#x27;</span><br><span class="line">      authorization:         # Sets the authorization of the user. Does nothing when used with other platforms. Can set multiple authorizations using comma separation. To delete all authorizations, use `authorization=&#x27;&#x27;&#x27;. Currently supported on Illumos/Solaris.</span><br><span class="line">      comment:               # æè¿°ä¿¡æ¯# Optionally sets the description (aka `GECOS&#x27;) of user account.</span><br><span class="line">      create_home:           # Unless set to `no&#x27;, a home directory will be made for the user when the account is created or if the home directory does not</span><br><span class="line">                               exist. Changed from `createhome&#x27; to `create_home&#x27; in Ansible 2.5.</span><br><span class="line">      expires:              # è®¾ç½®è´¦å·æœ‰æ•ˆæœŸ # An expiry time for the user in epoch, it will be ignored on platforms that do not support this. Currently supported on GNU/Linux, FreeBSD, and DragonFlyBSD. Since Ansible 2.6 you can remove the expiry time specify a negative value. Currently supported on GNU/Linux and FreeBSD.</span><br><span class="line">      force:                 # This only affects `state=absent&#x27;, it forces removal of the user and associated directories on supported platforms. The behavior is the same as `userdel --force&#x27;, check the man page for `userdel&#x27; on your system for details and support. When used with `generate_ssh_key=yes&#x27; this forces an existing key to be overwritten.</span><br><span class="line">      generate_ssh_key:      # Whether to generate a SSH key for the user in question. This will *not* overwrite an existing SSH key unless used with  `force=yes&#x27;.</span><br><span class="line">      group:                 # è®¾ç½®ä¸»ç»„ # Optionally sets the user&#x27;s primary group (takes a group name).</span><br><span class="line">      groups:                # è®¾ç½®é™„åŠ ç»„ # List of groups user will be added to. When set to an empty string `&#x27;&#x27;&#x27;, the user is removed from all groups except the primary group. Before Ansible 2.3, the only input format allowed was a comma separated string. Mutually exclusive with `local&#x27;</span><br><span class="line">      hidden:                # macOS only, optionally hide the user from the login window and system preferences. The default will be `yes&#x27; if the `system&#x27; option is used.</span><br><span class="line">      home:                # æŒ‡å®šç”¨æˆ·å®¶ç›®å½•  # Optionally set the user&#x27;s home directory.</span><br><span class="line">      local:                 # Forces the use of &quot;local&quot; command alternatives on platforms that implement it. This is useful in environments that use centralized authentification when you want to manipulate the local users (i.e. it uses `luseradd&#x27; instead of `useradd&#x27;). This will check `/etc/passwd&#x27; for an existing account before invoking commands. If the local account database exists somewhere other than `/etc/passwd&#x27;, this setting will not work properly. This requires that the above commands as well as `/etc/passwd&#x27; must exist on the target host, otherwise it will be a fatal error. Mutually exclusive with `groups&#x27; and `append&#x27;</span><br><span class="line">      login_class:           # Optionally sets the user&#x27;s login class, a feature of most BSD OSs.</span><br><span class="line">      move_home:             # If set to `yes&#x27; when used with `home: &#x27;, attempt to move the user&#x27;s old home directory to the specified directory if it isn&#x27;t there already and the old home exists.</span><br><span class="line">      name:                 # è®¾ç½®ç”¨æˆ·å # (required) Name of the user to create, remove or modify.</span><br><span class="line">      non_unique:            # Optionally when used with the -u option, this option allows to change the user ID to a non-unique value.</span><br><span class="line">      password:              # è®¾ç½®ç”¨æˆ·çš„å¯†ç  # Optionally set the user&#x27;s password to this crypted value. On macOS systems, this value has to be cleartext. Beware of security issues. To create a disabled account on Linux systems, set this to `&#x27;!&#x27;&#x27; or `&#x27;*&#x27;&#x27;. To create a disabled account on OpenBSD, set this to `&#x27;*************&#x27;&#x27;. See https://docs.ansible.com/ansible/faq.html#how-do-i-generate-encrypted-passwords-for-the-user-module for details on various ways to generate these password values. </span><br><span class="line">      password_lock:         # Lock the password (`usermod -L&#x27;, `usermod -U&#x27;, `pw lock&#x27;). Implementation differs by platform. This option does not always mean the user cannot login using other methods. This option does not disable the user, only lock the password. This must be set to `False&#x27; in order to unlock a currently locked password. The absence of this parameter will not unlock a password. Currently supported on Linux, FreeBSD, DragonFlyBSD, NetBSD, OpenBSD.</span><br><span class="line">      profile:               # Sets the profile of the user. Does nothing when used with other platforms. Can set multiple profiles using comma separation.  To delete all the profiles, use `profile=&#x27;&#x27;&#x27;. Currently supported on Illumos/Solaris.</span><br><span class="line">      remove:               #æ˜¯å¦åœ¨åˆ é™¤ç”¨æˆ·çš„åŒæ—¶åˆ é™¤å®¶ç›®å½• # This only affects `state=absent&#x27;, it attempts to remove directories associated with the user. The behavior is the same as   `userdel --remove&#x27;, check the man page for details and support.</span><br><span class="line">      role:                  # Sets the role of the user. Does nothing when used with other platforms. Can set multiple roles using comma separation. To delete all roles, use `role=&#x27;&#x27;&#x27;. Currently supported on Illumos/Solaris.</span><br><span class="line">      seuser:                # Optionally sets the seuser type (user_u) on selinux enabled systems.</span><br><span class="line">      shell:                 # Optionally set the user&#x27;s shell. On macOS, before Ansible 2.5, the default shell for non-system users was `/usr/bin/false&#x27;.  Since Ansible 2.5, the default shell for non-system users on macOS is `/bin/bash&#x27;. On other operating systems, the default shell is determined by the underlying tool being used. See Notes   for details.</span><br><span class="line">      skeleton:              # Optionally set a home skeleton directory. Requires `create_home&#x27; option!</span><br><span class="line">      ssh_key_bits:          # Optionally specify number of bits in SSH key to create.</span><br><span class="line">      ssh_key_comment:       # Optionally define the comment for the SSH key.</span><br><span class="line">      ssh_key_file:          # Optionally specify the SSH key filename. If this is a relative filename then it will be relative to the user&#x27;s home directory. This parameter defaults to `.ssh/id_rsa&#x27;.</span><br><span class="line">      ssh_key_passphrase:    # Set a passphrase for the SSH key. If no passphrase is provided, the SSH key will default to having no passphrase.</span><br><span class="line">      ssh_key_type:          # Optionally specify the type of SSH key to generate. Available SSH key types will depend on implementation present on target   host.</span><br><span class="line">      state:               # å¯¹ç”¨æˆ·è¿›è¡Œçš„æ“ä½œï¼ˆåˆ é™¤absentï¼Œé»˜è®¤presentåˆ›å»ºï¼‰ # Whether the account should exist or not, taking action if the state is different from what is stated.</span><br><span class="line">      system:               # æ˜¯å¦è®¾ç½®ç”¨æˆ·ä¸ºç³»ç»Ÿç”¨æˆ· # When creating an account `state=present&#x27;, setting this to `yes&#x27; makes the user a system account. This setting cannot be</span><br><span class="line">                               changed on existing users.</span><br><span class="line">      uid:                   # æ‰‹åŠ¨è®¾ç½®ç”¨æˆ·çš„uid # Optionally sets the `UID&#x27; of the user.</span><br><span class="line">      update_password:      # æ›´è¡Œç”¨æˆ·å¯†ç  # `always&#x27; will update passwords if they differ. `on_create&#x27; will only set the password for newly created users.</span><br></pre></td></tr></table></figure><h2 id="groupç®¡ç†ç»„"><a href="#groupç®¡ç†ç»„" class="headerlink" title="groupç®¡ç†ç»„"></a>groupç®¡ç†ç»„</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- name: Add or remove groups</span><br><span class="line">  group:</span><br><span class="line">      gid:                   # Optional `GID&#x27; to set for the group.</span><br><span class="line">      local:                 # Forces the use of &quot;local&quot; command alternatives on platforms that implement it. This is useful in environments that use centralized authentication when you want to manipulate the local groups. (e.g. it uses `lgroupadd&#x27; instead of `groupadd&#x27;). This requires that these commands exist on the targeted host, otherwise it will be a fatal error.</span><br><span class="line">      name:                  # (required) Name of the group to manage.</span><br><span class="line">      non_unique:            # This option allows to change the group ID to a non-unique value. Requires `gid&#x27;. Not supported on macOS or BusyBox distributions.</span><br><span class="line">      state:                 # Whether the group should be present or not on the remote host.</span><br><span class="line">      system:                # If `yes&#x27;, indicates that the group created is a system group.</span><br></pre></td></tr></table></figure><h1 id="ansible-galaxyå‘½ä»¤"><a href="#ansible-galaxyå‘½ä»¤" class="headerlink" title="ansible-galaxyå‘½ä»¤"></a>ansible-galaxyå‘½ä»¤</h1><blockquote><p>è¿æ¥<a href="https://galaxy.ansible.comä¸‹è½½ç›¸åº”çš„roles./">https://galaxy.ansible.comä¸‹è½½ç›¸åº”çš„rolesã€‚</a></p></blockquote><h2 id="åˆ—å‡ºroles"><a href="#åˆ—å‡ºroles" class="headerlink" title="åˆ—å‡ºroles"></a>åˆ—å‡ºroles</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-galaxy list</span><br></pre></td></tr></table></figure><h2 id="ä¸‹è½½roles"><a href="#ä¸‹è½½roles" class="headerlink" title="ä¸‹è½½roles"></a>ä¸‹è½½roles</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-galaxy install &lt;&gt;</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤roles"><a href="#åˆ é™¤roles" class="headerlink" title="åˆ é™¤roles"></a>åˆ é™¤roles</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-galaxy remove &lt;&gt;</span><br></pre></td></tr></table></figure><h1 id="ansible-playbookå‘½ä»¤"><a href="#ansible-playbookå‘½ä»¤" class="headerlink" title="ansible-playbookå‘½ä»¤"></a>ansible-playbookå‘½ä»¤</h1><blockquote><p>å‰§æœ¬</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">optional arguments:</span><br><span class="line">  --ask-vault-pass      ask for vault password</span><br><span class="line">  --flush-cache         clear the fact cache for every host in inventory</span><br><span class="line">  --force-handlers      run handlers even if a task fails</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">åˆ—å‡ºä¸»æœº</span></span><br><span class="line">  --list-hosts          outputs a list of matching hosts; does not execute</span><br><span class="line">                        anything else</span><br><span class="line"><span class="meta prompt_"> # </span><span class="language-bash">åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">  --list-tags           list all available tags</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡</span></span><br><span class="line">  --list-tasks          list all tasks that would be executed</span><br><span class="line">  --skip-tags SKIP_TAGS</span><br><span class="line">                        only run plays and tasks whose tags do not match these</span><br><span class="line">                        values</span><br><span class="line">  --start-at-task START_AT_TASK</span><br><span class="line">                        start the playbook at the task matching this name</span><br><span class="line">  --step                one-step-at-a-time: confirm each task before running</span><br><span class="line">  --syntax-check        perform a syntax check on the playbook, but do not</span><br><span class="line">                        execute it</span><br><span class="line">  --vault-id VAULT_IDS  the vault identity to use</span><br><span class="line">  --vault-password-file VAULT_PASSWORD_FILES</span><br><span class="line">                        vault password file</span><br><span class="line">  --version             show program&#x27;s version number, config file location,</span><br><span class="line">                        configured module search path, module location,</span><br><span class="line">                        executable location and exit</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">è¿è¡Œæµ‹è¯•ï¼Œå¹¶ä¸ä¼šåšä¿®æ”¹</span></span><br><span class="line">  -C, --check           don&#x27;t make any changes; instead, try to predict some</span><br><span class="line">                        of the changes that may occur</span><br><span class="line">  -D, --diff            when changing (small) files and templates, show the</span><br><span class="line">                        differences in those files; works great with --check</span><br><span class="line">  -M MODULE_PATH, --module-path MODULE_PATH</span><br><span class="line">                        prepend colon-separated path(s) to module library (def</span><br><span class="line">                        ault=~/.ansible/plugins/modules:/usr/share/ansible/plu</span><br><span class="line">                        gins/modules)</span><br><span class="line">  -e EXTRA_VARS, --extra-vars EXTRA_VARS</span><br><span class="line">                        set additional variables as key=value or YAML/JSON, if</span><br><span class="line">                        filename prepend with @</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">ä¿®æ”¹å¹¶å‘æ•°ç›®ï¼Œé»˜è®¤ä¸º5</span></span><br><span class="line">  -f FORKS, --forks FORKS</span><br><span class="line">                        specify number of parallel processes to use</span><br><span class="line">                        (default=5)</span><br><span class="line">  -h, --help            show this help message and exit</span><br><span class="line">  -i INVENTORY, --inventory INVENTORY, --inventory-file INVENTORY</span><br><span class="line">                        specify inventory host path or comma separated host</span><br><span class="line">                        list. --inventory-file is deprecated</span><br><span class="line">  -l SUBSET, --limit SUBSET</span><br><span class="line">                        further limit selected hosts to an additional pattern</span><br><span class="line">  -t TAGS, --tags TAGS  only run plays and tasks tagged with these values</span><br><span class="line">  -v, --verbose         verbose mode (-vvv for more, -vvvv to enable</span><br><span class="line">                        connection debugging)</span><br><span class="line">Privilege Escalation Options:</span><br><span class="line">  control how and which user you become as on target hosts</span><br><span class="line"></span><br><span class="line">  --become-method BECOME_METHOD</span><br><span class="line">                        privilege escalation method to use (default=sudo), use</span><br><span class="line">                        `ansible-doc -t become -l` to list valid choices.</span><br><span class="line">  --become-user BECOME_USER</span><br><span class="line">                        run operations as this user (default=root)</span><br><span class="line">  -K, --ask-become-pass</span><br><span class="line">                        ask for privilege escalation password</span><br><span class="line">  -b, --become          run operations with become (does not imply password</span><br><span class="line">                        prompting)</span><br></pre></td></tr></table></figure><h1 id="ansible-vaultå‘½ä»¤"><a href="#ansible-vaultå‘½ä»¤" class="headerlink" title="ansible-vaultå‘½ä»¤"></a>ansible-vaultå‘½ä»¤</h1><blockquote><p>å¯¹ymlå‰§æœ¬æ–‡ä»¶è¿›è¡ŒåŠ å¯†è§£å¯†</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">positional arguments:</span><br><span class="line">  &#123;create,decrypt,edit,view,encrypt,encrypt_string,rekey&#125;</span><br><span class="line">    create              Create new vault encrypted file</span><br><span class="line">    decrypt             Decrypt vault encrypted file</span><br><span class="line">    edit                Edit vault encrypted file</span><br><span class="line">    view                View vault encrypted file</span><br><span class="line">    encrypt             Encrypt YAML file</span><br><span class="line">    encrypt_string      Encrypt a string</span><br><span class="line">    rekey               Re-key a vault encrypted file</span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  --version             show program&#x27;s version number, config file location,</span><br><span class="line">                        configured module search path, module location,</span><br><span class="line">                        executable location and exit</span><br><span class="line">  -h, --help            show this help message and exit</span><br><span class="line">  -v, --verbose         verbose mode (-vvv for more, -vvvv to enable</span><br><span class="line">                        connection debugging)</span><br></pre></td></tr></table></figure><h2 id="åŠ å¯†-x2F-è§£å¯†"><a href="#åŠ å¯†-x2F-è§£å¯†" class="headerlink" title="åŠ å¯†&#x2F;è§£å¯†"></a>åŠ å¯†&#x2F;è§£å¯†</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-vault encrypt/decrypt &lt;&gt;</span><br></pre></td></tr></table></figure><h1 id="å‰§æœ¬yamlæ–‡ä»¶è¯­æ³•"><a href="#å‰§æœ¬yamlæ–‡ä»¶è¯­æ³•" class="headerlink" title="å‰§æœ¬yamlæ–‡ä»¶è¯­æ³•"></a>å‰§æœ¬yamlæ–‡ä»¶è¯­æ³•</h1><h2 id="ç»“åˆansibleåšç®€å•ä»‹ç»"><a href="#ç»“åˆansibleåšç®€å•ä»‹ç»" class="headerlink" title="ç»“åˆansibleåšç®€å•ä»‹ç»"></a>ç»“åˆansibleåšç®€å•ä»‹ç»</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">---</span> <span class="comment">#å¼€å¤´ä¸‰ä¸ªè¿æ¥ç¬¦è¡¨ç¤ºæ¡£æ¡ˆçš„å¼€å§‹ï¼Œå¯ä»¥ä¸å†™ï¼Œè¿™åªæ˜¯ä¸€ä¸ªä¹ æƒ¯</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="comment">#æŒ‡å®šä¸»æœºï¼Œç±»ä¼¼ansibleåçš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="comment">#æŒ‡å®šç™»å½•çš„ç”¨æˆ·</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">tasks:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="comment">#ä»»åŠ¡æ¨¡å—ï¼Œæè¿°ä¿¡æ¯ï¼Œä¸€ä¸ªnameå¯¹åº”ä¸€ä¸ªæ¨¡å—</span></span><br><span class="line">      <span class="string">&lt;module&gt;:</span> <span class="comment">#æ¨¡å—åå’Œå‚æ•°çš„é”®å€¼å¯¹ï¼ˆè¿™æ˜¯æœ€å¸¸ç”¨çš„å½¢å¼ï¼‰</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> </span><br><span class="line">      <span class="attr">action:</span> <span class="string">&lt;module&gt;</span> <span class="string">&lt;argues&gt;</span> <span class="comment">#è¿™æ˜¯ç¬¬äºŒç§å½¢å¼ï¼ˆä¸å¸¸ç”¨ï¼‰</span></span><br><span class="line"><span class="string">...</span> <span class="comment">#è¡¨ç¤ºç»“å°¾ï¼Œå¯ä»¥ä¸å†™</span></span><br></pre></td></tr></table></figure><h2 id="tasks-handlerså’Œtags"><a href="#tasks-handlerså’Œtags" class="headerlink" title="tasks,handlerså’Œtags"></a>tasks,handlerså’Œtags</h2><blockquote><p>tasksä¸­çš„ä»»åŠ¡æ˜¯ä¾æ¬¡æ‰§è¡Œçš„ï¼Œå½“å‡ºç°å‰ä¸€ä¸ªä»»åŠ¡ä¿®æ”¹äº†é…ç½®æ–‡ä»¶ï¼Œåä¸€ä¸ªä»»åŠ¡æ˜¯å¯åŠ¨æœåŠ¡çš„æƒ…å†µæ—¶ï¼Œtasksæ— æ³•è®©æœåŠ¡é‡å¯ä½¿æ–°çš„é…ç½®ç”Ÿæ•ˆã€‚</p></blockquote><div class="admonition note"><p class="admonition-title">handlers</p><p>handlersè§¦å‘å™¨ï¼Œå¯ä»¥ç”¨æ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p></div><h2 id="handlers"><a href="#handlers" class="headerlink" title="handlers"></a>handlers</h2><blockquote><p>ä¸taskså¹³çº§ï¼Œéœ€è¦ä½¿ç”¨<code>notify</code>ç»‘å®šäº‹ä»¶</p></blockquote><p>ä»¥nginxæœåŠ¡ä¸ºä¾‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">centos</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">root</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line"><span class="comment">#    - name: install nginx</span></span><br><span class="line"><span class="comment">#      yum: name=nginx</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config</span></span><br><span class="line">      <span class="attr">copy:</span> <span class="string">src=/etc/nginx/nginx.conf</span> <span class="string">dest=/etc/nginx/</span></span><br><span class="line">      <span class="attr">notify:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">restart</span> <span class="string">nginx</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">check</span> <span class="string">nginx</span> <span class="string">process</span></span><br><span class="line">      <span class="attr">tags:</span> <span class="string">copy_config</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">start</span> <span class="string">nginx</span> <span class="string">service</span></span><br><span class="line">      <span class="attr">service:</span> <span class="string">name=nginx</span> <span class="string">state=started</span> <span class="string">enabled=yes</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">handlers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">restart</span> <span class="string">nginx</span></span><br><span class="line">      <span class="attr">service:</span> <span class="string">name=nginx</span> <span class="string">state=restarted</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">check</span> <span class="string">nginx</span> <span class="string">process</span></span><br><span class="line">      <span class="attr">shell:</span> <span class="string">killall</span> <span class="number">-0</span> <span class="string">nginx</span> <span class="string">&gt;</span> <span class="string">/tmp/nginx.log</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="tags"><a href="#tags" class="headerlink" title="tags"></a>tags</h2><blockquote><p>ä½¿ç”¨æ ‡ç­¾ï¼Œå¯ä»¥ç”¨äºç‰¹å®šæ‰§è¡ŒæŸäº›åŠ¨ä½œã€‚</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ...</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config</span></span><br><span class="line">      <span class="attr">copy:</span> <span class="string">src=/etc/nginx/nginx.conf</span> <span class="string">dest=/etc/nginx/</span></span><br><span class="line">      <span class="attr">notify:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">restart</span> <span class="string">nginx</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">check</span> <span class="string">nginx</span> <span class="string">process</span></span><br><span class="line">      <span class="attr">tags:</span> <span class="string">copy_config</span></span><br><span class="line"><span class="comment"># ...</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ä½¿ç”¨-tå‚æ•°å¯ä»¥æŒ‡å®šæ ‡ç­¾</span></span><br><span class="line">ansible-playbook nginx.yml -t copy_config</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ansibleå­¦ä¹ ç¬”è®°</summary>
    
    
    
    <category term="Linux" scheme="http://asucanyh-cn.github.io/categories/Linux/"/>
    
    
    <category term="ansible" scheme="http://asucanyh-cn.github.io/tags/ansible/"/>
    
    <category term="linux" scheme="http://asucanyh-cn.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>ansibleå­¦ä¹ ç¬”è®°Part2</title>
    <link href="http://asucanyh-cn.github.io/posts/3151396298/"/>
    <id>http://asucanyh-cn.github.io/posts/3151396298/</id>
    <published>2023-01-21T16:00:00.000Z</published>
    <updated>2023-03-14T12:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ansibleçš„Host-pattern"><a href="#ansibleçš„Host-pattern" class="headerlink" title="ansibleçš„Host-pattern"></a>ansibleçš„Host-pattern</h1><blockquote><p>åŒå¼•å·å’Œå•å¼•å·çš„ä½¿ç”¨è¦ç•™æ„ã€‚</p></blockquote><blockquote><p>ç›´æ¥é€šé…ç¬¦</p></blockquote><ol><li>all è¡¨ç¤ºæ‰€æœ‰ä¸»æœºåˆ—è¡¨ä¸­çš„ä¸»æœº</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m ping</span><br></pre></td></tr></table></figure><ol start="2"><li><ul><li>ç¼ºçœé€šé…ç¬¦</li></ul></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible &quot;*est&quot; -m ping</span><br></pre></td></tr></table></figure><ol start="3"><li>: æˆ–å…³ç³»</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible &quot;websrvs:appsrvs&quot; -m ping</span><br></pre></td></tr></table></figure><ol start="4"><li>:&amp; é€»è¾‘ä¸</li></ol><p>å¦‚ï¼šåœ¨Aç»„ä¸”åœ¨Bç»„ä¸­çš„ä¸»æœº</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible &quot;A:&amp;B&quot; -m ping</span><br></pre></td></tr></table></figure><ol start="5"><li>:! é€»è¾‘é</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible &#x27;A:!B&#x27; -m ping</span><br></pre></td></tr></table></figure><ol start="6"><li>~ æ­£åˆ™è¡¨è¾¾å¼</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible &quot;~(web|db).*&quot;</span><br></pre></td></tr></table></figure><h1 id="ansibleæ‰§è¡ŒçŠ¶æ€"><a href="#ansibleæ‰§è¡ŒçŠ¶æ€" class="headerlink" title="ansibleæ‰§è¡ŒçŠ¶æ€"></a>ansibleæ‰§è¡ŒçŠ¶æ€</h1><ul><li><p>ç»¿è‰²è¡¨ç¤ºæ‰§è¡ŒæˆåŠŸä¸”æœªåšæ›´æ”¹ï¼›</p></li><li><p>é»„è‰²è¡¨ç¤ºæ‰§è¡ŒæˆåŠŸä¸”åšäº†æ›´æ”¹ï¼›</p></li><li><p>çº¢è‰²è¡¨ç¤ºæ‰§è¡Œå¤±è´¥ï¼›</p></li><li><p>è“è‰²è¡¨ç¤ºè¯¦ç»†è¿‡ç¨‹ï¼›</p></li><li><p>ç´«è‰²è¡¨ç¤ºè­¦å‘Šï¼›</p></li><li><p>æ·±ç°è¡¨ç¤ºdebugï¼›</p></li><li><p>è¤è‰²è¡¨ç¤ºå¼ƒç”¨ã€‚</p></li></ul><h1 id="ansibleå¸¸ç”¨æ¨¡å—"><a href="#ansibleå¸¸ç”¨æ¨¡å—" class="headerlink" title="ansibleå¸¸ç”¨æ¨¡å—"></a>ansibleå¸¸ç”¨æ¨¡å—</h1><blockquote><p>ä½¿ç”¨ä¸€ä¸ªæ¨¡å—å‰ï¼Œå¯ä»¥ä½¿ç”¨<code>ansible-doc &lt;moduel&gt;</code>æŸ¥çœ‹ä¸€äº›å¸®åŠ©ã€‚</p></blockquote><h2 id="commandæ¨¡å—"><a href="#commandæ¨¡å—" class="headerlink" title="commandæ¨¡å—"></a>commandæ¨¡å—</h2><blockquote><p>åŠŸèƒ½ï¼šåœ¨è¿œç¨‹ä¸»æœºæ‰§è¡Œå‘½ä»¤ã€‚</p><p>ä¸å¥½ç”¨ï¼Œå»ºè®®ç”¨shellæ¨¡å—ä»£æ›¿</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">- argv</span><br><span class="line">        Passes the command as a list rather than a string.</span><br><span class="line">        Use `argv&#x27; to avoid quoting values that would otherwise be interpreted incorrectly (for example &quot;user name&quot;).</span><br><span class="line">        Only the string or the list form can be provided, not both.  One or the other must be provided.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: list</span><br><span class="line">        version_added: 2.6</span><br><span class="line"></span><br><span class="line">- chdir</span><br><span class="line">        Change into this directory before running the command.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: path</span><br><span class="line">        version_added: 0.6</span><br><span class="line"></span><br><span class="line">- cmd</span><br><span class="line">        The command to run.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- creates</span><br><span class="line">        A filename or (since 2.0) glob pattern. If it already exists, this step *won&#x27;t* be run.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: path</span><br><span class="line"></span><br><span class="line">- free_form</span><br><span class="line">        The command module takes a free form command to run.</span><br><span class="line">        There is no actual parameter named &#x27;free form&#x27;.</span><br><span class="line">        [Default: (null)]</span><br><span class="line"></span><br><span class="line">- removes</span><br><span class="line">        A filename or (since 2.0) glob pattern. If it already exists, this step *will* be run.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: path</span><br><span class="line">        version_added: 0.8</span><br><span class="line"></span><br><span class="line">- stdin</span><br><span class="line">        Set the stdin of the command directly to the specified value.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        version_added: 2.4</span><br><span class="line"></span><br><span class="line">- stdin_add_newline</span><br><span class="line">        If set to `yes&#x27;, append a newline to stdin data.</span><br><span class="line">        [Default: True]</span><br><span class="line">        type: bool</span><br><span class="line">        version_added: 2.8</span><br><span class="line"></span><br><span class="line">- strip_empty_ends</span><br><span class="line">        Strip empty lines from the end of stdout/stderr in result.</span><br><span class="line">        [Default: True]</span><br><span class="line">        type: bool</span><br><span class="line">        version_added: 2.8</span><br><span class="line"></span><br><span class="line">- warn</span><br><span class="line">        Enable or disable task warnings.</span><br><span class="line">        [Default: True]</span><br><span class="line">        type: bool</span><br><span class="line">        version_added: 1.8</span><br></pre></td></tr></table></figure><p>ä¸æ”¯æŒï¼š$å˜é‡ã€ç‰¹æ®Šç¬¦å·ï¼ˆåˆ†å·ï¼Œé‡å®šå‘ï¼Œç®¡é“ç¬¦ç­‰ï¼‰ã€‚</p><h2 id="shellæ¨¡å—"><a href="#shellæ¨¡å—" class="headerlink" title="shellæ¨¡å—"></a>shellæ¨¡å—</h2><blockquote><p>åŠŸèƒ½ï¼šè°ƒç”¨bashï¼Œåœ¨è¿œç¨‹ä¸»æœºæ‰§è¡Œå‘½ä»¤ã€‚</p><p>åœ¨æ‰§è¡Œä¸€äº›å¤æ‚å‘½ä»¤æ—¶ä¹Ÿå¯èƒ½ä¼šæŠ¥é”™ã€‚ä¸€èˆ¬è§£å†³æ–¹æ¡ˆä¸ºå†™è„šæœ¬æ‰§è¡Œï¼Œå†å°†ç»“æœæ‹‰å›ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS (= is mandatory):</span><br><span class="line"></span><br><span class="line">- chdir</span><br><span class="line">        Change into this directory before running the command.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: path</span><br><span class="line">        version_added: 0.6</span><br><span class="line"></span><br><span class="line">- cmd</span><br><span class="line">        The command to run followed by optional arguments.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- creates</span><br><span class="line">        A filename, when it already exists, this step will *not* be run.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: path</span><br><span class="line"></span><br><span class="line">- executable</span><br><span class="line">        Change the shell used to execute the command.</span><br><span class="line">        This expects an absolute path to the executable.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: path</span><br><span class="line">        version_added: 0.9</span><br><span class="line"></span><br><span class="line">- free_form</span><br><span class="line">        The shell module takes a free form command to run, as a string.</span><br><span class="line">        There is no actual parameter named &#x27;free form&#x27;.</span><br><span class="line">        See the examples on how to use this module.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- removes</span><br><span class="line">        A filename, when it does not exist, this step will *not* be run.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: path</span><br><span class="line">        version_added: 0.8</span><br><span class="line"></span><br><span class="line">- stdin</span><br><span class="line">        Set the stdin of the command directly to the specified value.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line">        version_added: 2.4</span><br><span class="line"></span><br><span class="line">- stdin_add_newline</span><br><span class="line">        Whether to append a newline to stdin data.</span><br><span class="line">        [Default: True]</span><br><span class="line">        type: bool</span><br><span class="line">        version_added: 2.8</span><br><span class="line"></span><br><span class="line">- warn</span><br><span class="line">        Whether to enable task warnings.</span><br><span class="line">        [Default: True]</span><br><span class="line">        type: bool</span><br><span class="line">        version_added: 1.8</span><br></pre></td></tr></table></figure><h2 id="scriptæ¨¡å—"><a href="#scriptæ¨¡å—" class="headerlink" title="scriptæ¨¡å—"></a>scriptæ¨¡å—</h2><blockquote><p>åŠŸèƒ½ï¼šè¿è¡Œè„šæœ¬ã€‚è‡ªåŠ¨å®Œæˆå¤åˆ¶è„šæœ¬åœ¨è¿œç¨‹ä¸»æœºå®Œæˆã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS (= is mandatory):</span><br><span class="line"></span><br><span class="line">- chdir</span><br><span class="line">        Change into this directory on the remote node before running the script.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        version_added: 2.4</span><br><span class="line"></span><br><span class="line">- cmd</span><br><span class="line">        Path to the local script to run followed by optional arguments.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        type: str</span><br><span class="line"></span><br><span class="line">- creates</span><br><span class="line">        A filename on the remote node, when it already exists, this step will *not* be run.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        version_added: 1.5</span><br><span class="line"></span><br><span class="line">- decrypt</span><br><span class="line">        This option controls the autodecryption of source files using vault.</span><br><span class="line">        [Default: True]</span><br><span class="line">        type: bool</span><br><span class="line">        version_added: 2.4</span><br><span class="line"></span><br><span class="line">- executable</span><br><span class="line">        Name or path of a executable to invoke the script with.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        version_added: 2.6</span><br><span class="line"></span><br><span class="line">- free_form</span><br><span class="line">        Path to the local script file followed by optional arguments.</span><br><span class="line">        [Default: (null)]</span><br><span class="line"></span><br><span class="line">- removes</span><br><span class="line">        A filename on the remote node, when it does not exist, this step will *not* be run.</span><br><span class="line">        [Default: (null)]</span><br><span class="line">        version_added: 1.5</span><br></pre></td></tr></table></figure><h2 id="copyæ¨¡å—"><a href="#copyæ¨¡å—" class="headerlink" title="copyæ¨¡å—"></a>copyæ¨¡å—</h2><blockquote><p>å¤åˆ¶æ–‡ä»¶è‡³è¿œç¨‹ä¸»æœºã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è¯·ç”¨ansible-doc copyæŸ¥çœ‹</span></span><br><span class="line">copy:</span><br><span class="line">      attributes:            # The attributes the resulting file or directory should have. To get supported flags look at the man page for `chattr&#x27; on the</span><br><span class="line">                               target system. This string should contain the attributes in the same order as the one displayed</span><br><span class="line">                               by `lsattr&#x27;. The `=&#x27; operator is assumed as default, otherwise `+&#x27; or `-&#x27; operators need to be</span><br><span class="line">                               included in the string.</span><br><span class="line">      backup:                # Create a backup file including the timestamp information so you can get the original file back if you somehow clobbered it</span><br><span class="line">                               incorrectly.</span><br><span class="line">      checksum:              # SHA1 checksum of the file being transferred. Used to validate that the copy of the file was successful. If this is not</span><br><span class="line">                               provided, ansible will use the local calculated checksum of the src file.</span><br><span class="line">      content:               # When used instead of `src&#x27;, sets the contents of a file directly to the specified value. Works only when `dest&#x27; is a file.</span><br><span class="line">                               Creates the file if it does not exist. For advanced formatting or if `content&#x27; contains a</span><br><span class="line">                               variable, use the [template] module.</span><br><span class="line">      decrypt:               # This option controls the autodecryption of source files using vault.</span><br><span class="line">      dest:                  # (required) Remote absolute path where the file should be copied to. If `src&#x27; is a directory, this must be a directory too. If</span><br><span class="line">                               `dest&#x27; is a non-existent path and if either `dest&#x27; ends with &quot;/&quot; or `src&#x27; is a directory,</span><br><span class="line">                               `dest&#x27; is created. If `dest&#x27; is a relative path, the starting directory is determined by the</span><br><span class="line">                               remote host. If `src&#x27; and `dest&#x27; are files, the parent directory of `dest&#x27; is not created and</span><br><span class="line">                               the task fails if it does not already exist.</span><br><span class="line">      directory_mode:        # When doing a recursive copy set the mode for the directories. If this is not set we will use the system defaults. The mode is</span><br><span class="line">                               only set on directories which are newly created, and will not affect those that already</span><br><span class="line">                               existed.</span><br><span class="line">      follow:                # This flag indicates that filesystem links in the destination, if they exist, should be followed.</span><br><span class="line">      force:                 # Influence whether the remote file must always be replaced. If `yes&#x27;, the remote file will be replaced when contents are</span><br><span class="line">                               different than the source. If `no&#x27;, the file will only be transferred if the destination does</span><br><span class="line">                               not exist. Alias `thirsty&#x27; has been deprecated and will be removed in 2.13.</span><br><span class="line">      group:                 # Name of the group that should own the file/directory, as would be fed to `chown&#x27;.</span><br><span class="line">      local_follow:          # This flag indicates that filesystem links in the source tree, if they exist, should be followed.</span><br><span class="line">      mode:                  # The permissions of the destination file or directory. For those used to `/usr/bin/chmod&#x27; remember that modes are actually</span><br><span class="line">                               octal numbers. You must either add a leading zero so that Ansible&#x27;s YAML parser knows it is an</span><br><span class="line">                               octal number (like `0644&#x27; or `01777&#x27;)or quote it (like `&#x27;644&#x27;&#x27; or `&#x27;1777&#x27;&#x27;) so Ansible receives</span><br><span class="line">                               a string and can do its own conversion from string into number. Giving Ansible a number without</span><br><span class="line">                               following one of these rules will end up with a decimal number which will have unexpected</span><br><span class="line">                               results. As of Ansible 1.8, the mode may be specified as a symbolic mode (for example, `u+rwx&#x27;</span><br><span class="line">                               or `u=rw,g=r,o=r&#x27;). As of Ansible 2.3, the mode may also be the special string `preserve&#x27;.</span><br><span class="line">                               `preserve&#x27; means that the file will be given the same permissions as the source file.</span><br><span class="line">      owner:                 # Name of the user that should own the file/directory, as would be fed to `chown&#x27;.</span><br><span class="line">      remote_src:            # Influence whether `src&#x27; needs to be transferred or already is present remotely. If `no&#x27;, it will search for `src&#x27; at</span><br><span class="line">                               originating/master machine. If `yes&#x27; it will go to the remote/target machine for the `src&#x27;.</span><br><span class="line">                               `remote_src&#x27; supports recursive copying as of version 2.8. `remote_src&#x27; only works with</span><br><span class="line">                               `mode=preserve&#x27; as of version 2.6.</span><br><span class="line">      selevel:               # The level part of the SELinux file context. This is the MLS/MCS attribute, sometimes known as the `range&#x27;. When set to</span><br><span class="line">                               `_default&#x27;, it will use the `level&#x27; portion of the policy if available.</span><br><span class="line">      serole:                # The role part of the SELinux file context. When set to `_default&#x27;, it will use the `role&#x27; portion of the policy if available.</span><br><span class="line">      setype:                # The type part of the SELinux file context. When set to `_default&#x27;, it will use the `type&#x27; portion of the policy if available.</span><br><span class="line">      seuser:                # The user part of the SELinux file context. By default it uses the `system&#x27; policy, where applicable. When set to `_default&#x27;,</span><br><span class="line">                               it will use the `user&#x27; portion of the policy if available.</span><br><span class="line">      src:                   # Local path to a file to copy to the remote server. This can be absolute or relative. If path is a directory, it is copied</span><br><span class="line">                               recursively. In this case, if path ends with &quot;/&quot;, only inside contents of that directory are</span><br><span class="line">                               copied to destination. Otherwise, if it does not end with &quot;/&quot;, the directory itself with all</span><br><span class="line">                               contents is copied. This behavior is similar to the `rsync&#x27; command line tool.</span><br><span class="line">      unsafe_writes:         # Influence when to use atomic operation to prevent data corruption or inconsistent reads from the target file. By default this</span><br><span class="line">                               module uses atomic operations to prevent data corruption or inconsistent reads from the target</span><br><span class="line">                               files, but sometimes systems are configured or just broken in ways that prevent this. One</span><br><span class="line">                               example is docker mounted files, which cannot be updated atomically from inside the container</span><br><span class="line">                               and can only be written in an unsafe manner. This option allows Ansible to fall back to unsafe</span><br><span class="line">                               methods of updating files when atomic operations fail (however, it doesn&#x27;t force Ansible to</span><br><span class="line">                               perform unsafe writes). IMPORTANT! Unsafe writes are subject to race conditions and can lead to</span><br><span class="line">                               data corruption.</span><br><span class="line">      validate:              # The validation command to run before copying into place. The path to the file to validate is passed in via &#x27;%s&#x27; which must be</span><br><span class="line">                               present as in the examples below. The command is passed securely so shell features like</span><br><span class="line">                               expansion and pipes will not work.</span><br></pre></td></tr></table></figure><h2 id="fetchæ¨¡å—"><a href="#fetchæ¨¡å—" class="headerlink" title="fetchæ¨¡å—"></a>fetchæ¨¡å—</h2><blockquote><p>ä»è¿œç¨‹ä¸»æœºæ‹‰å–æ–‡ä»¶</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fetch:</span><br><span class="line">      dest:                  # (required) A directory to save the file into. For example, if the `dest&#x27; directory is `/backup&#x27; a `src&#x27; file named</span><br><span class="line">                               `/etc/profile&#x27; on host `host.example.com&#x27;, would be saved into</span><br><span class="line">                               `/backup/host.example.com/etc/profile&#x27;. The host name is based on the inventory name.</span><br><span class="line">      fail_on_missing:       # When set to `yes&#x27;, the task will fail if the remote file cannot be read for any reason. Prior to Ansible 2.5, setting this</span><br><span class="line">                               would only fail if the source file was missing. The default was changed to `yes&#x27; in Ansible</span><br><span class="line">                               2.5.</span><br><span class="line">      flat:                  # Allows you to override the default behavior of appending hostname/path/to/file to the destination. If `dest&#x27; ends with &#x27;/&#x27;, it</span><br><span class="line">                               will use the basename of the source file, similar to the copy module. This can be useful if</span><br><span class="line">                               working with a single host, or if retrieving files that are uniquely named per host. If using</span><br><span class="line">                               multiple hosts with the same filename, the file will be overwritten for each host.</span><br><span class="line">      src:                   # (required) The file on the remote system to fetch. This `must&#x27; be a file, not a directory. Recursive fetching may be supported</span><br><span class="line">                               in a later release.</span><br><span class="line">      validate_checksum:     # Verify that the source and destination checksums match after the files are fetched.</span><br></pre></td></tr></table></figure><h2 id="fileæ¨¡å—"><a href="#fileæ¨¡å—" class="headerlink" title="fileæ¨¡å—"></a>fileæ¨¡å—</h2><blockquote><p>ç®¡ç†æ–‡ä»¶å’Œæ–‡ä»¶å±æ€§</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">access_time:           # This parameter indicates the time the file&#x27;s access time should be set to. Should be `preserve&#x27; when no modification is</span><br><span class="line">                         required, `YYYYMMDDHHMM.SS&#x27; when using default time format, or `now&#x27;. Default is `None&#x27; meaning</span><br><span class="line">                         that `preserve&#x27; is the default for `state=[file,directory,link,hard]&#x27; and `now&#x27; is default for</span><br><span class="line">                         `state=touch&#x27;.</span><br><span class="line">access_time_format:    # When used with `access_time&#x27;, indicates the time format that must be used. Based on default Python format (see time.strftime</span><br><span class="line">                         doc).</span><br><span class="line">attributes:            # The attributes the resulting file or directory should have. To get supported flags look at the man page for `chattr&#x27; on the</span><br><span class="line">                         target system. This string should contain the attributes in the same order as the one displayed</span><br><span class="line">                         by `lsattr&#x27;. The `=&#x27; operator is assumed as default, otherwise `+&#x27; or `-&#x27; operators need to be</span><br><span class="line">                         included in the string.</span><br><span class="line">follow:                # This flag indicates that filesystem links, if they exist, should be followed. Previous to Ansible 2.5, this was `no&#x27; by</span><br><span class="line">                         default.</span><br><span class="line">force:                 # Force the creation of the symlinks in two cases: the source file does not exist (but will appear later); the destination</span><br><span class="line">                         exists and is a file (so, we need to unlink the `path&#x27; file and create symlink to the `src&#x27;</span><br><span class="line">                         file in place of it).</span><br><span class="line">group:                 # Name of the group that should own the file/directory, as would be fed to `chown&#x27;.</span><br><span class="line">mode:                  # The permissions the resulting file or directory should have. For those used to `/usr/bin/chmod&#x27; remember that modes are</span><br><span class="line">                         actually octal numbers. You must either add a leading zero so that Ansible&#x27;s YAML parser knows</span><br><span class="line">                         it is an octal number (like `0644&#x27; or `01777&#x27;) or quote it (like `&#x27;644&#x27;&#x27; or `&#x27;1777&#x27;&#x27;) so</span><br><span class="line">                         Ansible receives a string and can do its own conversion from string into number. Giving Ansible</span><br><span class="line">                         a number without following one of these rules will end up with a decimal number which will have</span><br><span class="line">                         unexpected results. As of Ansible 1.8, the mode may be specified as a symbolic mode (for</span><br><span class="line">                         example, `u+rwx&#x27; or `u=rw,g=r,o=r&#x27;).</span><br><span class="line">modification_time:     # This parameter indicates the time the file&#x27;s modification time should be set to. Should be `preserve&#x27; when no modification is</span><br><span class="line">                         required, `YYYYMMDDHHMM.SS&#x27; when using default time format, or `now&#x27;. Default is None meaning</span><br><span class="line">                         that `preserve&#x27; is the default for `state=[file,directory,link,hard]&#x27; and `now&#x27; is default for</span><br><span class="line">                         `state=touch&#x27;.</span><br><span class="line">modification_time_format:   # When used with `modification_time&#x27;, indicates the time format that must be used. Based on default Python format (see</span><br><span class="line">                         time.strftime doc).</span><br><span class="line">owner:                 # Name of the user that should own the file/directory, as would be fed to `chown&#x27;.</span><br><span class="line">path:                  # (required) Path to the file being managed.</span><br><span class="line">recurse:               # Recursively set the specified file attributes on directory contents. This applies only when `state&#x27; is set to `directory&#x27;.</span><br><span class="line">selevel:               # The level part of the SELinux file context. This is the MLS/MCS attribute, sometimes known as the `range&#x27;. When set to</span><br><span class="line">                         `_default&#x27;, it will use the `level&#x27; portion of the policy if available.</span><br><span class="line">serole:                # The role part of the SELinux file context. When set to `_default&#x27;, it will use the `role&#x27; portion of the policy if available.</span><br><span class="line">setype:                # The type part of the SELinux file context. When set to `_default&#x27;, it will use the `type&#x27; portion of the policy if available.</span><br><span class="line">seuser:                # The user part of the SELinux file context. By default it uses the `system&#x27; policy, where applicable. When set to `_default&#x27;,</span><br><span class="line">                         it will use the `user&#x27; portion of the policy if available.</span><br><span class="line">src:                   # Path of the file to link to. This applies only to `state=link&#x27; and `state=hard&#x27;. For `state=link&#x27;, this will also accept a</span><br><span class="line">                         non-existing path. Relative paths are relative to the file being created (`path&#x27;) which is how</span><br><span class="line">                         the Unix command `ln -s SRC DEST&#x27; treats relative paths.</span><br><span class="line">state:                 # If `absent&#x27;, directories will be recursively deleted, and files or symlinks will be unlinked. In the case of a directory, if</span><br><span class="line">                         `diff&#x27; is declared, you will see the files and folders deleted listed under `path_contents&#x27;.</span><br><span class="line">                         Note that `absent&#x27; will not cause `file&#x27; to fail if the `path&#x27; does not exist as the state did</span><br><span class="line">                         not change. If `directory&#x27;, all intermediate subdirectories will be created if they do not</span><br><span class="line">                         exist. Since Ansible 1.7 they will be created with the supplied permissions. If `file&#x27;, without</span><br><span class="line">                         any other options this works mostly as a &#x27;stat&#x27; and will return the current state of `path&#x27;.</span><br><span class="line">                         Even with other options (i.e `mode&#x27;), the file will be modified but will NOT be created if it</span><br><span class="line">                         does not exist; see the `touch&#x27; value or the [copy] or [template] module if you want that</span><br><span class="line">                         behavior. If `hard&#x27;, the hard link will be created or changed. If `link&#x27;, the symbolic link</span><br><span class="line">                         will be created or changed. If `touch&#x27; (new in 1.4), an empty file will be created if the</span><br><span class="line">                         `path&#x27; does not exist, while an existing file or directory will receive updated file access and</span><br><span class="line">                         modification times (similar to the way `touch&#x27; works from the command line).</span><br><span class="line">unsafe_writes:         # Influence when to use atomic operation to prevent data corruption or inconsistent reads from the target file. By default this</span><br><span class="line">                         module uses atomic operations to prevent data corruption or inconsistent reads from the target</span><br><span class="line">                         files, but sometimes systems are configured or just broken in ways that prevent this. One</span><br><span class="line">                         example is docker mounted files, which cannot be updated atomically from inside the container</span><br><span class="line">                         and can only be written in an unsafe manner. This option allows Ansible to fall back to unsafe</span><br><span class="line">                         methods of updating files when atomic operations fail (however, it doesn&#x27;t force Ansible to</span><br><span class="line">                         perform unsafe writes). IMPORTANT! Unsafe writes are subject to race conditions and can lead to</span><br><span class="line">                         data corruption.</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ansibleå­¦ä¹ ç¬”è®°</summary>
    
    
    
    <category term="Linux" scheme="http://asucanyh-cn.github.io/categories/Linux/"/>
    
    
    <category term="ansible" scheme="http://asucanyh-cn.github.io/tags/ansible/"/>
    
    <category term="linux" scheme="http://asucanyh-cn.github.io/tags/linux/"/>
    
  </entry>
  
</feed>
